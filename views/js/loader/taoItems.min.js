function _typeof2(obj){return _typeof2="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_typeof2(obj)}define("core/format",["lodash"],function(_){'use strict';function format(message){var replacements=Array.prototype.slice.call(arguments,1);return _.reduce(message.match(pattern),function(acc,match,index){var replacement="";if(void 0!==replacements[index]){switch(match){case"%d":replacement=+replacements[index];break;case"%j":try{replacement=JSON.stringify(replacements[index]).replace(/"/g,"")}catch(e){}break;default:replacement=replacements[index];}message=message.replace(match,replacement)}return message},message)}_=_&&_.hasOwnProperty("default")?_["default"]:_;var pattern=/(%[sdj])/g;return format}),define("util/strPad",[],function(){'use strict';return function(input,pad_length,pad_string,pad_type){var _Mathceil=Math.ceil,half="",str_pad_repeater=function(s,len){for(var collect="";collect.length<len;)collect+=s;return collect=collect.substr(0,len),collect},pad_to_go;return input=input.toString(),input+="",pad_string=void 0===pad_string?" ":pad_string,"STR_PAD_LEFT"!==pad_type&&"STR_PAD_RIGHT"!==pad_type&&"STR_PAD_BOTH"!==pad_type&&(pad_type="STR_PAD_RIGHT"),0<(pad_to_go=pad_length-input.length)&&("STR_PAD_LEFT"===pad_type?input=str_pad_repeater(pad_string,pad_to_go)+input:"STR_PAD_RIGHT"===pad_type?input+=str_pad_repeater(pad_string,pad_to_go):"STR_PAD_BOTH"==pad_type&&(half=str_pad_repeater(pad_string,_Mathceil(pad_to_go/2)),input=half+input+half,input=input.substr(0,pad_length))),input}}),define("core/promise",[],function(){'use strict';return Promise}),define("json!taoItems/preview/resources/device-list.json",function(){return{tablets:{"193986c3715c81838870f908fa98d69a":{label:"Amazon Kindle Fire HDX 7\u2033",width:960,height:600},"4e8eafab11aad1486992d7ee2c8c16ca":{label:"Apple iPad",width:1024,height:768},"5aac2932d9ad00d6d8a1604b8f9e4e8d":{label:"Google Nexus 10, Motorola Xoom, Xyboard",width:1280,height:800},"9805d9753ad08c7630a9ee5418aa6c6c":{label:"Google Nexus 7",width:966,height:604},d4a431cedf4705d6bf2cba6d5788378b:{label:"Samsung Galaxy Tab 7.7, 8.9, 10.1",width:1280,height:800}},phones:{"1b89338531ef0155c8d6abc2ac02c81a":{label:"Apple iPhone 3GS",width:320,height:480,scaleFactor:1,dpWidth:320,dpHeight:480},"3f89da99d84214cde7df87ebe0699a6f":{label:"Apple iPhone 4",width:640,height:960,scaleFactor:2,dpWidth:320,dpHeight:1920},"0d36971a5b98b367f54ced708c9af849":{label:"Apple iPhone 5",width:640,height:1136,scaleFactor:2,dpWidth:320,dpHeight:2272},"026beffcc051af995660ebdede986ace":{label:"BlackBerry Z10",width:768,height:1280,scaleFactor:2,dpWidth:384,dpHeight:2560},fd2dd53e667d6d49e4fa73356fa941dd:{label:"BlackBerry Z30",width:720,height:1280,scaleFactor:2,dpWidth:360,dpHeight:2560},"707584c1ae17d9b5b2cbe8603c91c147":{label:"Google Nexus 4",width:768,height:1280,scaleFactor:2,dpWidth:384,dpHeight:2560},"91823264de952e7f2347e07db5c4058b":{label:"Google Nexus 5",width:1080,height:1920,scaleFactor:3,dpWidth:360,dpHeight:5760},cd69817a6e147e8a4677389e56fcf568:{label:"Google Nexus S",width:480,height:800,scaleFactor:1.5,dpWidth:320,dpHeight:1200},"75994faa6a38e31e99b53fcd75534a33":{label:"HTC Evo, Touch HD, Desire HD, Desire",width:480,height:800,scaleFactor:1.5,dpWidth:320,dpHeight:1200},"0cab4dfccdfc880687cb608cfe4159db":{label:"HTC One X, EVO LTE",width:720,height:1280,scaleFactor:2,dpWidth:360,dpHeight:2560},c4ff41fcba24d74fc21dc3490ca1edc9:{label:"HTC Sensation, Evo 3D",width:540,height:960,scaleFactor:1.5,dpWidth:360,dpHeight:1440},fa969a5e0dd2de53700eeee4ba4ba142:{label:"LG Optimus 2X, Optimus 3D, Optimus Black",width:480,height:800,scaleFactor:1.5,dpWidth:320,dpHeight:1200},"33c4f9364e295ec03531f3a3425819cf":{label:"LG Optimus G",width:768,height:1280,scaleFactor:2,dpWidth:384,dpHeight:2560},bc47f5275f0efd56fee52d43a8082981:{label:"LG Optimus LTE, Optimus 4X HD",width:720,height:1280,scaleFactor:1.7,dpWidth:424,dpHeight:2176},"0732887e6e324fd10777b735520a34cf":{label:"LG Optimus One",width:320,height:480,scaleFactor:1.5,dpWidth:213,dpHeight:720},"2e38a78364f09d0da0e9e1a3a68e7fb0":{label:"Motorola Defy, Droid, Droid X, Milestone",width:480,height:854,scaleFactor:1.5,dpWidth:320,dpHeight:1281},bd4b78dddc7c9625a4141a1b1ddabb87:{label:"Motorola Droid 3, Droid 4, Droid Razr, Atrix 4G, Atrix 2",width:540,height:960,scaleFactor:1,dpWidth:540,dpHeight:960},"3bf1edf21cfa81006183d2b02974c84e":{label:"Motorola Droid Razr HD",width:720,height:1280,scaleFactor:1,dpWidth:720,dpHeight:1280},ab5a352e0e016b97dac986f06c394f55:{label:"Nokia C5, C6, C7, N97, N8, X7",width:360,height:640,scaleFactor:1,dpWidth:360,dpHeight:640},"4826fb7d7257aeaac992ce699df41b3c":{label:"Nokia Lumia 7X0, Lumia 8XX, Lumia 900, N800, N810, N900",width:480,height:800,scaleFactor:1.5,dpWidth:320,dpHeight:1200},"0a691ab20add7c432200f8fa6527b488":{label:"Samsung Galaxy Note",width:800,height:1280,scaleFactor:2,dpWidth:400,dpHeight:2560},"9c23ee31be29960fbac9e9bbfc2fc7b0":{label:"Samsung Galaxy Note 3",width:1080,height:1920,scaleFactor:2,dpWidth:540,dpHeight:3840},"92177c0508c1d73905a58e2338f2a81f":{label:"Samsung Galaxy Note II",width:720,height:1280,scaleFactor:2,dpWidth:360,dpHeight:2560},"5222b8866dc4cc606725e16ffcc0a783":{label:"Samsung Galaxy S III, Galaxy Nexus",width:720,height:1280,scaleFactor:2,dpWidth:360,dpHeight:2560},"37c1541e2bd55cfd0f4073b0ccdf68b3":{label:"Samsung Galaxy S, S II, W",width:480,height:800,scaleFactor:1.5,dpWidth:320,dpHeight:1200},"2f7f64b7dda0144907ff300e83eed465":{label:"Samsung Galaxy S4",width:1080,height:1920,scaleFactor:3,dpWidth:360,dpHeight:5760},"9c24f9057744dad56043702a9703127f":{label:"Sony Xperia S, Ion",width:720,height:1280,scaleFactor:2,dpWidth:360,dpHeight:2560},"0a8b2732a016a9395c3af5f12dd9c0da":{label:"Sony Xperia Sola, U",width:480,height:854,scaleFactor:1,dpWidth:480,dpHeight:854},"5a153d7f53d82dcb0801f041574a6a43":{label:"Sony Xperia Z, Z1",width:1080,height:1920,scaleFactor:3,dpWidth:360,dpHeight:5760}},screens:{"9e523ae15b61dc766f5c818726881ecf":{label:"1920 \xD7 1080",width:1920,height:1080,dpWidth:1920,dpHeight:1080,scaleFactor:1},"07769cd8d0a7d09818b2f0b018042fb7":{label:"1366 \xD7 768",width:1366,height:768,dpWidth:1366,dpHeight:768,scaleFactor:1},"72d5478a24194f98b9378e8e0fd65737":{label:"1280 \xD7 1024",width:1280,height:1024,dpWidth:1280,dpHeight:1024,scaleFactor:1},b7a6dd5900cc72e61f0d3479c7e314ec:{label:"1280 \xD7 800",width:1280,height:800,dpWidth:1280,dpHeight:800,scaleFactor:1},"43193b0ff671a37d8232ab664190a125":{label:"1024 \xD7 768",width:1024,height:768,dpWidth:1024,dpHeight:768,scaleFactor:1},c29e48814af5443ff5688d9e967ce917:{label:"800 \xD7 600",width:800,height:600,dpWidth:800,dpHeight:600,scaleFactor:1}}}}),define("tpl!taoItems/preview/tpl/preview",["handlebars"],function(hb){return hb.template(function(Handlebars,depth0,helpers,partials,data){function program1(depth0,data){var buffer="",stack1,helper;return buffer+="\n                        <option value=\"",(helper=helpers.value)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.value,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"\" ",stack1=helpers["if"].call(depth0,depth0&&depth0.selected,{hash:{},inverse:self.noop,fn:self.program(2,program2,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+=">",(helper=helpers.label)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.label,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"</option>\n                        ",buffer}function program2(){return"selected=\"selected\""}function program4(depth0,data){var buffer="",stack1;return buffer+="\n                    <select class=\"preview-theme-selector\">\n                        ",stack1=helpers.each.call(depth0,depth0&&depth0.themes,{hash:{},inverse:self.noop,fn:self.program(1,program1,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n                    </select>\n                    ",buffer}function program6(depth0,data){var buffer="",stack1,helper;return buffer+="\n                        <option value=\"",(helper=helpers.value)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.value,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"\" data-value=\"",(helper=helpers.dataValue)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.dataValue,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"\" ",stack1=helpers["if"].call(depth0,depth0&&depth0.selected,{hash:{},inverse:self.noop,fn:self.program(2,program2,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+=">",(helper=helpers.label)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.label,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"</option>\n                        ",buffer}this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var buffer="",escapeExpression=this.escapeExpression,self=this,helperMissing=helpers.helperMissing,stack1,helper,options;return buffer+="<div class=\"preview-overlay tao-scope overlay preview-",(helper=helpers.previewType)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.previewType,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+" item-no-print\"\n     style=\"display:none\">\n    <div class=\"preview-container-outer\">\n        <form class=\"preview-utility-bar plain\">\n            <div class=\"preview-utility-bar-inner grid-row\">\n\n                <div class=\"col-4\">\n                    <input type=\"hidden\" value=\"\" data-value=\"\" class=\"standard-device-selector preview-device-selector\" data-target=\"standard\">\n                    <select class=\"preview-type-selector\">\n                        ",stack1=helpers.each.call(depth0,depth0&&depth0.previewTypes,{hash:{},inverse:self.noop,fn:self.program(1,program1,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n                    </select>\n                    ",stack1=helpers["if"].call(depth0,depth0&&depth0.hasThemes,{hash:{},inverse:self.noop,fn:self.program(4,program4,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n                </div>\n                <div class=\"col-6 standard-only device-type-and-orientation\"></div>\n                <div class=\"col-6 desktop-only device-type-and-orientation\">\n                    <select class=\"desktop-device-selector preview-device-selector\" data-target=\"desktop\">\n                        ",stack1=helpers.each.call(depth0,depth0&&depth0.desktopDevices,{hash:{},inverse:self.noop,fn:self.program(6,program6,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n                    </select>\n                </div>\n                <div class=\"col-6 mobile-only device-type-and-orientation\">\n                    <select class=\"mobile-device-selector preview-device-selector\" data-target=\"mobile\">\n                        ",stack1=helpers.each.call(depth0,depth0&&depth0.mobileDevices,{hash:{},inverse:self.noop,fn:self.program(6,program6,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n                    </select>\n                    <select tabindex=\"-1\" class=\"mobile-orientation-selector orientation-selector\"\n                            data-target=\"mobile\">\n                        <option value=\"landscape\">"+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"Landscape",options):helperMissing.call(depth0,"__","Landscape",options)))+"</option>\n                        <option value=\"portrait\">"+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"Portrait",options):helperMissing.call(depth0,"__","Portrait",options)))+"</option>\n                    </select>\n                </div>\n                <div class=\"col-2\">\n                    <span class=\"btn-info small preview-closer rgt\">\n                        "+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"Close",options):helperMissing.call(depth0,"__","Close",options)))+"\n                        <span class=\"icon-close r\"></span>\n                    </span>\n                </div>\n            </div>\n            <div class=\"preview-message-box\">\n                <div class=\"feedback-info small\">\n                    <span class=\"icon-info\"></span>\n                    "+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"This preview may be scaled to fit your screen. The final rendering may differ.",options):helperMissing.call(depth0,"__","This preview may be scaled to fit your screen. The final rendering may differ.",options)))+"\n                    <a href=\"#\">"+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"Don\u2019t show this again!",options):helperMissing.call(depth0,"__","Don\u2019t show this again!",options)))+"</a>\n                    <span title=\""+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"Remove this message",options):helperMissing.call(depth0,"__","Remove this message",options)))+"\" class=\"icon-close close-trigger\"></span>\n                </div>\n            </div>\n        </form>\n        <div class=\"preview-canvas\">\n            <div class=\"preview-scale-container\">\n                <div class=\"",(helper=helpers.previewType)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.previewType,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"-preview-frame preview-outer-frame ",(helper=helpers.previewType)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.previewType,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"-preview-landscape\">\n                    <div class=\"",(helper=helpers.previewType)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.previewType,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"-preview-container preview-container\">\n                        <div class=\"preview-item-container\"></div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n\n\n    <div id=\"preview-console\">\n        <span class=\"icon-close preview-console-closer\" title=\""+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"Close console",options):helperMissing.call(depth0,"__","Close console",options)))+"\"></span>\n        <div class=\"preview-console-header grid-row clearfix\">\n            <ul class=\"col-10 plain action-bar extra-button-action-bar horizontal-action-bar\">\n            </ul>\n            <ul class=\"col-2 plain action-bar console-button-action-bar horizontal-action-bar\">\n                <li class=\"small btn-info action action-button rgt\" id=\"preview-submit-button\">\n                    <a class=\"li-inner\" href=\"#\">\n                        <span class=\"label\">"+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"Submit",options):helperMissing.call(depth0,"__","Submit",options)))+"</span>\n                    </a>\n                </li>\n            </ul>\n        </div>\n        <div class=\"preview-console-body clear\">\n            <ul></ul>\n        </div>\n    </div>\n</div>",buffer})}),define("ui/themes",["lodash","module"],function(_,module){'use strict';_=_&&_.hasOwnProperty("default")?_["default"]:_,module=module&&module.hasOwnProperty("default")?module["default"]:module;var themesConfig;return{getConfig:function(){var initialConfig;return themesConfig||(initialConfig=module.config(),themesConfig=_.cloneDeep(initialConfig)),themesConfig},getDefaultNamespacePrefix:function(){return"items"},get:function(what,ns){var config=this.getConfig();if(ns?what+="_"+ns:config.activeNamespace&&config[what+"_"+config.activeNamespace]&&(what+="_"+config.activeNamespace),_.isPlainObject(config[what]))return config[what]},getAvailable:function(what,ns){var available=[],themes=this.get(what,ns);return themes&&_.isArray(themes.available)&&(available=themes.available),available},getActiveNamespace:function(){return this.getConfig().activeNamespace},setActiveNamespace:function(ns){this.getConfig().activeNamespace=ns},getCurrentThemeData:function(what){var themeNamespace=this.getActiveNamespace();return what||(what=this.getDefaultNamespacePrefix()),this.get(what,themeNamespace)}}}),define("ui/themeLoader",["jquery","lodash"],function($,_){'use strict';$=$&&$.hasOwnProperty("default")?$["default"]:$,_=_&&_.hasOwnProperty("default")?_["default"]:_;var $container=$("head").length?$("head"):$("body"),triggerThemeChange=function(themeId){_.delay(function(){$(document).trigger("themechange."+"themeloader",[themeId])},200)},createStyleSheet=function(theme){var type="base"===theme.id?"custom-theme-base":"custom-theme-theme";return $("<link>").attr({rel:"stylesheet",type:"text/css",href:theme.path,"data-type":type,"data-name":theme.name||theme.id,"data-id":theme.id})},getLink=function(id){return $("link[data-id=\""+id+"\"][data-type^=\""+"custom-theme-"+"\"]",$container)},isAttached=function(id){return 0<getLink(id).length},enable=function($nodes){$nodes.prop("disabled",!1).removeProp("disabled").removeAttr("disabled")},disable=function($nodes){return $nodes.prop("disabled",!0).attr("disabled",!0)},themeLoader=function(config){var styles={},defaultTheme,activeTheme,themes,i;if(!_.isPlainObject(config))throw new TypeError("Theme loader configuration is required");if(!_.isString(config.base))throw new TypeError("Theme loader configuration is an object with a base property configuration");if(!_.isArray(config.available)||!config.available.length)throw new TypeError("No theme declared in the configuration");for(i in config.available)if(!_.isPlainObject(config.available[i])||_.isEmpty(config.available[i].id)||_.isEmpty(config.available[i].path))throw new TypeError("There is a theme that does not contain an id or a path");return defaultTheme=config.default||_.first(_.pluck(config.available,"id")),activeTheme=defaultTheme,themes=[{id:"base",path:config.base,name:"TAO"}],themes=themes.concat(config.available),_.forEach(themes,function(theme){styles[theme.id]=isAttached(theme.id)?getLink(theme.id):createStyleSheet(theme)}),{load:function(preload){return _.forEach(styles,function($link,id){isAttached(id)||(!preload&&id===activeTheme&&$link.on("load",function(){triggerThemeChange(id)}),disable($link),$container.append($link)),preload||("base"!==id&&id!==defaultTheme?disable($link):(enable($link),activeTheme=id,triggerThemeChange(activeTheme)))}),this},unload:function(){return disable($("link[data-type^=\"custom-theme-\"]",$container)),this},change:function(id){return _.contains(["base","default"],id)&&!isAttached(id)&&(id=defaultTheme),isAttached(id)&&(disable($("link[data-type=\"custom-theme-theme\"]",$container)),enable(getLink(id)),activeTheme=id,triggerThemeChange(activeTheme)),this},getActiveTheme:function(){return activeTheme}}};return themeLoader}),define("util/urlParser",["lodash"],function(_){'use strict';function UrlParser(url){var detachedAnchor;this.url=url,detachedAnchor=document.createElement("a"),detachedAnchor.href=url,this.data=_.pick(detachedAnchor,urlParts),this.params=UrlParser.extractParams(this.data.search)}_=_&&_.hasOwnProperty("default")?_["default"]:_;var urlParts=["hash","host","hostname","pathname","port","protocol","search"];return UrlParser.extractParams=function(search){var params={};return search.replace(/^\?/,"").replace(/([^=&]+)=([^&]*)/g,function(m,key,value){params[decodeURIComponent(key)]=decodeURIComponent(value)}),params},UrlParser.prototype.get=function(what){return!!_.contains(urlParts,what)&&this.data[what]},UrlParser.prototype.getParams=function(){return this.params},UrlParser.prototype.setParams=function(params){_.isObject(params)&&(this.params=params)},UrlParser.prototype.addParam=function(key,value){key&&(this.params[key]=value)},UrlParser.prototype.getPaths=function(){return this.data.pathname.replace(/^\/|\/$/g,"").split("/")},UrlParser.prototype.getUrl=function(exclude){var url="";return exclude=exclude||[],this.data&&(this.data.hostname&&!_.contains(exclude,"host")&&(url+=(this.data.protocol?this.data.protocol:"http:")+"//"+this.data.hostname.replace(/\/$/,""),this.data.port&&80!==this.data.port&&"80"!==this.data.port&&"0"!==this.data.port&&(url+=":"+this.data.port)),!/\/$/.test(url)&&!/^\//.test(this.data.pathname)&&(url+="/"),url+=this.data.pathname,this.params&&!_.contains(exclude,"params")&&(url+="?",_.forEach(this.params,function(value,key){url+=encodeURIComponent(key)+"="+encodeURIComponent(value)+"&"}),url=url.substring(0,url.length-1)),this.data.hash&&!_.contains(exclude,"hash")&&(url+=this.data.hash)),url},UrlParser.prototype.getBaseUrl=function(){var baseUrl=this.getUrl(["params","hash"]),paths=this.getPaths(),lastPart=paths[paths.length-1];return 0<paths.length&&/\.[a-z]+$/.test(lastPart)&&(baseUrl=baseUrl.replace(lastPart,"").replace(/\/\/$/,"/")),baseUrl},UrlParser.prototype.sameDomain=function(url){var parsedUrl;if("undefined"==typeof url&&(parsedUrl=new UrlParser(window.location)),"string"==typeof url&&(parsedUrl=new UrlParser(url)),url instanceof UrlParser&&(parsedUrl=url),!(parsedUrl instanceof UrlParser))throw new TypeError("Invalid url format");return"data:"===this.get("protocol")||"data:"===parsedUrl.get("protocol")||this.get("protocol")===parsedUrl.get("protocol")&&this.get("hostname")===parsedUrl.get("hostname")&&this.get("port")===parsedUrl.get("port")},UrlParser.prototype.checkCORS=UrlParser.prototype.sameDomain,UrlParser}),define("core/pluginifier",["jquery","lodash"],function($,_){'use strict';function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)?function(obj){return _typeof2(obj)}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":_typeof2(obj)},_typeof(obj)}$=$&&$.hasOwnProperty("default")?$["default"]:$,_=_&&_.hasOwnProperty("default")?_["default"]:_;var basePlugin={options:function(dataNs,ns,_options){return this.each(function(){var $elt=$(this),currentOptions=$elt.data(dataNs);currentOptions&&$elt.data(dataNs,_.merge(currentOptions,_options))})},disable:function(dataNs,ns){return this.each(function(){var $elt=$(this),options=$elt.data(dataNs);options&&$elt.addClass(options.disableClass||"disabled").trigger("disable."+ns)})},enable:function(dataNs,ns){return this.each(function(){var $elt=$(this),options=$elt.data(dataNs);options&&$elt.removeClass(options.disableClass||"disabled").trigger("enable."+ns)})}};return{register:function(pluginName,plugin,config){config=config||{};var ns=config.ns||pluginName.toLowerCase(),dataNs=config.dataNs||"ui."+ns,expose=config.expose||[];return _.isFunction($.fn[pluginName])?$.error("A plugin named "+pluginName+" is already registered"):_.isPlainObject(plugin)&&_.isFunction(plugin.init)?void(_.assign(plugin,_.transform(basePlugin,function(result,prop,key){_.isFunction(prop)&&(result[key]=_.partial(basePlugin[key],dataNs,ns))})),_.forEach(expose,function(toExposeName){var privateMethod=toExposeName,publicMethod=toExposeName;/^_/.test(expose)?publicMethod=publicMethod.replace(/^_/,""):privateMethod="_"+privateMethod,_.isFunction(plugin[privateMethod])&&!_.isFunction(plugin[publicMethod])&&(plugin[publicMethod]=function(){var args=Array.prototype.slice.call(arguments,0),returnValue;return this.each(function(){returnValue=plugin[privateMethod].apply(plugin,[$(this)].concat(args))}),returnValue||this})}),$.fn[pluginName]=function(method){if(plugin[method]){if(/^_/.test(method))$.error("Trying to call a private method `"+method+"`");else return plugin[method].apply(this,Array.prototype.slice.call(arguments,1));}else if("object"===_typeof(method)||!method)return plugin.init.apply(this,arguments);$.error("Method "+method+" does not exist on plugin")}):$.error("The object to register as a jQuery plugin must be a plain object with an `init` method.")}}}),define("core/dataattrhandler",["jquery","lodash"],function($,_){'use strict';$=$&&$.hasOwnProperty("default")?$["default"]:$,_=_&&_.hasOwnProperty("default")?_["default"]:_;var defaults={container:!1,listenerEvent:"click",useTarget:!0,bubbled:!1},letDefaultOn=[":radio",":checkbox"],shouldPreventDefault=function($elt){return!$elt.is(letDefaultOn.join(","))},DataAttrHandler=function(attrName,options){var self=this;this.options=_.defaults(options,defaults);var selector="[data-"+attrName+"]";return _.has(this.options,"namespace")&&_.isString(this.options.namespace)?void(this.options.container&&this.options.container.selector&&(selector=this.options.container.selector+" "+selector),this.options.inner&&(selector+=" "+this.options.inner),$(document).off(this.options.listenerEvent,selector).on(this.options.listenerEvent,selector,function(e){var $elt=$(e.target);if(!0===self.options.bubbled||$elt.is(selector)){var $target,$outer;void 0===$elt.data(attrName)&&(self.options.inner||self.options.bubbled)&&($outer=$elt,$elt=$elt.parents("[data-"+attrName+"]")),$target=!0===self.options.useTarget?DataAttrHandler.getTarget(attrName,$elt):self.options.inner?$outer:void 0,$elt.data(self.options.namespace)||("function"==typeof self.createPlugin&&self.createPlugin($elt,$target),$elt.is(":radio")&&$elt.attr("name")&&$(":radio[name=\""+$elt.attr("name")+"\"]").not($elt).on(self.options.listenerEvent,function(e){"function"==typeof self.callPluginMethod&&self.callPluginMethod($elt,$target),shouldPreventDefault($elt)&&e.preventDefault()})),"function"==typeof self.callPluginMethod&&self.callPluginMethod($elt,$target),shouldPreventDefault($elt)&&e.preventDefault()}})):$.error("The plugin data namespace option is required")};return DataAttrHandler.prototype.init=function(cb){return this.createPlugin=cb,this},DataAttrHandler.prototype.trigger=function(cb){return this.callPluginMethod=cb,this},DataAttrHandler.getTarget=function(attrName,$elt){var relativeRegex=/^(\+|>|~|:parent|<)/,$target=[],targetSelector=$elt.attr("data-"+attrName)||$elt.attr("href")||$elt.attr("attrName");if(!_.isEmpty(targetSelector)){var matches=relativeRegex.exec(targetSelector);if(null!==matches){var selector=targetSelector.replace(relativeRegex,"");$target=":parent"===matches[0]||"<"===matches[0]?$elt.parents(selector):"~"===matches[0]?$elt.siblings(selector):"+"===matches[0]?$elt.next(selector):$(selector,$elt)}else $target=$(targetSelector)}return $target},DataAttrHandler}),define("ui/modal",["jquery","core/pluginifier","core/dataattrhandler"],function($,Pluginifier,DataAttrHandler){'use strict';var _Mathmax=Math.max;function closeModal($element,reason){var options=$element.data("ui.modal"),$overlay=$("#"+options.modalOverlay),onClose=function(){$element.removeClass("opened"),$element.css("display","none"),$element.trigger("closed.modal",reason)};modal._unBindEvents($element),options.animate&&$element.is(":visible")?($overlay.fadeOut(options.animate-100),$element.animate({opacity:"0",top:"-1000px"},options.animate,onClose)):($overlay.hide(),$element.hide(),onClose())}function listenDataAttr($container){new DataAttrHandler("modal",{container:$container,listenerEvent:"click",namespace:"ui.modal"}).init(function($elt,$target){$target.modal()})}$=$&&$.hasOwnProperty("default")?$["default"]:$,Pluginifier=Pluginifier&&Pluginifier.hasOwnProperty("default")?Pluginifier["default"]:Pluginifier,DataAttrHandler=DataAttrHandler&&DataAttrHandler.hasOwnProperty("default")?DataAttrHandler["default"]:DataAttrHandler;var dataNs="ui.modal",defaults={modalCloseClass:"modal-close",modalOverlayClass:"modal-bg",startClosed:!1,disableClosing:!1,width:"responsive",minWidth:0,minHeight:0,vCenter:!0,$context:null,animate:400},animateDiff=100,modal={init:function(options){return options=$.extend(!0,{},defaults,options),options.animate&&("number"==typeof options.animate?options.animate=_Mathmax(animateDiff,options.animate):options.animate=defaults.animate),$(this).each(function(){var $modal=$(this);if(options.modalOverlay="__modal-bg-"+($modal.attr("id")||new Date().getTime()),$modal.data(dataNs,options),0===$("#"+options.modalOverlay).length){var $overlay=$("<div/>").attr({id:options.modalOverlay,class:options.modalOverlayClass});options.$context instanceof $&&options.$context.length?($overlay.css("position","absolute"),options.$context.append($overlay)):$modal.after($overlay)}0!==$("."+options.modalCloseClass,$modal).length||options.disableClosing||$("<button id=\"modal-close-btn\" class=\""+options.modalCloseClass+"\"><span class=\"icon-close\"></span></button>").appendTo($modal),options.startClosed||modal._open($modal),$modal.trigger("create.modal")})},_destroy:function($element){return $element.each(function(){var $modal=$(this),options=$modal.data(dataNs);$modal.removeData(dataNs),$("#"+options.modalOverlay).remove(),$modal.hide(),$element.trigger("destroyed.modal")})},_bindEvents:function($element){var options=$element.data(dataNs);options&&("responsive"===options.width&&$(window).on("resize.modal",function(e){e.preventDefault(),modal._resize($element)}),!options.disableClosing&&($("."+options.modalCloseClass,$element).on("click.modal",function(e){e.preventDefault(),closeModal($element,"close")}),$("#"+options.modalOverlay).on("click.modal",function(e){e.preventDefault(),closeModal($element,"overlay")}),!options.disableEscape&&$(document).on("keydown.modal",function(e){27===e.keyCode&&(e.preventDefault(),closeModal($element,"escape"))})))},_unBindEvents:function($element){var options=$element.data(dataNs);options&&"responsive"===options.width&&$(window).off("resize.modal"),$element.off("click.modal"),options&&!options.disableClosing&&($("."+options.modalCloseClass,$element).off("click.modal"),$("#"+options.modalOverlay).off("click.modal"),$(document).off("keydown.modal"))},_open:function($element){var modalHeight=$element.outerHeight(),windowHeight=$(window).height(),options=$element.data(dataNs),topOffset,onOpen,$overlay,to;"undefined"!=typeof options&&(onOpen=function(){$element.addClass("opened"),modal._bindEvents($element),$element.trigger("opened.modal")},topOffset=options.top?options.top:options.vCenter||modalHeight>windowHeight?40:(windowHeight-modalHeight)/2,!options.top&&!$element.parent().hasClass("no-scroll-offset")&&$element.parents().map(function(){"BODY"!==this.tagName&&"HTML"!==this.tagName&&(topOffset+=parseInt($(this).scrollTop(),10))}),to={opacity:"1",top:topOffset+"px"},modal._resize($element),$overlay=$("#"+options.modalOverlay),$element.show(),options.animate&&$element.is(":visible")?($element.css({top:"-"+modalHeight+"px",display:"block"}),$overlay.fadeIn(options.animate-animateDiff),$element.animate(to,options.animate,onOpen)):($overlay.show(),$element.css(to),onOpen()))},_close:function($element){closeModal($element,"api")},_resize:function($element){var options=$element.data(dataNs),windowWidth=parseInt($(window).width(),10),css={},modalWidth="responsive"===options.width?.7*windowWidth:parseInt(options.width,10);css.width=_Mathmax(modalWidth,options.minWidth),options.minHeight&&(css.minHeight=parseInt(options.minHeight)+"px"),$element.css(css)}};return Pluginifier.register("modal",modal,{expose:["open","close","destroy"]}),listenDataAttr}),define("css!taoItemsCss/preview",[],function(){}),define("taoItems/preview/preview",["jquery","lodash","i18n","util/strPad","core/promise","json!taoItems/preview/resources/device-list.json","tpl!taoItems/preview/tpl/preview","ui/themes","ui/themeLoader","util/urlParser","ui/modal","select2","jquery.cookie","css!taoItemsCss/preview"],function($,_,__,strPad,Promise,deviceList,previewTpl,themeHandler,themeLoader,UrlParser){'use strict';function _setupScreenSize(){screenSize={width:$(".preview-overlay").innerWidth(),height:$(".preview-overlay").innerHeight()}}var orientation="landscape",previewType="standard",previewTypes={desktop:__("Desktop preview"),mobile:__("Mobile preview"),standard:__("Actual size")},themeObj=themeHandler.get("items")||{},$doc=$(document),$window=$(window),$body=$(document.body),screenSize={width:$window.innerWidth(),height:$window.innerHeight()},sizeSettings={width:0,height:0},scaleFactor=1,winScrollObj={x:0,y:0},_getDeviceSelectorData=function(type){var devices="mobile"===type?deviceList.tablets:deviceList.screens,options=[];return _.forEach(devices,function(value){options.push({value:value.label,label:value.label,dataValue:[value.width,value.height].join(","),selected:previewType===value.label})}),options},_setupTypeDependantElements=function(){typeDependant=overlay.add(overlay.find(".preview-scale-container").find("[class*=\""+previewType+"\"]"))},_setPreviewType=function(newType){var re;newType===previewType||(re=new RegExp(previewType,"g"),typeDependant.each(function(i,el){el.className=el.className.replace(re,newType)}),previewType=newType)},_setOrientation=function(newOrientation){var re,previewFrame;newOrientation===orientation||(re=new RegExp(orientation,"g"),previewFrame=$(".preview-outer-frame")[0],previewFrame.className=previewFrame.className.replace(re,newOrientation),orientation=newOrientation)},_scale=function(){_computeScaleFactor();var $scaleContainer=$(".preview-scale-container"),_scaleFactor="standard"===previewType?1:scaleFactor,containerScaledWidth=$scaleContainer.width()*_scaleFactor,left=(screenSize.width-containerScaledWidth)/2;$scaleContainer.css({left:0<left?left:0,"-webkit-transform":"scale("+_scaleFactor+","+_scaleFactor+")","-ms-transform":"scale("+_scaleFactor+","+_scaleFactor+")",transform:"scale("+_scaleFactor+","+_scaleFactor+")","-webkit-transform-origin":"0 0","-ms-transform-origin":"0 0","transform-origin":"0 0"})},_positionPreview=function(){var topBarHeight=$(".preview-utility-bar").outerHeight();overlay[0].style.top=topBarHeight+"px",overlay[0].style.maxHeight="calc(100vh - "+topBarHeight+"px - "+$console.outerHeight()+"px )"},_computeScaleFactor=function(){var scaleValues={x:1,y:1},requiredSize={width:sizeSettings.width+150,height:sizeSettings.height+275};requiredSize.width>screenSize.width&&(scaleValues.x=screenSize.width/requiredSize.width),requiredSize.height>screenSize.height&&(scaleValues.y=screenSize.height/requiredSize.height),scaleFactor=Math.min(scaleValues.x,scaleValues.y)},_setupDeviceSelectors=function(){var previewDeviceSelectors=overlay.find(".preview-device-selector");previewDeviceSelectors.on("change",function(){for(var elem=$(this),option="select"===this.nodeName.toLowerCase()?this.options[this.selectedIndex]:this,type=elem.data("target"),val=$(option).data("value").split(","),i=val.length,container=overlay.find("."+type+"-preview-container");i--;)val[i]=parseFloat(val[i]);return sizeSettings="mobile"===type&&"portrait"===orientation?{width:val[1],height:val[0]}:{width:val[0],height:val[1]},(sizeSettings.width!==container.width()||sizeSettings.height!==container.height())&&void(_setPreviewType(type),container.css(sizeSettings),_scale())}),previewDeviceSelectors.each(function(){"select"===this.nodeName.toLowerCase()&&$(this).select2({minimumResultsForSearch:-1})})},_setupOrientationSelectors=function(){$("select.orientation-selector").on("change",function(){var type=$(this).data("target"),previewFrame=$("."+type+"-preview-frame"),container=previewFrame.find("."+type+"-preview-container"),newOrientation=$(this).val();return newOrientation!==orientation&&void(sizeSettings={height:container.width(),width:container.height()},container.css(sizeSettings),_setOrientation(newOrientation),_scale())}).select2({minimumResultsForSearch:-1})},_setupClosers=function(){var $closer=overlay.find(".preview-closer"),$feedbackCloser=$feedbackBox.find(".close-trigger"),$hideForever=$feedbackBox.find("a"),$iframe=$("#preview-iframe");$closer.on("click",function(){$doc.trigger("itemunload.preview"),window.scrollTo(winScrollObj.x,winScrollObj.y),overlay.hide(),$body.removeClass("preview-mode"),$iframe.off("load").attr("src","about:blank"),$(".preview-container").remove()}),$doc.keyup(function(e){27===e.keyCode&&$closer.trigger("click")}),$feedbackCloser.on("click",function(){$feedbackBox.hide(),$body.addClass("no-preview-feedback"),_positionPreview(),_scale()}),$hideForever.on("click",function(e){e.preventDefault(),$.cookie("hidePreviewFeedback",!0,{expires:1e3,path:"/"}),$feedbackCloser.trigger("click")})},_getThemes=function(){var options=[],activeTheme;return _.isPlainObject(themeObj)&&!_.isEmpty(themeObj.base)&&(activeTheme=themeLoader(themeObj).getActiveTheme(),_(themeObj.available).forEach(function(data){options.push({value:data.id,label:data.name,selected:data.id===activeTheme})})),options},_getPreviewTypes=function(){var options=[];return _(previewTypes).forEach(function(_previewLabel,_previewType){options.push({value:_previewType,label:_previewLabel,selected:previewType===_previewType})}),options},_setupViewSelector=function(){$("select.preview-type-selector").on("change",function(){var _previewType=$(this),value=_previewType.val();_setPreviewType(value),$("."+value+"-device-selector").trigger("change")}).select2({minimumResultsForSearch:-1})},_setupThemeSelector=function(){$("select.preview-theme-selector").on("change",function(){var iframe=document.getElementById("preview-container"),iframeDoc=iframe.contentWindow||iframe.contentDocument;iframeDoc.$(".qti-item").trigger("themechange",[$(this).val()])}).select2({minimumResultsForSearch:-1})},_updateStandardPreviewSize=function(height){var $selector=$(".standard-device-selector"),values=($selector.val()?$selector.val().split(","):"")||[$window.width().toString()],valueStr=values.join(",");values[1]=height||values[1]||"1200",$selector.val(valueStr).data("value",valueStr)},_initConsole=function(){var $body=$console.find(".preview-console-body"),$listing=$body.find("ul"),$closer=$console.find(".preview-console-closer");$console.off("updateConsole").on("updateConsole",function(event,type,message){var timer=new Date,logTime=[strPad(timer.getHours(),2,"0","STR_PAD_LEFT"),strPad(timer.getMinutes(),2,"0","STR_PAD_LEFT"),strPad(timer.getSeconds(),2,"0","STR_PAD_LEFT")].join(":"),msgStr="<span class=\"log-time\">"+strPad(logTime,12," ")+"</span> <span class=\"log-type\">"+strPad(type,18," ")+"</span> <span class=\"log-message\">"+strPad(message,18," ")+"</span>";$listing.append("<li><pre>"+msgStr+"</pre></li>"),$body.is(":visible")?$listing.scrollTop(1e4):$body.slideDown("slow",function(){$closer.show(),$listing.scrollTop(1e4)})}),$closer.on("click",function(){$body.slideUp("slow",function(){$closer.hide()})})},init=function(_itemUri,_state){if(!_itemUri||0===_itemUri.length)throw new TypeError("Wrong URI");return $(".preview-overlay").remove(),overlay=$(previewTpl({mobileDevices:_getDeviceSelectorData("mobile"),desktopDevices:_getDeviceSelectorData("desktop"),previewTypes:_getPreviewTypes(),previewType:previewType,themes:_getThemes(),hasThemes:1<_.size(themeObj.available)})),$body.append(overlay),$feedbackBox=overlay.find(".preview-message-box"),$.cookie("hidePreviewFeedback")&&($feedbackBox.hide(),$body.addClass("no-preview-feedback")),$console=overlay.find("#preview-console"),_initConsole(),_updateStandardPreviewSize(),_setupTypeDependantElements(),_setupDeviceSelectors(),_setupOrientationSelectors(),_setupViewSelector(),_setupThemeSelector(),_setupClosers(),_setupScreenSize(),_computeScaleFactor(),_setPreviewType(previewType),_setOrientation(orientation),$window.on("resize orientationchange",function(){_setupScreenSize(),_updateStandardPreviewSize(),_computeScaleFactor(),_scale()}),itemUri=_itemUri,state=_state,overlay},overlay,typeDependant,$feedbackBox,$console,itemUri,state;return{init:init,show:function show(){return new Promise(function(resolve,reject){var parsed=new UrlParser(itemUri);parsed.params.state=JSON.stringify(state),$.ajax({url:itemUri,dataType:"html",method:"POST",data:parsed.params}).done(function(data){winScrollObj={x:window.scrollX,y:window.scrollY},window.scrollTo(0,0),$body.addClass("preview-mode"),overlay[0].style.display="block",overlay.find("select:visible").not(".preview-theme-selector").trigger("change"),_scale(),_positionPreview(),$(".preview-item-container").html(data),resolve()}).fail(function(xhr){reject(new Error(__("Unable to render the item from %s : %s %s",itemUri,xhr.status,xhr.statusText)))})})}}}),define("taoItems/controller/items/action",["layout/actions/binder","uri","jquery","context","taoItems/preview/preview","helpers"],function(binder,uri,$,context,preview,helpers){'use strict';binder.register("itemPreview",function(actionContext){preview.init(helpers._url("forwardMe","ItemPreview",context.shownExtension,{uri:actionContext.id})),preview.show()})}),function(global,factory){"object"===("undefined"==typeof exports?"undefined":_typeof2(exports))&&"undefined"!=typeof module?module.exports=factory():"function"==typeof define&&define.amd?define("lib/uuid",factory):(global=global||self,global.uuid=factory())}(this,function(){'use strict';var CHARS=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"];return function(len,radix){var chars=CHARS,uuid=[],i,r;if(radix=radix||chars.length,len)for(i=0;i<len;i++)uuid[i]=chars[0|Math.random()*radix];else for(uuid[8]=uuid[13]=uuid[18]=uuid[23]="-",uuid[14]="4",i=0;36>i;i++)uuid[i]||(r=0|16*Math.random(),uuid[i]=chars[19===i?8|3&r:r]);return uuid.join("")}}),define("core/logger/api",["lodash","core/format","core/promise"],function(_,format,Promise){'use strict';_=_&&_.hasOwnProperty("default")?_["default"]:_,format=format&&format.hasOwnProperty("default")?format["default"]:format,Promise=Promise&&Promise.hasOwnProperty("default")?Promise["default"]:Promise;var defaultLevel="info",levels={fatal:60,error:50,warn:40,info:30,debug:20,trace:10},logQueue=[],getLevel=function(level){return"undefined"==typeof level||_.isString(level)&&!_.has(levels,level)?defaultLevel:_.isNumber(level)?_.findKey(levels,function(l){return l===level})||defaultLevel:level},getLevelNum=function(level){return _.isString(level)&&_.has(levels,level)?levels[level]:_.isNumber(level)&&_.contains(levels,level)?level:levels[defaultLevel]},checkMinLevel=function(minLevel,level){return getLevelNum(level)>=getLevelNum(minLevel)},loggerFactory=function loggerFactory(name,minLevel,fields){var baseRecord,logger;if(!_.isString(name)||_.isEmpty(name))throw new TypeError("A logger needs a name");return _.isPlainObject(minLevel)&&"undefined"==typeof field&&(fields=minLevel,minLevel=defaultLevel),baseRecord=_.defaults(fields||{},{name:name,pid:1,hostname:navigator.userAgent}),logger={log:function(level,recordFields,message){var rest=[],time=new Date().toISOString(),record,err;if(!1!==loggerFactory.providers&&checkMinLevel(minLevel||defaultLevel,level))return _.isString(recordFields)||recordFields instanceof Error?(message=recordFields,recordFields={},rest=[].slice.call(arguments,2)):rest=[].slice.call(arguments,3),record={level:getLevel(level),v:0,time:time},checkMinLevel(levels.error,level)||message instanceof Error?(message instanceof Error?err=message:(message=_.isObject(message)?JSON.stringify(message):message,err=new Error(message)),record.msg=err.message,record.err=err):record.msg=format.apply(null,[message].concat(rest)),_.merge(record,baseRecord,recordFields),logQueue.push(record),loggerFactory.flush(),this},level:function(value){return"undefined"==typeof value?getLevel(minLevel):(minLevel=getLevelNum(value),this)},child:function(childFields){return loggerFactory(name,minLevel,_.defaults(childFields,baseRecord))}},_.reduce(levels,function(target,level,levelName){return target[levelName]=_.partial(logger.log,level),target},logger)};return loggerFactory.levels=levels,loggerFactory.providers=!1,loggerFactory.load=function(providerConfigs){var self=this,modules=[];return this.providers=[],new Promise(function(resolve,reject){_.forEach(providerConfigs,function(providerConfig,providerName){modules.push(providerName)}),require(modules,function(){var loadedProviders=[].slice.call(arguments);_.forEach(loadedProviders,function(provider,moduleKey){try{self.register(provider,providerConfigs[modules[moduleKey]])}catch(err){reject(err)}}),self.flush(),resolve()},reject)})},loggerFactory.register=function(provider,providerConfig){if(!_.isPlainObject(provider)||!_.isFunction(provider.log))throw new TypeError("A log provider is an object with a log method");provider.checkMinLevel=checkMinLevel,_.isFunction(provider.setConfig)&&provider.setConfig(providerConfig),this.providers=this.providers||[],this.providers.push(provider)},loggerFactory.flush=function(){_.isArray(this.providers)&&0<this.providers.length&&(_.forEach(logQueue,function(message){_.forEach(loggerFactory.providers,function(provider){provider.log.call(provider,message)})}),logQueue=[])},loggerFactory.setDefaultLevel=function(level){return defaultLevel=getLevel(level),defaultLevel},loggerFactory}),define("core/logger",["lodash","module","core/logger/api"],function(_,module,loggerFactory){'use strict';_=_&&_.hasOwnProperty("default")?_["default"]:_,module=module&&module.hasOwnProperty("default")?module["default"]:module,loggerFactory=loggerFactory&&loggerFactory.hasOwnProperty("default")?loggerFactory["default"]:loggerFactory;var defaultConfig={level:loggerFactory.levels.warn,loggers:{"core/logger/console":{level:"warn"}}},config=_.defaults(module.config()||{},defaultConfig),logger=loggerFactory("core/logger");return loggerFactory.setDefaultLevel(config.level),loggerFactory.load(config.loggers),window.onerror=function(msg,url,line,col){logger.error("Caught[via window.onerror]: '"+msg+"' from "+url+":"+line+":"+col)},window.setTaoLogLevel=function(level){return loggerFactory.setDefaultLevel(level)},loggerFactory}),define("core/eventifier",["lodash","core/promise","lib/uuid","core/logger"],function(_,Promise,uuid,loggerFactory){'use strict';function getEventNames(eventNames){return!_.isString(eventNames)||_.isEmpty(eventNames)?[]:_(eventNames.split(/\s/g)).compact().uniq().value()}function getName(eventName){return-1<eventName.indexOf(".")?eventName.substr(0,eventName.indexOf(".")):eventName}function getNamespace(eventName){return-1<eventName.indexOf(".")?eventName.substr(eventName.indexOf(".")+1):"@"}function getHandlerObject(){return{before:[],between:[],after:[]}}function eventifier(target){var eventHandlers={},getHandlers=function(eventName,type){var name=getName(eventName),ns=getNamespace(eventName);return type=type||"between",eventHandlers[ns]=eventHandlers[ns]||{},eventHandlers[ns][name]=eventHandlers[ns][name]||getHandlerObject(),eventHandlers[ns][name][type]},eventApi={on:function(eventNames,handler){return _.isFunction(handler)&&_.forEach(getEventNames(eventNames),function(eventName){getHandlers(eventName).push(handler)}),this},off:function(eventNames){return _.forEach(getEventNames(eventNames),function(eventName){var name=getName(eventName),ns=getNamespace(eventName),offNamespaces;ns&&!name?"*"===ns?(offNamespaces={},offNamespaces["@"]=eventHandlers["@"],eventHandlers=offNamespaces):eventHandlers[ns]={}:_.forEach(eventHandlers,function(nsHandlers,namespace){nsHandlers[name]&&("@"===ns||ns===namespace)&&(nsHandlers[name]=getHandlerObject())})}),this},removeAllListeners:function(){return eventHandlers={},this},trigger:function(eventNames){function triggerAllHandlers(allHandlers,name,ns){var event={name:name,namespace:ns};allHandlers.before.length?triggerBefore(allHandlers.before,event).then(function(){triggerBetween(allHandlers,event)}).catch(function(err){logHandlerStop("before",event,err)}):triggerBetween(allHandlers,event)}function triggerBefore(handlers,event){var beforeArgs=args.slice(),pHandlers;return beforeArgs.unshift(event),pHandlers=handlers.map(function(handler){var value=!shouldStop(event.name)&&handler.apply(self,beforeArgs);return!1===value?Promise.reject():value}),Promise.all(pHandlers)}function triggerBetween(allHandlers,event){shouldStop(event.name)?logHandlerStop("before",event):triggerHandlers(allHandlers.between,event).then(function(){triggerAfter(allHandlers.after,event)}).catch(function(err){logHandlerStop("on",event,err)})}function triggerAfter(handlers,event){shouldStop(event.name)?logHandlerStop("on",event):triggerHandlers(handlers,event).then(function(){shouldStop(event.name)&&logHandlerStop("after",event)}).catch(function(err){logHandlerStop("after",event,err)})}function triggerHandlers(handlers,event){var pHandlers;return pHandlers=handlers.map(function(handler){return shouldStop(event.name)?Promise.reject():handler.apply(self,args)}),Promise.all(pHandlers)}function logHandlerStop(stoppedIn,event,err){err instanceof Error&&logger.error(err),logger.trace({err:err,event:event.name,stoppedIn:stoppedIn},event.name+" handlers stopped")}function shouldStop(name){return stoppedEvents[name]}var self=this,args=[].slice.call(arguments,1);return stoppedEvents={},_.forEach(getEventNames(eventNames),function(eventName){var ns=getNamespace(eventName),name=getName(eventName),mergedHandlers=_(eventHandlers).filter(function(nsHandlers,namespace){return nsHandlers[name]&&("@"===ns||ns===namespace||"*"===namespace)}).reduce(function(acc,nsHandlers){return acc.before=acc.before.concat(nsHandlers[name].before),acc.between=acc.between.concat(nsHandlers[name].between),acc.after=acc.after.concat(nsHandlers[name].after),acc},getHandlerObject());logger.trace({event:eventName,args:args},"trigger %s",eventName),mergedHandlers&&triggerAllHandlers(mergedHandlers,name,ns)}),this},before:function(eventNames,handler){return _.isFunction(handler)&&_.forEach(getEventNames(eventNames),function(eventName){getHandlers(eventName,"before").push(handler)}),this},after:function(eventNames,handler){return _.isFunction(handler)&&_.forEach(getEventNames(eventNames),function(eventName){getHandlers(eventName,"after").push(handler)}),this},stopEvent:function(name){_.isString(name)&&!_.isEmpty(name.trim())&&(stoppedEvents[name.trim()]=!0)},spread:function(destination,eventNames){var self=this;return destination&&_.isFunction(destination.trigger)&&(_.isString(eventNames)&&(eventNames=getEventNames(eventNames)),_.forEach(eventNames,function(eventName){self.on(eventName,function(){var args=[eventName].concat([].slice.call(arguments));destination.trigger.apply(destination,args)})})),this}},targetName,logger,stoppedEvents;return target=target||{},targetName=target.name||target.id||target.serial||uuid(6),logger=eventifierLogger.child({target:targetName}),_(eventApi).functions().forEach(function(method){_.isFunction(target[method])&&eventifierLogger.warn("The target object has already a method named "+method,target),target[method]=function(){var args=[].slice.call(arguments);return eventApi[method].apply(target,args)}}),target}_=_&&_.hasOwnProperty("default")?_["default"]:_,Promise=Promise&&Promise.hasOwnProperty("default")?Promise["default"]:Promise,uuid=uuid&&uuid.hasOwnProperty("default")?uuid["default"]:uuid,loggerFactory=loggerFactory&&loggerFactory.hasOwnProperty("default")?loggerFactory["default"]:loggerFactory;var eventifierLogger=loggerFactory("core/eventifier");return eventifier}),define("core/promiseQueue",["lodash","core/promise","core/eventifier","lib/uuid"],function(_,Promise,eventifier,uuid){'use strict';return _=_&&_.hasOwnProperty("default")?_["default"]:_,Promise=Promise&&Promise.hasOwnProperty("default")?Promise["default"]:Promise,eventifier=eventifier&&eventifier.hasOwnProperty("default")?eventifier["default"]:eventifier,uuid=uuid&&uuid.hasOwnProperty("default")?uuid["default"]:uuid,function(){var queue={},getId=function getId(){var id="promise-"+uuid(6);return"undefined"==typeof queue[id]?id:getId()};return{add:function(promise){return queue[getId()]=promise,this},getValues:function(){return _.values(queue)},clear:function(){return queue={},this},serie:function(promiseFn){var id=getId(),currentQueue=this.getValues(),emitter=eventifier();return queue[id]=new Promise(function(resolve){emitter.on("fulfilled",resolve)}),Promise.all(currentQueue).then(function(){if(_.isFunction(promiseFn))return promiseFn()}).then(function(data){return emitter.trigger("fulfilled"),delete queue[id],data}).catch(function(err){throw queue={},err})}}}}),define("core/store/localstorage",["lodash","core/promise","core/promiseQueue","lib/uuid"],function(_,Promise,promiseQueue,uuid){'use strict';_=_&&_.hasOwnProperty("default")?_["default"]:_,Promise=Promise&&Promise.hasOwnProperty("default")?Promise["default"]:Promise,promiseQueue=promiseQueue&&promiseQueue.hasOwnProperty("default")?promiseQueue["default"]:promiseQueue,uuid=uuid&&uuid.hasOwnProperty("default")?uuid["default"]:uuid;var storage=window.localStorage,knownStoresName="index",idStoreName="id",writingQueue=promiseQueue(),setEntry=function(storeName,key,value){return new Promise(function(resolve,reject){try{storage.setItem("tao-store-"+storeName+"."+key,JSON.stringify(value)),resolve(!0)}catch(ex){reject(ex)}})},getEntry=function(storeName,key){return new Promise(function(resolve,reject){var value;try{value=storage.getItem("tao-store-"+storeName+"."+key),null===value?resolve():resolve(JSON.parse(value))}catch(ex){reject(ex)}})},getKnownStores=function(){return getEntry(knownStoresName,"stores")},registerStore=function(storeName){return getKnownStores().then(function(stores){return stores=stores||{},stores[storeName]={name:storeName,lastOpen:Date.now()},setEntry(knownStoresName,"stores",stores)})},unregisterStore=function(storeName){return getKnownStores().then(function(stores){return stores=stores||{},delete stores[storeName],setEntry(knownStoresName,"stores",stores)})},localStorageBackend=function(storeName){var registered=!1,openStore=function(){return registered?Promise.resolve():registerStore(storeName).then(function(){registered=!0})},name;if(_.isEmpty(storeName)||!_.isString(storeName))throw new TypeError("The store name is required");return name="tao-store-"+storeName+".",{getItem:function(key){return writingQueue.serie(function(){return openStore().then(function(){return getEntry(storeName,key)})})},setItem:function(key,value){return writingQueue.serie(function(){return openStore().then(function(){return setEntry(storeName,key,value)})})},removeItem:function(key){return writingQueue.serie(function(){return openStore().then(function(){return storage.removeItem(name+key),!0})})},getItems:function(){var keyPattern=new RegExp("^"+name);return writingQueue.serie(function(){return openStore().then(function(){return _(storage).map(function(entry,index){return storage.key(index)}).filter(function(key){return keyPattern.test(key)}).reduce(function(acc,key){var exposedKey=key.replace(name,""),value;try{value=storage.getItem(key),null!==value&&(acc[exposedKey]=JSON.parse(value))}catch(ex){acc[exposedKey]=null}return acc},{})})})},clear:function(){var keyPattern=new RegExp("^"+name);return writingQueue.serie(function(){return openStore().then(function(){return _(storage).map(function(entry,index){return storage.key(index)}).filter(function(key){return keyPattern.test(key)}).forEach(function(key){storage.removeItem(key)}),!0})})},removeStore:function(){return this.clear().then(function(){return unregisterStore(storeName)})}}};return localStorageBackend.removeAll=function(validate){return _.isFunction(validate)||(validate=null),getKnownStores().then(function(stores){var removing=_(stores).filter(function(store,storeName){return!validate||validate(storeName,store)}).map(function(store){return store&&store.name?localStorageBackend(store.name).removeStore():Promise.resolve()}).value();return Promise.all(removing)})},localStorageBackend.getAll=function(validate){return getKnownStores().then(function(stores){return _(stores).filter(function(store,storeName){return!validate||validate(storeName,store)}).map(function(store){return store.name}).value()})},localStorageBackend.getStoreIdentifier=function(){var idStore=localStorageBackend(idStoreName);return idStore.getItem(idStoreName).then(function(id){return _.isEmpty(id)?(id=uuid(),idStore.setItem(idStoreName,id).then(function(){return id})):id})},localStorageBackend}),define("core/store/indexeddb",["lodash","core/promise","lib/uuid"],function(_,Promise,uuid){'use strict';function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)?function(obj){return _typeof2(obj)}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":_typeof2(obj)},_typeof(obj)}_=_&&_.hasOwnProperty("default")?_["default"]:_,Promise=Promise&&Promise.hasOwnProperty("default")?Promise["default"]:Promise,uuid=uuid&&uuid.hasOwnProperty("default")?uuid["default"]:uuid;var commonjsGlobal="undefined"==typeof globalThis?"undefined"==typeof window?"undefined"==typeof global?"undefined"==typeof self?{}:self:global:window:globalThis,idbstore=function(fn,module){return module={exports:{}},fn(module,module.exports),module.exports}(function(module){(function(name,definition,global){module.exports?module.exports=definition():global[name]=definition()})("IDBStore",function(){function mixin(target,source){var name,s;for(name in source)s=source[name],s!==empty[name]&&s!==target[name]&&(target[name]=s);return target}var defaultErrorHandler=function(error){throw error},defaultSuccessHandler=function(){},defaults={storeName:"Store",storePrefix:"IDBWrapper-",dbVersion:1,keyPath:"id",autoIncrement:!0,onStoreReady:function(){},onError:defaultErrorHandler,indexes:[],implementationPreference:["indexedDB","webkitIndexedDB","mozIndexedDB","shimIndexedDB"]},IDBStore=function(kwArgs,onStoreReady){for(var key in"undefined"==typeof onStoreReady&&"function"==typeof kwArgs&&(onStoreReady=kwArgs),"[object Object]"!=Object.prototype.toString.call(kwArgs)&&(kwArgs={}),defaults)this[key]="undefined"==typeof kwArgs[key]?defaults[key]:kwArgs[key];this.dbName=this.storePrefix+this.storeName,this.dbVersion=parseInt(this.dbVersion,10)||1,onStoreReady&&(this.onStoreReady=onStoreReady);var env="object"==("undefined"==typeof window?"undefined":_typeof(window))?window:self,availableImplementations=this.implementationPreference.filter(function(implName){return implName in env});this.implementation=availableImplementations[0],this.idb=env[this.implementation],this.keyRange=env.IDBKeyRange||env.webkitIDBKeyRange||env.mozIDBKeyRange,this.consts={READ_ONLY:"readonly",READ_WRITE:"readwrite",VERSION_CHANGE:"versionchange",NEXT:"next",NEXT_NO_DUPLICATE:"nextunique",PREV:"prev",PREV_NO_DUPLICATE:"prevunique"},this.openDB()},proto={constructor:IDBStore,version:"1.7.0",db:null,dbName:null,dbVersion:null,store:null,storeName:null,storePrefix:null,keyPath:null,autoIncrement:null,indexes:null,implementationPreference:null,implementation:"",onStoreReady:null,onError:null,_insertIdCount:0,openDB:function(){var openRequest=this.idb.open(this.dbName,this.dbVersion),preventSuccessCallback=!1;openRequest.onerror=function(error){var gotVersionErr=!1;"error"in error.target?gotVersionErr="VersionError"==error.target.error.name:"errorCode"in error.target&&(gotVersionErr=12==error.target.errorCode),gotVersionErr?this.onError(new Error("The version number provided is lower than the existing one.")):this.onError(error)}.bind(this),openRequest.onsuccess=function(event){if(!preventSuccessCallback){if(this.db)return void this.onStoreReady();if(this.db=event.target.result,"string"==typeof this.db.version)return void this.onError(new Error("The IndexedDB implementation in this browser is outdated. Please upgrade your browser."));if(!this.db.objectStoreNames.contains(this.storeName))return void this.onError(new Error("Object store couldn't be created."));var emptyTransaction=this.db.transaction([this.storeName],this.consts.READ_ONLY);this.store=emptyTransaction.objectStore(this.storeName);var existingIndexes=Array.prototype.slice.call(this.getIndexList());this.indexes.forEach(function(indexData){var indexName=indexData.name;if(!indexName)return preventSuccessCallback=!0,void this.onError(new Error("Cannot create index: No index name given."));if(this.normalizeIndexData(indexData),this.hasIndex(indexName)){var actualIndex=this.store.index(indexName),complies=this.indexComplies(actualIndex,indexData);complies||(preventSuccessCallback=!0,this.onError(new Error("Cannot modify index \""+indexName+"\" for current version. Please bump version number to "+(this.dbVersion+1)+"."))),existingIndexes.splice(existingIndexes.indexOf(indexName),1)}else preventSuccessCallback=!0,this.onError(new Error("Cannot create new index \""+indexName+"\" for current version. Please bump version number to "+(this.dbVersion+1)+"."))},this),existingIndexes.length&&(preventSuccessCallback=!0,this.onError(new Error("Cannot delete index(es) \""+existingIndexes.toString()+"\" for current version. Please bump version number to "+(this.dbVersion+1)+"."))),preventSuccessCallback||this.onStoreReady()}}.bind(this),openRequest.onupgradeneeded=function(event){if(this.db=event.target.result,this.db.objectStoreNames.contains(this.storeName))this.store=event.target.transaction.objectStore(this.storeName);else{var optionalParameters={autoIncrement:this.autoIncrement};null!==this.keyPath&&(optionalParameters.keyPath=this.keyPath),this.store=this.db.createObjectStore(this.storeName,optionalParameters)}var existingIndexes=Array.prototype.slice.call(this.getIndexList());this.indexes.forEach(function(indexData){var indexName=indexData.name;if(indexName||(preventSuccessCallback=!0,this.onError(new Error("Cannot create index: No index name given."))),this.normalizeIndexData(indexData),this.hasIndex(indexName)){var actualIndex=this.store.index(indexName),complies=this.indexComplies(actualIndex,indexData);complies||(this.store.deleteIndex(indexName),this.store.createIndex(indexName,indexData.keyPath,{unique:indexData.unique,multiEntry:indexData.multiEntry})),existingIndexes.splice(existingIndexes.indexOf(indexName),1)}else this.store.createIndex(indexName,indexData.keyPath,{unique:indexData.unique,multiEntry:indexData.multiEntry})},this),existingIndexes.length&&existingIndexes.forEach(function(_indexName){this.store.deleteIndex(_indexName)},this)}.bind(this)},deleteDatabase:function(onSuccess,onError){if(this.idb.deleteDatabase){this.db.close();var deleteRequest=this.idb.deleteDatabase(this.dbName);deleteRequest.onsuccess=onSuccess,deleteRequest.onerror=onError}else onError(new Error("Browser does not support IndexedDB deleteDatabase!"))},put:function(key,value,onSuccess,onError){null!==this.keyPath&&(onError=onSuccess,onSuccess=value,value=key),onError||(onError=defaultErrorHandler),onSuccess||(onSuccess=defaultSuccessHandler);var hasSuccess=!1,result=null,putTransaction=this.db.transaction([this.storeName],this.consts.READ_WRITE),putRequest;return putTransaction.oncomplete=function(){var callback=hasSuccess?onSuccess:onError;callback(result)},putTransaction.onabort=onError,putTransaction.onerror=onError,null===this.keyPath?putRequest=putTransaction.objectStore(this.storeName).put(value,key):(this._addIdPropertyIfNeeded(value),putRequest=putTransaction.objectStore(this.storeName).put(value)),putRequest.onsuccess=function(event){hasSuccess=!0,result=event.target.result},putRequest.onerror=onError,putTransaction},get:function(key,onSuccess,onError){onError||(onError=defaultErrorHandler),onSuccess||(onSuccess=defaultSuccessHandler);var hasSuccess=!1,result=null,getTransaction=this.db.transaction([this.storeName],this.consts.READ_ONLY);getTransaction.oncomplete=function(){var callback=hasSuccess?onSuccess:onError;callback(result)},getTransaction.onabort=onError,getTransaction.onerror=onError;var getRequest=getTransaction.objectStore(this.storeName).get(key);return getRequest.onsuccess=function(event){hasSuccess=!0,result=event.target.result},getRequest.onerror=onError,getTransaction},remove:function(key,onSuccess,onError){onError||(onError=defaultErrorHandler),onSuccess||(onSuccess=defaultSuccessHandler);var hasSuccess=!1,result=null,removeTransaction=this.db.transaction([this.storeName],this.consts.READ_WRITE);removeTransaction.oncomplete=function(){var callback=hasSuccess?onSuccess:onError;callback(result)},removeTransaction.onabort=onError,removeTransaction.onerror=onError;var deleteRequest=removeTransaction.objectStore(this.storeName)["delete"](key);return deleteRequest.onsuccess=function(event){hasSuccess=!0,result=event.target.result},deleteRequest.onerror=onError,removeTransaction},batch:function(dataArray,onSuccess,onError){if(onError||(onError=defaultErrorHandler),onSuccess||(onSuccess=defaultSuccessHandler),"[object Array]"!=Object.prototype.toString.call(dataArray))onError(new Error("dataArray argument must be of type Array."));else if(0===dataArray.length)return onSuccess(!0);var count=dataArray.length,called=!1,hasSuccess=!1,batchTransaction=this.db.transaction([this.storeName],this.consts.READ_WRITE);batchTransaction.oncomplete=function(){var callback=hasSuccess?onSuccess:onError;callback(hasSuccess)},batchTransaction.onabort=onError,batchTransaction.onerror=onError;var onItemSuccess=function(){count--,0!==count||called||(called=!0,hasSuccess=!0)};return dataArray.forEach(function(operation){var type=operation.type,key=operation.key,value=operation.value,onItemError=function(err){batchTransaction.abort(),called||(called=!0,onError(err,type,key))};if("remove"==type){var deleteRequest=batchTransaction.objectStore(this.storeName)["delete"](key);deleteRequest.onsuccess=onItemSuccess,deleteRequest.onerror=onItemError}else if("put"==type){var putRequest;null===this.keyPath?putRequest=batchTransaction.objectStore(this.storeName).put(value,key):(this._addIdPropertyIfNeeded(value),putRequest=batchTransaction.objectStore(this.storeName).put(value)),putRequest.onsuccess=onItemSuccess,putRequest.onerror=onItemError}},this),batchTransaction},putBatch:function(dataArray,onSuccess,onError){var batchData=dataArray.map(function(item){return{type:"put",value:item}});return this.batch(batchData,onSuccess,onError)},upsertBatch:function(dataArray,options,onSuccess,onError){"function"==typeof options&&(onSuccess=options,onError=onSuccess,options={}),onError||(onError=defaultErrorHandler),onSuccess||(onSuccess=defaultSuccessHandler),options||(options={}),"[object Array]"!=Object.prototype.toString.call(dataArray)&&onError(new Error("dataArray argument must be of type Array."));var keyField=options.keyField||this.keyPath,count=dataArray.length,called=!1,hasSuccess=!1,index=0,batchTransaction=this.db.transaction([this.storeName],this.consts.READ_WRITE);batchTransaction.oncomplete=function(){hasSuccess?onSuccess(dataArray):onError(!1)},batchTransaction.onabort=onError,batchTransaction.onerror=onError;var onItemSuccess=function(event){var record=dataArray[index++];record[keyField]=event.target.result,count--,0!==count||called||(called=!0,hasSuccess=!0)};return dataArray.forEach(function(record){var key=record.key,onItemError=function(err){batchTransaction.abort(),called||(called=!0,onError(err))},putRequest;null===this.keyPath?putRequest=batchTransaction.objectStore(this.storeName).put(record,key):(this._addIdPropertyIfNeeded(record),putRequest=batchTransaction.objectStore(this.storeName).put(record)),putRequest.onsuccess=onItemSuccess,putRequest.onerror=onItemError},this),batchTransaction},removeBatch:function(keyArray,onSuccess,onError){var batchData=keyArray.map(function(key){return{type:"remove",key:key}});return this.batch(batchData,onSuccess,onError)},getBatch:function(keyArray,onSuccess,onError,arrayType){if(onError||(onError=defaultErrorHandler),onSuccess||(onSuccess=defaultSuccessHandler),arrayType||(arrayType="sparse"),"[object Array]"!=Object.prototype.toString.call(keyArray))onError(new Error("keyArray argument must be of type Array."));else if(0===keyArray.length)return onSuccess([]);var data=[],count=keyArray.length,hasSuccess=!1,result=null,batchTransaction=this.db.transaction([this.storeName],this.consts.READ_ONLY);batchTransaction.oncomplete=function(){var callback=hasSuccess?onSuccess:onError;callback(result)},batchTransaction.onabort=onError,batchTransaction.onerror=onError;var onItemSuccess=function(event){event.target.result||"dense"==arrayType?data.push(event.target.result):"sparse"==arrayType&&data.length++,count--,0===count&&(hasSuccess=!0,result=data)};return keyArray.forEach(function(key){var onItemError=function(err){result=err,onError(err),batchTransaction.abort()},getRequest=batchTransaction.objectStore(this.storeName).get(key);getRequest.onsuccess=onItemSuccess,getRequest.onerror=onItemError},this),batchTransaction},getAll:function(onSuccess,onError){onError||(onError=defaultErrorHandler),onSuccess||(onSuccess=defaultSuccessHandler);var getAllTransaction=this.db.transaction([this.storeName],this.consts.READ_ONLY),store=getAllTransaction.objectStore(this.storeName);return store.getAll?this._getAllNative(getAllTransaction,store,onSuccess,onError):this._getAllCursor(getAllTransaction,store,onSuccess,onError),getAllTransaction},_getAllNative:function(getAllTransaction,store,onSuccess,onError){var hasSuccess=!1,result=null;getAllTransaction.oncomplete=function(){var callback=hasSuccess?onSuccess:onError;callback(result)},getAllTransaction.onabort=onError,getAllTransaction.onerror=onError;var getAllRequest=store.getAll();getAllRequest.onsuccess=function(event){hasSuccess=!0,result=event.target.result},getAllRequest.onerror=onError},_getAllCursor:function(getAllTransaction,store,onSuccess,onError){var all=[],hasSuccess=!1,result=null;getAllTransaction.oncomplete=function(){var callback=hasSuccess?onSuccess:onError;callback(result)},getAllTransaction.onabort=onError,getAllTransaction.onerror=onError;var cursorRequest=store.openCursor();cursorRequest.onsuccess=function(event){var cursor=event.target.result;cursor?(all.push(cursor.value),cursor["continue"]()):(hasSuccess=!0,result=all)},cursorRequest.onError=onError},clear:function(onSuccess,onError){onError||(onError=defaultErrorHandler),onSuccess||(onSuccess=defaultSuccessHandler);var hasSuccess=!1,result=null,clearTransaction=this.db.transaction([this.storeName],this.consts.READ_WRITE);clearTransaction.oncomplete=function(){var callback=hasSuccess?onSuccess:onError;callback(result)},clearTransaction.onabort=onError,clearTransaction.onerror=onError;var clearRequest=clearTransaction.objectStore(this.storeName).clear();return clearRequest.onsuccess=function(event){hasSuccess=!0,result=event.target.result},clearRequest.onerror=onError,clearTransaction},_addIdPropertyIfNeeded:function(dataObj){"undefined"==typeof dataObj[this.keyPath]&&(dataObj[this.keyPath]=this._insertIdCount++ +Date.now())},getIndexList:function(){return this.store.indexNames},hasIndex:function(indexName){return this.store.indexNames.contains(indexName)},normalizeIndexData:function(indexData){indexData.keyPath=indexData.keyPath||indexData.name,indexData.unique=!!indexData.unique,indexData.multiEntry=!!indexData.multiEntry},indexComplies:function(actual,expected){var complies=["keyPath","unique","multiEntry"].every(function(key){if("multiEntry"==key&&void 0===actual[key]&&!1===expected[key])return!0;if("keyPath"==key&&"[object Array]"==Object.prototype.toString.call(expected[key])){var exp=expected.keyPath,act=actual.keyPath;if("string"==typeof act)return exp.toString()==act;if("function"!=typeof act.contains&&"function"!=typeof act.indexOf)return!1;if(act.length!==exp.length)return!1;for(var i=0,m=exp.length;i<m;i++)if(!(act.contains&&act.contains(exp[i])||act.indexOf(-1!==exp[i])))return!1;return!0}return expected[key]==actual[key]});return complies},iterate:function(onItem,options){options=mixin({index:null,order:"ASC",autoContinue:!0,filterDuplicates:!1,keyRange:null,writeAccess:!1,onEnd:null,onError:defaultErrorHandler,limit:1/0,offset:0,allowItemRejection:!1},options||{});var directionType="desc"==options.order.toLowerCase()?"PREV":"NEXT";options.filterDuplicates&&(directionType+="_NO_DUPLICATE");var hasSuccess=!1,cursorTransaction=this.db.transaction([this.storeName],this.consts[options.writeAccess?"READ_WRITE":"READ_ONLY"]),cursorTarget=cursorTransaction.objectStore(this.storeName);options.index&&(cursorTarget=cursorTarget.index(options.index));var recordCount=0;cursorTransaction.oncomplete=function(){return hasSuccess?void(options.onEnd?options.onEnd():onItem(null)):void options.onError(null)},cursorTransaction.onabort=options.onError,cursorTransaction.onerror=options.onError;var cursorRequest=cursorTarget.openCursor(options.keyRange,this.consts[directionType]);return cursorRequest.onerror=options.onError,cursorRequest.onsuccess=function(event){var cursor=event.target.result;if(!cursor)hasSuccess=!0;else if(options.offset)cursor.advance(options.offset),options.offset=0;else{var onItemReturn=onItem(cursor.value,cursor,cursorTransaction);options.allowItemRejection&&!1===onItemReturn||recordCount++,options.autoContinue&&(recordCount+options.offset<options.limit?cursor["continue"]():hasSuccess=!0)}},cursorTransaction},query:function(onSuccess,options){var result=[],processedItems=0;return options=options||{},options.autoContinue=!0,options.writeAccess=!1,options.allowItemRejection=!!options.filter,options.onEnd=function(){onSuccess(result,processedItems)},this.iterate(function(item){processedItems++;var accept=!options.filter||options.filter(item);return!1!==accept&&result.push(item),accept},options)},count:function(onSuccess,options){options=mixin({index:null,keyRange:null},options||{});var onError=options.onError||defaultErrorHandler,hasSuccess=!1,result=null,cursorTransaction=this.db.transaction([this.storeName],this.consts.READ_ONLY);cursorTransaction.oncomplete=function(){var callback=hasSuccess?onSuccess:onError;callback(result)},cursorTransaction.onabort=onError,cursorTransaction.onerror=onError;var cursorTarget=cursorTransaction.objectStore(this.storeName);options.index&&(cursorTarget=cursorTarget.index(options.index));var countRequest=cursorTarget.count(options.keyRange);return countRequest.onsuccess=function(evt){hasSuccess=!0,result=evt.target.result},countRequest.onError=onError,cursorTransaction},makeKeyRange:function(options){var hasLower="undefined"!=typeof options.lower,hasUpper="undefined"!=typeof options.upper,isOnly="undefined"!=typeof options.only,keyRange;switch(!0){case isOnly:keyRange=this.keyRange.only(options.only);break;case hasLower&&hasUpper:keyRange=this.keyRange.bound(options.lower,options.upper,options.excludeLower,options.excludeUpper);break;case hasLower:keyRange=this.keyRange.lowerBound(options.lower,options.excludeLower);break;case hasUpper:keyRange=this.keyRange.upperBound(options.upper,options.excludeUpper);break;default:throw new Error("Cannot create KeyRange. Provide one or both of \"lower\" or \"upper\" value, or an \"only\" value.");}return keyRange}},empty={};return IDBStore.prototype=proto,IDBStore.version=proto.version,IDBStore},commonjsGlobal)}),idStoreName="id",isIndexedDB2="undefined"!=typeof IDBObjectStore&&"getAll"in IDBObjectStore.prototype,openStore=function(storeName){return new Promise(function(resolve,reject){var store=new idbstore({dbVersion:1,storeName:storeName,storePrefix:"tao-store-",keyPath:"key",autoIncrement:!0,onStoreReady:function(){store.db.onversionchange=function(e){e&&e.newVersion||store.db.close()},resolve(store)},onError:reject})})},setEntry=function(store,key,value){return new Promise(function(resolve,reject){store.put({key:key,value:value},function(returnKey){resolve(returnKey===key)},reject)})},getEntry=function(store,key){return new Promise(function(resolve,reject){store.get(key,function(entry){return entry&&"undefined"!=typeof entry.value?void resolve(entry.value):resolve(entry)},reject)})},getEntries=function(store){return new Promise(function(resolve,reject){var success=function(entries){return _.isArray(entries)?void resolve(_.reduce(entries,function(acc,entry){return entry.key&&entry.value&&(acc[entry.key]=entry.value),acc},{})):resolve({})};store.getAll(success,reject)})},removeEntry=function(store,key){return new Promise(function(resolve,reject){store.remove(key,function(result){resolve(!1!==result)},reject)})},getKnownStores=function(){return knownStores||(knownStores=openStore("index")),knownStores},registerStore=function(storeName){return getKnownStores().then(function(store){return setEntry(store,storeName,{name:storeName,lastOpen:Date.now()})})},unregisterStore=function(storeName){return getKnownStores().then(function(store){return removeEntry(store,storeName)})},deleteStore=function(store,storeName){return new Promise(function(resolve,reject){var success=function(){unregisterStore(storeName).then(function(){resolve(!0)}).catch(reject)};isIndexedDB2?store.deleteDatabase(success,reject):store.clear(success,reject)})},indexDbBackend=function(storeName){var getStore=function(){return innerStore||(innerStore=openStore(storeName).then(function(store){return registerStore(storeName).then(function(){return Promise.resolve(store)})})),innerStore},ensureSerie=function(getWritingPromise){return writePromise?new Promise(function(resolve,reject){var runWrite=function(){var p=getWritingPromise();writePromise=p,p.then(resolve).catch(reject)};writePromise.then(runWrite).catch(runWrite)}):(writePromise=getWritingPromise(),writePromise)},innerStore,writePromise;if(_.isEmpty(storeName)||!_.isString(storeName))throw new TypeError("The store name is required");return{getItem:function(key){return ensureSerie(function(){return getStore().then(function(store){return getEntry(store,key)})})},setItem:function(key,value){return ensureSerie(function(){return getStore().then(function(store){return setEntry(store,key,value)})})},removeItem:function(key){return ensureSerie(function(){return getStore().then(function(store){return removeEntry(store,key)})})},getItems:function(){return ensureSerie(function(){return getStore().then(function(store){return getEntries(store)})})},clear:function(){return ensureSerie(function(){return getStore().then(function(store){return new Promise(function(resolve,reject){store.clear(function(){resolve(!0)},reject)})})})},removeStore:function(){return ensureSerie(function(){return getStore().then(function(store){return deleteStore(store,storeName)})})}}},knownStores;return indexDbBackend.removeAll=function(validate){return _.isFunction(validate)||(validate=null),getKnownStores().then(function(store){return new Promise(function(resolve,reject){function cleanUp(entries){var all=[];_.forEach(entries,function(entry){var storeName=entry&&entry.key;storeName&&all.push(openStore(storeName).then(function(storeToRemove){if(!validate||validate(storeName,entry.value))return deleteStore(storeToRemove,storeName)}))}),Promise.all(all).then(resolve).catch(reject)}store.getAll(cleanUp,reject)})})},indexDbBackend.getAll=function(validate){return _.isFunction(validate)||(validate=function(){return!0}),getKnownStores().then(function(store){return new Promise(function(resolve,reject){store.getAll(function(entries){var storeNames=_(entries).filter(function(entry){return entry&&entry.key&&validate(entry.key,entry.value)}).map(function(entry){return entry.key}).value();return resolve(storeNames)},reject)})})},indexDbBackend.getStoreIdentifier=function(){return openStore(idStoreName).then(function(store){return getEntry(store,idStoreName).then(function(id){return _.isEmpty(id)?(id=uuid(),setEntry(store,idStoreName,id).then(function(){return id})):id})})},indexDbBackend}),define("core/store/memory",["lodash","core/promise","lib/uuid"],function(_,Promise,uuid){'use strict';_=_&&_.hasOwnProperty("default")?_["default"]:_,Promise=Promise&&Promise.hasOwnProperty("default")?Promise["default"]:Promise,uuid=uuid&&uuid.hasOwnProperty("default")?uuid["default"]:uuid;var memoryStore={},memoryStorageBackend=function(storeName){if(_.isEmpty(storeName)||!_.isString(storeName))throw new TypeError("The store name is required");return memoryStore[storeName]=memoryStore[storeName]||{},{getItem:function(key){return _.isPlainObject(memoryStore[storeName])?Promise.resolve(memoryStore[storeName][key]):Promise.resolve()},setItem:function(key,value){return _.isPlainObject(memoryStore[storeName])||(memoryStore[storeName]={}),memoryStore[storeName][key]=value,Promise.resolve(!0)},removeItem:function(key){return memoryStore[storeName]=_.omit(memoryStore[storeName],key),Promise.resolve("undefined"==typeof memoryStore[storeName][key])},getItems:function(){return Promise.resolve(memoryStore[storeName])},clear:function(){return memoryStore[storeName]={},Promise.resolve(!0)},removeStore:function(){return memoryStore=_.omit(memoryStore,storeName),Promise.resolve("undefined"==typeof memoryStore[storeName])}}},idStore;return memoryStorageBackend.removeAll=function(validate){return _.isFunction(validate)||(validate=null),memoryStore=_.omit(memoryStore,function(store,storeName){return!validate||validate(storeName)}),Promise.resolve(!0)},memoryStorageBackend.getAll=function(validate){var storeNames=[];return _.isFunction(validate)||(validate=null),storeNames=_(memoryStore).map(function(store,storeName){return storeName}).filter(function(storeName){return!validate||validate(storeName)}).value(),Promise.resolve(storeNames)},memoryStorageBackend.getStoreIdentifier=function(){return _.isEmpty(idStore)&&(idStore=uuid()),Promise.resolve(idStore)},memoryStorageBackend}),define("core/store",["lodash","moment","module","core/logger","core/promise","core/store/localstorage","core/store/indexeddb","core/store/memory"],function(_,moment,module,loggerFactory,Promise,localStorageBackend,indexedDBBackend,memoryBackend){'use strict';_=_&&_.hasOwnProperty("default")?_["default"]:_,moment=moment&&moment.hasOwnProperty("default")?moment["default"]:moment,module=module&&module.hasOwnProperty("default")?module["default"]:module,loggerFactory=loggerFactory&&loggerFactory.hasOwnProperty("default")?loggerFactory["default"]:loggerFactory,Promise=Promise&&Promise.hasOwnProperty("default")?Promise["default"]:Promise,localStorageBackend=localStorageBackend&&localStorageBackend.hasOwnProperty("default")?localStorageBackend["default"]:localStorageBackend,indexedDBBackend=indexedDBBackend&&indexedDBBackend.hasOwnProperty("default")?indexedDBBackend["default"]:indexedDBBackend,memoryBackend=memoryBackend&&memoryBackend.hasOwnProperty("default")?memoryBackend["default"]:memoryBackend;var supportsIndexedDB=!1,dectectionDone=!1,quotaChecked=!1,backendApi=["removeAll","getAll","getStoreIdentifier"],storeApi=["getItem","setItem","removeItem","getItems","clear","removeStore"],logger=loggerFactory("core/store"),config=_.defaults(module.config()||{},{lowSpaceRatio:80,invalidation:{staled:"P2W",oldster:"P2M"}}),isIndexDBSupported=function(){return dectectionDone?Promise.resolve(supportsIndexedDB):new Promise(function(resolve){var done=function(result){return supportsIndexedDB=!!result,dectectionDone=!0,resolve(supportsIndexedDB)},test,indexedDB;try{if(indexedDB=window.indexedDB||window.webkitIndexedDB||window.mozIndexedDB||window.OIndexedDB||window.msIndexedDB,!indexedDB)return done(!1);test=indexedDB.open("__feature_test",1),test.onsuccess=function(){if(test.result)return test.result.close(),done(!0)},test.onerror=function(e){return e.preventDefault(),done(!1),!1}}catch(err){done(!1)}})},checkQuotas=function(){!quotaChecked&&"storage"in window.navigator&&window.navigator.storage.estimate&&window.navigator.storage.estimate().then(function(estimate){var usedRatio=0;_.isNumber(estimate.usage)&&_.isNumber(estimate.quota)&&0<estimate.quota&&(usedRatio=estimate.usage/estimate.quota,usedRatio>config.lowSpaceRatio?(logger.warn("The browser storage is getting low "+usedRatio.toFixed(2)+"% used",estimate),logger.warn("We will attempt to clean oldster databases in persistent backends"),store.cleanUpSpace(config.invalidation.oldster,[],localStorageBackend),isIndexDBSupported&&store.cleanUpSpace(config.invalidation.oldster,[],indexedDBBackend)):logger.debug("Browser storage estimate : "+usedRatio.toFixed(2)+"% used",estimate))}).catch(function(err){logger.warn("Unable to retrieve quotas : "+err.message)}),quotaChecked=!0},isBackendApiValid=function(backend){return _.all(backendApi,function(method){return _.isFunction(backend[method])})},isStorageApiValid=function(storage){return _.all(storeApi,function(method){return _.isFunction(storage[method])})},loadBackend=function(preselectedBackend){return isIndexDBSupported().then(function(){var backend=preselectedBackend||(supportsIndexedDB?indexedDBBackend:localStorageBackend);return _.isFunction(backend)?isBackendApiValid(backend)?(backend!==memoryBackend&&checkQuotas(),backend):Promise.reject(new TypeError("This backend doesn't comply with the store backend API")):Promise.reject(new TypeError("No backend, no storage!"))})},store;store=function(storeName,preselectedBackend){return loadBackend(preselectedBackend).then(function(backend){var storeInstance=backend(storeName);return isStorageApiValid(storeInstance)?storeInstance:Promise.reject(new TypeError("The store doesn't comply with the Storage interface"))})},store.backends={localStorage:localStorageBackend,indexedDB:indexedDBBackend,memory:memoryBackend},store.removeAll=function(validate,preselectedBackend){return loadBackend(preselectedBackend).then(function(backend){return backend.removeAll(validate)})},store.cleanUpSpace=function(since,storeNamePattern,preselectedBackend){var invalidate=function(storeName,storeEntry){return!!(storeName&&storeEntry)&&(!(storeNamePattern instanceof RegExp)||storeNamePattern.test(storeName))&&_.isNumber(storeEntry.lastOpen)&&_.isNumber(tsThreshold)&&storeEntry.lastOpen<=tsThreshold},tsThreshold;return _.isNumber(since)&&0<since?tsThreshold=since:(!_.isString(since)&&(since=config.invalidation.oldster),tsThreshold=moment().subtract(moment.duration(since)).valueOf()),logger.info("Trying to remove stores lastly opened before "+tsThreshold+"("+since+")"),store.removeAll(invalidate,preselectedBackend)},store.getAll=function(validate,preselectedBackend){return loadBackend(preselectedBackend).then(function(backend){return backend.getAll(validate)})},store.getIdentifier=function(preselectedBackend){return loadBackend(preselectedBackend).then(function(backend){return backend.getStoreIdentifier()})};var store$1=store;return store$1}),define("core/tokenStore",["lodash","core/promise","core/store"],function(_,Promise,store){'use strict';function tokenStoreFactory(options){var config=_.defaults(options||{},defaultConfig),getStore=function(){return store("tokenStore.tokens",store.backends.memory)};return{dequeue:function(){var self=this;return self.getIndex().then(function(latestIndex){var key=_.first(latestIndex);return key?getStore().then(function(storage){return storage.getItem(key)}).then(function(token){return self.remove(key).then(function(){return token})}):Promise.resolve()})},enqueue:function(token){var self=this;return _.isString(token)&&(token={value:token,receivedAt:Date.now()}),getStore().then(function(storage){return storage.setItem(token.value,token)}).then(function(updated){return!!updated&&self.enforceMaxSize().then(function(){return!0})})},getIndex:function(){return this.getTokens().then(function(tokens){return _.chain(tokens).values().sort(function(t1,t2){return t1.receivedAt-t2.receivedAt}).map("value").value()})},has:function(key){return this.getIndex().then(function(latestIndex){return _.contains(latestIndex,key)})},remove:function(key){return this.has(key).then(function(result){return!!result&&getStore().then(function(storage){return storage.removeItem(key)})})},clear:function(){return getStore().then(function(storage){return storage.clear()})},getTokens:function(){return getStore().then(function(storage){return storage.getItems()})},getSize:function(){return this.getIndex().then(function(latestIndex){return latestIndex.length})},setMaxSize:function(size){var self=this;_.isNumber(size)&&0<size&&size!==config.maxSize&&(config.maxSize=size,self.enforceMaxSize())},enforceMaxSize:function(){var self=this;return this.getIndex().then(function(latestIndex){var excess=latestIndex.length-config.maxSize,keysToRemove;return!(0<excess)||(keysToRemove=latestIndex.slice(0,excess),Promise.all(_.map(keysToRemove,function(key){return self.remove(key)})))})},checkExpiry:function(token){return!(Date.now()-token.receivedAt>config.tokenTimeLimit)||this.remove(token.value)},expireOldTokens:function(){var self=this;return self.getTokens().then(function(tokens){return _.reduce(tokens,function(previousPromise,nextToken){return previousPromise.then(function(){return self.checkExpiry(nextToken)})},Promise.resolve()).then(function(){return!0})})}}}_=_&&_.hasOwnProperty("default")?_["default"]:_,Promise=Promise&&Promise.hasOwnProperty("default")?Promise["default"]:Promise,store=store&&store.hasOwnProperty("default")?store["default"]:store;var defaultConfig={maxSize:6,tokenTimeLimit:1440000};return tokenStoreFactory}),define("core/tokenHandler",["lodash","module","core/tokenStore","core/promise","core/promiseQueue"],function(_,module,tokenStoreFactory,Promise,promiseQueue){'use strict';function tokenHandlerFactory(options){var tokenStore;return _.isString(options)&&(options={initialToken:options}),options=_.defaults({},options,defaults),tokenStore=tokenStoreFactory(options),{getToken:function(){var self=this,initialToken=options.initialToken,getFirstTokenValue=function(){return tokenStore.dequeue().then(function(currentToken){return currentToken?currentToken.value:null})};return initialToken?(options.initialToken=null,Promise.resolve(initialToken)):tokenStore.expireOldTokens().then(function(){return tokenStore.getSize()}).then(function(queueSize){return 0<queueSize?getFirstTokenValue():clientConfigFetched?Promise.reject(new Error("No tokens available. Please refresh the page.")):self.getClientConfigTokens().then(getFirstTokenValue)})},setToken:function(newToken){return tokenStore.enqueue(newToken)},getClientConfigTokens:function(){var self=this,clientTokens=_.map(module.config().tokens,function(serverToken){return{value:serverToken,receivedAt:Date.now()}});return clientConfigFetched=!0,Promise.resolve(clientTokens).then(function(newTokens){var setTokenQueue=promiseQueue();return _.forEach(newTokens,function(token){setTokenQueue.serie(function(){return self.setToken(token)})}),setTokenQueue.serie(function(){return!0})})},clearStore:function(){return tokenStore.clear()},getQueueLength:function(){return tokenStore.getSize()},setMaxSize:function(size){tokenStore.setMaxSize(size)}}}_=_&&_.hasOwnProperty("default")?_["default"]:_,module=module&&module.hasOwnProperty("default")?module["default"]:module,tokenStoreFactory=tokenStoreFactory&&tokenStoreFactory.hasOwnProperty("default")?tokenStoreFactory["default"]:tokenStoreFactory,Promise=Promise&&Promise.hasOwnProperty("default")?Promise["default"]:Promise,promiseQueue=promiseQueue&&promiseQueue.hasOwnProperty("default")?promiseQueue["default"]:promiseQueue;var clientConfigFetched=!1,defaults={maxSize:6,tokenTimeLimit:1440000};return tokenHandlerFactory}),define("core/request",["jquery","lodash","i18n","module","context","core/promise","core/promiseQueue","core/tokenHandler","core/logger"],function($,_,__,module,context,Promise,promiseQueue,tokenHandlerFactory,loggerFactory){'use strict';function request(options){function runRequest(){var computeHeaders=function(){var headers=_.extend({},options.headers);return options.noToken?Promise.resolve(headers):tokenHandler.getToken().then(function(token){return headers["X-CSRF-Token"]=token||"none",headers})},setTokenFromXhr=function(xhr){var token;return _.isFunction(xhr.getResponseHeader)&&(token=xhr.getResponseHeader("X-CSRF-Token"),logger.debug("received %s header %s","X-CSRF-Token",token),token)?tokenHandler.setToken(token):Promise.resolve()};return computeHeaders().then(function(customHeaders){return new Promise(function(resolve,reject){var noop;$.ajax({url:options.url,method:options.method||"GET",headers:customHeaders,data:options.data,contentType:options.contentType||noop,dataType:options.dataType||"json",async:!0,timeout:1e3*options.timeout||1e3*context.timeout||0,beforeSend:function(){_.isEmpty(customHeaders)||logger.debug("sending %s header %s","X-CSRF-Token",customHeaders&&customHeaders["X-CSRF-Token"])},global:!options.background}).done(function(response,status,xhr){setTokenFromXhr(xhr).then(function(){return 204===xhr.status||response&&204===response.errorCode||"nocontent"===status?resolve():403===xhr.status||response&&403===response.errorCode?reject(createError(response,xhr.status+" : "+xhr.statusText,xhr.status,0<xhr.readyState)):200===xhr.status||response&&!0===response.success?resolve(response):void reject(createError(response,__("The server has sent an empty response"),xhr.status,0<xhr.readyState))}).catch(function(error){logger.error(error),reject(createError(response,error,xhr.status,0<xhr.readyState))})}).fail(function(xhr,textStatus,errorThrown){var response;try{response=JSON.parse(xhr.responseText)}catch(parseErr){response={}}response=_.defaults(response,{success:!1,source:"network",cause:options.url,purpose:"proxy",context:this,code:xhr.status,sent:0<xhr.readyState,type:"error",message:errorThrown||__("An error occurred!")}),setTokenFromXhr(xhr).then(function(){reject(createError(response,xhr.status+" : "+xhr.statusText,xhr.status,0<xhr.readyState))}).catch(function(error){logger.error(error),reject(createError(response,error,xhr.status,0<xhr.readyState))})})})})}if(module.config().noToken&&(options.noToken=!0),_.isEmpty(options.url))throw new TypeError("At least give a URL...");return tokenHandler.getQueueLength().then(function(queueLength){return!0===options.noToken?runRequest():options.sequential||1===queueLength?queue.serie(runRequest):runRequest()})}$=$&&$.hasOwnProperty("default")?$["default"]:$,_=_&&_.hasOwnProperty("default")?_["default"]:_,__=__&&__.hasOwnProperty("default")?__["default"]:__,module=module&&module.hasOwnProperty("default")?module["default"]:module,context=context&&context.hasOwnProperty("default")?context["default"]:context,Promise=Promise&&Promise.hasOwnProperty("default")?Promise["default"]:Promise,promiseQueue=promiseQueue&&promiseQueue.hasOwnProperty("default")?promiseQueue["default"]:promiseQueue,tokenHandlerFactory=tokenHandlerFactory&&tokenHandlerFactory.hasOwnProperty("default")?tokenHandlerFactory["default"]:tokenHandlerFactory,loggerFactory=loggerFactory&&loggerFactory.hasOwnProperty("default")?loggerFactory["default"]:loggerFactory;var tokenHandler=tokenHandlerFactory(),queue=promiseQueue(),logger=loggerFactory("core/request"),createError=function(response,fallbackMessage,httpCode,httpSent){var err;return err=response&&response.errorCode?new Error(response.errorCode+" : "+(response.errorMsg||response.errorMessage||response.error)):new Error(fallbackMessage),err.response=response,err.sent=httpSent,err.source=response.source||"request",_.isNumber(httpCode)&&(err.code=httpCode),err};return request}),define("util/url",["lodash","context"],function(_,context){'use strict';function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)?function(obj){return _typeof2(obj)}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":_typeof2(obj)},_typeof(obj)}_=_&&_.hasOwnProperty("default")?_["default"]:_,context=context&&context.hasOwnProperty("default")?context["default"]:context;var parsers={absolute:/^(?:[a-z]+:)?\/\//i,base64:/^data:[^\/]+\/[^;]+(;charset=[\w]+)?;base64,/,query:/(?:^|&)([^&=]*)=?([^&]*)/g,url:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/};return{parse:function(url){var keys=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","queryString","hash"],i=keys.length,parsed=Object.create({toString:function(){return this.source}}),matches;if(parsed.base64=parsers.base64.test(url),parsed.base64)parsed.source=url;else{for(matches=parsers.url.exec(url);i--;)parsed[keys[i]]=matches[i]||"";parsed.query={},parsed.queryString.replace(parsers.query,function($0,$1,$2){$1&&(parsed.query[$1]=$2)})}return parsed},isAbsolute:function(url){return"object"===_typeof(url)&&url.hasOwnProperty("source")?url.source!==url.relative:"string"==typeof url?parsers.absolute.test(url):void 0},isRelative:function(url){var absolute=this.isAbsolute(url);if("boolean"==typeof absolute)return!absolute},isBase64:function(url){return"object"===_typeof(url)&&url.hasOwnProperty("source")?url.base64:"string"==typeof url?parsers.base64.test(url):void 0},encodeAsXmlAttr:function(uri){return /[<>&']+/.test(uri)?encodeURIComponent(uri):uri},build:function(path,params){var queryString="",url,hasQueryString;return path&&(_.isString(path)&&(url=path),_.isArray(path)&&(url="",_.forEach(path,function(chunk){url+=/\/$/.test(url)&&/^\//.test(chunk)?chunk.substr(1):""===url||/\/$/.test(url)||/^\//.test(chunk)?chunk:"/"+chunk})),_.isPlainObject(params)&&(hasQueryString=-1<url.indexOf("?"),queryString=_.reduce(params,function(acc,value,key){return(!_.isEmpty(acc)||hasQueryString)&&(acc+="&"),"object"!==_typeof(value)||_.isArray(value)?acc+=encodeURIComponent(key)+"="+encodeURIComponent(value):_.forOwn(value,function(parameterValue,parameterName){acc+=encodeURIComponent(key)+"["+encodeURIComponent(parameterName)+"]="+encodeURIComponent(parameterValue)+"&"}),acc},queryString),!_.isEmpty(queryString)&&(!hasQueryString&&(url+="?"),url+=queryString))),url},route:function(action,controller,extension,params,rootUrl){var routeParts=[extension,controller,action];if(_.some(routeParts,function(value){return _.isEmpty(value)||!_.isString(value)}))throw new TypeError("All parts are required to build an URL");return rootUrl=rootUrl||context&&context.root_url,this.build([rootUrl].concat(routeParts),params)}}}),define("core/dataProvider/request",["lodash","core/request"],function(_,coreRequest){'use strict';function request(url,data,method,headers,background,noToken){return coreRequest({url:url,data:data,method:method,headers:headers,background:background,noToken:!1!==noToken}).then(function(response){return _.isUndefined(response)?Promise.resolve():response.success?Promise.resolve(response.data):Promise.reject(response)}).catch(function(error){return Promise.reject(error)})}return _=_&&_.hasOwnProperty("default")?_["default"]:_,coreRequest=coreRequest&&coreRequest.hasOwnProperty("default")?coreRequest["default"]:coreRequest,request}),define("css!ui/component/css/components",[],function(){}),define("ui/component",["jquery","lodash","core/eventifier","handlebars","i18n","lib/dompurify/purify","css!ui/component/css/components.css"],function($$1,_,eventifier,Handlebars,__,DOMPurify){'use strict';function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)?function(obj){return _typeof2(obj)}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":_typeof2(obj)},_typeof(obj)}function Helpers0(hb){hb.registerHelper("__",function(key){return __(key)}),hb.registerHelper("dompurify",function(context){return DOMPurify.sanitize(context)}),hb.registerHelper("join",function(arr,keyValueGlue,fragmentGlue,wrapper){var fragments=[];return keyValueGlue="string"==typeof keyValueGlue?keyValueGlue:void 0,fragmentGlue="string"==typeof fragmentGlue?fragmentGlue:" ",wrapper="string"==typeof wrapper?wrapper:"\"",_.forIn(arr,function(value,key){var fragment="";null!==value||void 0!==value?"boolean"==typeof value?value=value?"true":"false":"object"===_typeof(value)&&(value=_.values(value).join(" ")):value="",void 0!==keyValueGlue&&(fragment+=key+keyValueGlue),fragment+=wrapper+value+wrapper,fragments.push(fragment)}),fragments.join(fragmentGlue)}),hb.registerHelper("for",function(startIndex,stopIndex,increment,options){var ret="";startIndex=parseInt(startIndex),stopIndex=parseInt(stopIndex),increment=parseInt(increment);for(var i=startIndex;i<stopIndex;i+=increment)ret+=options.fn(_.extend({},this,{i:i}));return ret}),hb.registerHelper("equal",function(var1,var2,options){return var1==var2?options.fn(this):options.inverse(this)}),hb.registerHelper("property",function(name,context){return context[name]||""}),hb.registerHelper("includes",function(haystack,needle,options){if(_.contains(haystack,needle))return options.fn(this)})}function defaultTpl(data,options,asString){var html=Template(data,options);return asString||!0?html:$(html)}function delegatedResize(){var width=this.config.width,height=this.config.height,$container=this.getContainer(),$element=this.getElement();$container&&("auto"===width&&(width=$container.width()),"auto"===height&&(height=$container.height())),$element&&(_.isNumber(width)&&$element.css({width:"".concat(width,"px")}),_.isNumber(height)&&$element.css({height:"".concat(height,"px")})),this._width=width,this._height=height}function component(specs,defaults){var componentTpl=defaultTpl,componentState={},componentApi={init:function(config){return this.config=_(config||{}).omit(function(value){return null===value||"undefined"==typeof value}).defaults(defaults||{}).value(),componentState={},this.trigger("init"),this.config.renderTo&&($container=$$1(this.config.renderTo),this.render()),this},destroy:function(){return this.trigger("destroy"),this.$component&&this.$component.remove(),this.$component=null,componentState={},this},render:function(container){return container&&($container=$$1(container)),this.$component=$$1(componentTpl(this.config)),$container&&(this.config.replace&&$container.empty(),$container.append(this.$component)),this.setState("rendered",!0),delegatedResize.call(this),this.trigger("render",this.$component),this},setSize:function(width,height){return this.config.width=width,this.config.height=height,this.is("rendered")&&delegatedResize.call(this),this.trigger("setsize",width,height),this},getSize:function(){if(this.is("rendered"))return{width:this._width||0,height:this._height||0}},getOuterSize:function(includeMargin){var _Mathround=Math.round,$component;if(this.is("rendered"))return $component=this.getElement(),includeMargin=includeMargin||!1,{width:_Mathround($component.outerWidth(includeMargin)),height:_Mathround($component.outerHeight(includeMargin))}},show:function(){return this.trigger("show",this),this.setState("hidden",!1)},hide:function(){return this.trigger("hide",this),this.setState("hidden",!0)},enable:function(){return this.trigger("enable",this),this.setState("disabled",!1)},disable:function(){return this.trigger("disable",this),this.setState("disabled",!0)},is:function(state){return!!componentState[state]},setState:function(state,flag){return flag=!!flag,componentState[state]=flag,this.$component&&this.$component.toggleClass(state,flag),this.trigger("state",state,flag,this),this},getContainer:function(){return $container},getElement:function(){return this.$component},getTemplate:function(){return componentTpl},setTemplate:function(template){var tpl=template||defaultTpl;return componentTpl=tpl,_.isFunction(componentTpl)||(componentTpl=function(){return tpl}),this.trigger("template",componentTpl),this},getConfig:function(){return this.config||defaults||{}}},$container;return specs&&_(specs).functions().forEach(function(method){componentApi[method]=function(){return specs[method].apply(componentApi,_slice.call(arguments))}}),eventifier(componentApi)}$$1=$$1&&$$1.hasOwnProperty("default")?$$1["default"]:$$1,_=_&&_.hasOwnProperty("default")?_["default"]:_,eventifier=eventifier&&eventifier.hasOwnProperty("default")?eventifier["default"]:eventifier,Handlebars=Handlebars&&Handlebars.hasOwnProperty("default")?Handlebars["default"]:Handlebars,__=__&&__.hasOwnProperty("default")?__["default"]:__,DOMPurify=DOMPurify&&DOMPurify.hasOwnProperty("default")?DOMPurify["default"]:DOMPurify,Helpers0.__initialized||(Helpers0(Handlebars),Helpers0.__initialized=!0);var Template=Handlebars.template(function(Handlebars,depth0,helpers){return this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),"<div class=\"component\"></div>"}),_slice=[].slice;return component}),define("util/namespace",["lodash"],function(_){'use strict';_=_&&_.hasOwnProperty("default")?_["default"]:_;var reSplit=/\s/g,namespaceSep=".",namespaceHelper={split:function(names,normalize){return!_.isString(names)||_.isEmpty(names)?[]:(normalize&&(names=names.toLowerCase()),_(names.trim().split(reSplit)).compact().uniq().value())},getName:function(namespaced){return!_.isString(namespaced)||_.isEmpty(namespaced)?"":-1<namespaced.indexOf(namespaceSep)?namespaced.substr(0,namespaced.indexOf(namespaceSep)):namespaced},getNamespace:function(namespaced,defaultNs){return!_.isString(namespaced)||_.isEmpty(namespaced)?"":-1<namespaced.indexOf(namespaceSep)?namespaced.substr(namespaced.indexOf(namespaceSep)+1):defaultNs||"@"},namespaceAll:function(names,namespace,normalize){var suffix;return _.isArray(names)||(names=namespaceHelper.split(names,normalize)),normalize&&(namespace=namespace.toLowerCase()),suffix=namespace?namespaceSep+namespace:"",_(names).map(function(sh){return 0>sh.indexOf(namespaceSep)?sh+suffix:sh}).compact().uniq().value().join(" ")}};return namespaceHelper}),define("util/shortcut/registry",["jquery","lodash","util/namespace"],function($,_,namespaceHelper){'use strict';var _StringfromCharCode=String.fromCharCode;function registerEvent(target,eventName,listener){target.addEventListener?target.addEventListener(eventName,listener,!1):target.attachEvent?target.attachEvent("on"+eventName,listener):target["on"+eventName]=listener}function unregisterEvent(target,eventName,listener){target.removeEventListener?target.removeEventListener(eventName,listener,!1):target.detachEvent?target.detachEvent("on"+eventName,listener):target["on"+eventName]=null}function getActualKey(event){var code=event.which||event.keyCode,character=32<=code?_StringfromCharCode(code).toLowerCase():"",key=event.key&&event.key.toLowerCase(),keyName=event.code&&event.code.toLowerCase();return keyName&&(0===keyName.indexOf("key")?("a">key||"z"<key)&&"a"<=character&&"z">=character&&(key=character):0===keyName.indexOf("digit")&&(key=keyName.substr(5))),specialKeys[code]||key||character}function getActualButton(event){var buttons={clickLeft:!1,clickRight:!1,clickMiddle:!1,clickBack:!1,clickForward:!1};if(event.buttons)buttons.clickLeft=!!(1&event.buttons),buttons.clickRight=!!(2&event.buttons),buttons.clickMiddle=!!(4&event.buttons),buttons.clickBack=!!(8&event.buttons),buttons.clickForward=!!(16&event.buttons);else switch(event.button){case 0:buttons.clickLeft=!0;break;case 1:buttons.clickMiddle=!0;break;case 2:buttons.clickRight=!0;break;case 3:buttons.clickBack=!0;break;case 4:buttons.clickForward=!0;}return buttons}function getActualScroll(event){return{scrollUp:0>event.deltaY,scrollDown:0<event.deltaY}}function normalizeCommand(descriptor){var key=translateKeys[descriptor.key]||descriptor.key,parts=[];return descriptor.ctrlKey&&parts.push("control"),descriptor.altKey&&parts.push("alt"),descriptor.shiftKey&&parts.push("shift"),descriptor.metaKey&&parts.push("meta"),descriptor.scrollDown&&parts.push("scrollDown"),descriptor.scrollUp&&parts.push("scrollUp"),descriptor.clickLeft&&parts.push("clickLeft"),descriptor.clickRight&&parts.push("clickRight"),descriptor.clickMiddle&&parts.push("clickMiddle"),descriptor.clickBack&&parts.push("clickBack"),descriptor.clickForward&&parts.push("clickForward"),key&&0>parts.indexOf(key)&&parts.push(key),parts.join("+")}function parseCommand(shortcut){var parts=namespaceHelper.getName(shortcut).split("+"),descriptor={keyboardInvolved:!1,mouseClickInvolved:!1,mouseWheelInvolved:!1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,key:null,scrollUp:null,scrollDown:null,clickLeft:null,clickRight:null,clickMiddle:null,clickBack:null,clickForward:null};return _.forEach(parts,function(part){if(modifiers[part])descriptor[modifiers[part]]=!0;else if(0<=part.indexOf("mouse")){if(descriptor.keyboardInvolved)throw new Error("A shortcut cannot involve both mouse and regular keys!");0<=part.indexOf("scroll")&&(descriptor.mouseWheelInvolved=!0,descriptor.scrollUp=0<=part.indexOf("up"),descriptor.scrollDown=0<=part.indexOf("down")),0<=part.indexOf("click")&&(descriptor.mouseClickInvolved=!0,descriptor.clickLeft=0<=part.indexOf("left"),descriptor.clickRight=0<=part.indexOf("right"),descriptor.clickMiddle=0<=part.indexOf("middle"),descriptor.clickBack=0<=part.indexOf("back"),descriptor.clickForward=0<=part.indexOf("forward"))}else{if(descriptor.mouseClickInvolved||descriptor.mouseWheelInvolved)throw new Error("A shortcut cannot involve both mouse and regular keys!");descriptor.keyboardInvolved=!0,descriptor.key=part}}),descriptor}$=$&&$.hasOwnProperty("default")?$["default"]:$,_=_&&_.hasOwnProperty("default")?_["default"]:_,namespaceHelper=namespaceHelper&&namespaceHelper.hasOwnProperty("default")?namespaceHelper["default"]:namespaceHelper;var modifiers={ctrl:"ctrlKey",alt:"altKey",option:"altKey",shift:"shiftKey",meta:"metaKey",cmd:"metaKey",win:"metaKey"},translateKeys={escape:"esc",arrowdown:"down",arrowleft:"left",arrowright:"right",arrowup:"up"},specialKeys={8:"backspace",9:"tab",13:"enter",19:"pause",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"delete",91:"meta",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",145:"scrolllock",144:"numlock"};return function(root,defaultOptions){function getHandlers(command,namespace){return handlers[namespace]=handlers[namespace]||{},handlers[namespace][command]=handlers[namespace][command]||[],handlers[namespace][command]}function getCommandHandlers(command){return _.reduce(handlers,function(acc,nsHandlers){return nsHandlers[command]&&(acc=acc.concat(nsHandlers[command])),acc},[])}function clearHandlers(command,namespace){namespace&&!command?handlers[namespace]={}:_.forEach(handlers,function(nsHandlers,ns){nsHandlers[command]&&("*"===namespace||namespace===ns)&&(nsHandlers[command]=[])})}function setOptions(descriptor,options){descriptor.options=_.defaults(_.merge(descriptor.options||{},options),defaultOptions)}function registerKeyboard(){keyboardIsRegistered||(registerEvent(root,"keydown",onKeyboard),keyboardIsRegistered=!0),keyboardCount++}function unregisterKeyboard(){keyboardCount--,0>=keyboardCount&&(keyboardCount=0,keyboardIsRegistered&&(unregisterEvent(root,"keydown",onKeyboard),keyboardIsRegistered=!1))}function registerMouseClick(){mouseClickIsRegistered||(registerEvent(root,"click",onMouseClick),mouseClickIsRegistered=!0),mouseClickCount++}function unregisterMouseClick(){mouseClickCount--,0>=mouseClickCount&&(mouseClickCount=0,mouseClickIsRegistered&&(unregisterEvent(root,"click",onMouseClick),mouseClickIsRegistered=!1))}function registerMouseWheel(){mouseWheelIsRegistered||(registerEvent(root,"wheel",onMouseWheel),mouseWheelIsRegistered=!0),mouseWheelCount++}function unregisterMouseWheel(){mouseWheelCount--,0>=mouseWheelCount&&(mouseWheelCount=0,mouseWheelIsRegistered&&(unregisterEvent(root,"wheel",onMouseWheel),mouseWheelIsRegistered=!1))}function registerCommand(command,descriptor){shortcuts[command]=descriptor,descriptor.keyboardInvolved&&registerKeyboard(),descriptor.mouseClickInvolved&&registerMouseClick(),descriptor.mouseWheelInvolved&&registerMouseWheel()}function unregisterCommand(command){var descriptor=shortcuts[command];shortcuts[command]=null,descriptor&&(descriptor.keyboardInvolved&&unregisterKeyboard(),descriptor.mouseClickInvolved&&unregisterMouseClick(),descriptor.mouseWheelInvolved&&unregisterMouseWheel())}function onKeyboard(event){processShortcut(event,{keyboardInvolved:!0,ctrlKey:event.ctrlKey,altKey:event.altKey,shiftKey:event.shiftKey,metaKey:event.metaKey,key:getActualKey(event)})}function onMouseClick(event){processShortcut(event,_.merge({mouseClickInvolved:!0,ctrlKey:event.ctrlKey,altKey:event.altKey,shiftKey:event.shiftKey,metaKey:event.metaKey},getActualButton(event)))}function onMouseWheel(event){processShortcut(event,_.merge({mouseClickInvolved:!0,ctrlKey:event.ctrlKey,altKey:event.altKey,shiftKey:event.shiftKey,metaKey:event.metaKey},getActualScroll(event)))}function processShortcut(event,descriptor){var command=normalizeCommand(descriptor),shortcut=shortcuts[command],shortcutHandlers,$target;if(shortcut&&!states.disabled){if(!0===shortcut.options.avoidInput&&($target=$(event.target),$target.closest("[type=\"text\"],textarea").length&&(!shortcut.options.allowIn||!$target.closest(shortcut.options.allowIn).length)))return;!1===shortcut.options.propagate&&event.stopPropagation(),!0===shortcut.options.prevent&&event.preventDefault(),shortcutHandlers=getCommandHandlers(command),shortcutHandlers&&_.forEach(shortcutHandlers,function(handler){handler(event,command)})}}var keyboardIsRegistered=!1,mouseClickIsRegistered=!1,mouseWheelIsRegistered=!1,keyboardCount=0,mouseClickCount=0,mouseWheelCount=0,shortcuts={},handlers={},states={};return root.jquery&&(root=root.get(0)),{set:function(shortcut,options){return _.forEach(namespaceHelper.split(shortcut,!0),function(normalized){var descriptor=parseCommand(normalized),command=normalizeCommand(descriptor);setOptions(descriptor,options),registerCommand(command,descriptor)}),this},add:function(shortcut,handler,options){return _.isFunction(handler)&&_.forEach(namespaceHelper.split(shortcut,!0),function(normalized){var namespace=namespaceHelper.getNamespace(normalized,"*"),descriptor=parseCommand(normalized),command=normalizeCommand(descriptor);setOptions(descriptor,options),registerCommand(command,descriptor),getHandlers(command,namespace).push(handler)}),this},remove:function(shortcut){return _.forEach(namespaceHelper.split(shortcut,!0),function(normalized){var namespace=namespaceHelper.getNamespace(normalized,"*"),descriptor=parseCommand(normalized),command=normalizeCommand(descriptor);clearHandlers(command,namespace),getCommandHandlers(command).length||unregisterCommand(command)}),this},exists:function(shortcut){var normalized=(shortcut+"").trim().toLowerCase(),namespace=namespaceHelper.getNamespace(normalized,"*"),descriptor=parseCommand(normalized),command=normalizeCommand(descriptor),shortcutExists=!1;return shortcuts[command]?shortcutExists="*"===namespace||!!getHandlers(command,namespace).length:!command&&(shortcutExists=!_.isEmpty(handlers[namespace])),shortcutExists},clear:function(){return shortcuts={},handlers={},keyboardCount=0,mouseClickCount=0,mouseWheelCount=0,unregisterKeyboard(),unregisterMouseClick(),unregisterMouseWheel(),this},getState:function(name){return!!states[name]},setState:function(name,state){return states[name]=!!state,this},enable:function(){return this.setState("disabled",!1),this},disable:function(){return this.setState("disabled",!0),this}}}}),define("ui/keyNavigation/navigator",["jquery","lodash","core/eventifier","util/shortcut/registry"],function($,_,eventifier,shortcutRegistry){'use strict';$=$&&$.hasOwnProperty("default")?$["default"]:$,_=_&&_.hasOwnProperty("default")?_["default"]:_,eventifier=eventifier&&eventifier.hasOwnProperty("default")?eventifier["default"]:eventifier,shortcutRegistry=shortcutRegistry&&shortcutRegistry.hasOwnProperty("default")?shortcutRegistry["default"]:shortcutRegistry;var _navigationGroups={},_ns=".ui-key-navigator",_defaults={defaultPosition:0,keepState:!1,replace:!1,loop:!1,propagateTab:!0},isNavigableElement=function(navElement){return navElement&&_.isFunction(navElement.init)&&_.isFunction(navElement.destroy)&&_.isFunction(navElement.getElement)&&_.isFunction(navElement.isVisible)&&_.isFunction(navElement.isEnabled)&&_.isFunction(navElement.focus)},keyNavigatorFactory=function(config){var _cursor={position:-1,navigable:null},getCurrentCursor=function(){var isFocused=!1;return document.activeElement&&_.forEach(navigables,function(navigable,index){if(navigable.isVisible()&&navigable.isEnabled()&&(document.activeElement===navigable.getElement().get(0)||(!$(document.activeElement).hasClass("key-navigation-highlight")||$(document.activeElement).data("key-navigatior-id")!==id)&&$.contains(navigable.getElement().get(0),document.activeElement)))return _cursor.position=index,_cursor.navigable=navigable,isFocused=!0,!1}),isFocused?_cursor:null},getClosestPositionRight=function(fromPosition){var pos;for(pos=fromPosition;pos<navigables.length;pos++)if(navigables[pos]&&navigables[pos].isVisible()&&navigables[pos].isEnabled())return pos;return-1},getClosestPositionLeft=function(fromPosition){var pos;for(pos=fromPosition;0<=pos;pos--)if(navigables[pos]&&navigables[pos].isVisible()&&navigables[pos].isEnabled())return pos;return-1},id,navigables,keyNavigator,$group;if(config=_.defaults(config||{},_defaults),id=config.id||_.uniqueId("navigator_"),navigables=config.elements||[],_navigationGroups[id])if(config.replace)_navigationGroups[id].destroy();else throw new TypeError("the navigation group id is already in use : "+id);if(_.each(navigables,function(navigable){navigable.init(),navigable.getElement().data("key-navigatior-id",id)}),config.group)if($group=$(config.group),$group.length)$group.addClass("key-navigation-group").attr("data-navigation-id",id);else throw new TypeError("group element does not exist");return keyNavigator=eventifier({getId:function(){return id},getGroup:function(){return $group},isFocused:function(){return!!getCurrentCursor()},next:function(){var cursor=getCurrentCursor(),pos;return cursor?(pos=getClosestPositionRight(cursor.position+1),0<=pos?this.focusPosition(pos):config.loop?this.focusPosition(getClosestPositionRight(0)):this.trigger("upperbound"),this.trigger("next",getCurrentCursor())):this.focusPosition(getClosestPositionRight(0)),this},previous:function(){var cursor=getCurrentCursor(),pos;return cursor?(pos=getClosestPositionLeft(cursor.position-1),0<=pos?this.focusPosition(pos):config.loop?this.focusPosition(getClosestPositionLeft(navigables.length-1)):this.trigger("lowerbound"),this.trigger("previous",getCurrentCursor())):this.focusPosition(getClosestPositionRight(0)),this},activate:function(target){var cursor=getCurrentCursor();return cursor&&this.trigger("activate",cursor,target),this},goto:function(groupId){return _navigationGroups[groupId]?_navigationGroups[groupId].focus():this.trigger("error",new Error("goto an unknown navigation group")),this},focus:function(originNavigator){var pos;return config.keepState&&_cursor&&0<=_cursor.position?pos=_cursor.position:_.isFunction(config.defaultPosition)?(pos=config.defaultPosition(navigables),0>pos&&(pos=0)):pos=config.defaultPosition,this.focusPosition(getClosestPositionRight(pos),originNavigator),this},focusPosition:function(position,originNavigator){return navigables[position]&&(_cursor.navigable&&this.trigger("blur",this.getCursor(),originNavigator),_cursor.position=position,navigables[_cursor.position].focus(),_cursor.navigable=navigables[_cursor.position],this.trigger("focus",this.getCursor(),originNavigator)),this},first:function(){return this.focusPosition(getClosestPositionRight(0)),this},last:function(){return this.focusPosition(getClosestPositionLeft(navigables.length-1)),this},destroy:function(){return _.each(navigables,function(navigable){navigable.getElement().off(_ns),navigable.destroy(),navigable.shortcuts&&navigable.shortcuts.clear()}),delete _navigationGroups[id],this},blur:function(){var cursor=this.getCursor();return cursor&&cursor.navigable&&cursor.navigable.getElement().blur(),this},getCursor:function(){return _.clone(_cursor)},getNavigables:function(){return _.clone(navigables)}}),_.each(navigables,function(navigable){if(!isNavigableElement(navigable))throw new TypeError("not a valid navigable element");navigable.shortcuts=shortcutRegistry(navigable.getElement()).add("tab shift+tab",function(e,key){keyNavigator.trigger(key,e.target)},{propagate:!!config.propagateTab,prevent:!0}).add("enter",function(e){$(e.target).is(":text,textarea")||(e.preventDefault(),keyNavigator.activate(e.target))},{propagate:!1}).add("up down left right",function(e,key){var $target=$(e.target);$target.is(":text,textarea")||(!$target.is("img")&&!$target.hasClass("key-navigation-scrollable")&&e.preventDefault(),keyNavigator.trigger(key,e.target))},{propagate:!1}),navigable.getElement().on("keyup"+_ns,function(e){var keyCode=e.keyCode?e.keyCode:e.charCode;32===keyCode&&(e.target!==this&&$(e.target).is(":input")?e.stopPropagation():(e.preventDefault(),keyNavigator.activate(e.target)))}).on("blur"+_ns,function(){var cursor=keyNavigator.getCursor();cursor&&cursor.navigable&&keyNavigator.trigger("blur",cursor)})}),_navigationGroups[id]=keyNavigator,keyNavigator};return keyNavigatorFactory.get=function(id){if(_navigationGroups[id])return _navigationGroups[id]},keyNavigatorFactory}),define("ui/keyNavigation/navigableDomElement",["jquery","core/eventifier"],function($,eventifier){'use strict';$=$&&$.hasOwnProperty("default")?$["default"]:$,eventifier=eventifier&&eventifier.hasOwnProperty("default")?eventifier["default"]:eventifier;var navigableDomElement=function($element){return $element=$($element),eventifier({init:function(){if(!$element.length)throw new TypeError("dom element does not exist");return $element.attr("tabindex",-1),$element.addClass("key-navigation-highlight"),this},destroy:function(){return $element.removeClass("key-navigation-highlight"),this},getElement:function(){return $element},isVisible:function(){return $element.is(":visible")},isEnabled:function(){return!$element.is(":disabled")},focus:function(){return $element.focus(),this}})};return navigableDomElement.createFromDoms=function($elements){var list=[];return $elements.each(function(){list.push(navigableDomElement($(this)))}),list},navigableDomElement}),define("ui/dialog",["jquery","lodash","i18n","handlebars","lib/dompurify/purify","ui/keyNavigation/navigator","ui/keyNavigation/navigableDomElement","util/shortcut/registry","ui/modal"],function($$1,_,__,Handlebars,DOMPurify,keyNavigator,navigableDomElement,shortcutRegistry){'use strict';function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)?function(obj){return _typeof2(obj)}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":_typeof2(obj)},_typeof(obj)}function Helpers0(hb){hb.registerHelper("__",function(key){return __(key)}),hb.registerHelper("dompurify",function(context){return DOMPurify.sanitize(context)}),hb.registerHelper("join",function(arr,keyValueGlue,fragmentGlue,wrapper){var fragments=[];return keyValueGlue="string"==typeof keyValueGlue?keyValueGlue:void 0,fragmentGlue="string"==typeof fragmentGlue?fragmentGlue:" ",wrapper="string"==typeof wrapper?wrapper:"\"",_.forIn(arr,function(value,key){var fragment="";null!==value||void 0!==value?"boolean"==typeof value?value=value?"true":"false":"object"===_typeof(value)&&(value=_.values(value).join(" ")):value="",void 0!==keyValueGlue&&(fragment+=key+keyValueGlue),fragment+=wrapper+value+wrapper,fragments.push(fragment)}),fragments.join(fragmentGlue)}),hb.registerHelper("for",function(startIndex,stopIndex,increment,options){var ret="";startIndex=parseInt(startIndex),stopIndex=parseInt(stopIndex),increment=parseInt(increment);for(var i=startIndex;i<stopIndex;i+=increment)ret+=options.fn(_.extend({},this,{i:i}));return ret}),hb.registerHelper("equal",function(var1,var2,options){return var1==var2?options.fn(this):options.inverse(this)}),hb.registerHelper("property",function(name,context){return context[name]||""}),hb.registerHelper("includes",function(haystack,needle,options){if(_.contains(haystack,needle))return options.fn(this)})}function bodyTpl(data,options,asString){var html=Template(data,options);return asString||!0?html:$(html)}function buttonsTpl(data,options,asString){var html=Template$1(data,options);return asString||!0?html:$(html)}$$1=$$1&&$$1.hasOwnProperty("default")?$$1["default"]:$$1,_=_&&_.hasOwnProperty("default")?_["default"]:_,__=__&&__.hasOwnProperty("default")?__["default"]:__,Handlebars=Handlebars&&Handlebars.hasOwnProperty("default")?Handlebars["default"]:Handlebars,DOMPurify=DOMPurify&&DOMPurify.hasOwnProperty("default")?DOMPurify["default"]:DOMPurify,keyNavigator=keyNavigator&&keyNavigator.hasOwnProperty("default")?keyNavigator["default"]:keyNavigator,navigableDomElement=navigableDomElement&&navigableDomElement.hasOwnProperty("default")?navigableDomElement["default"]:navigableDomElement,shortcutRegistry=shortcutRegistry&&shortcutRegistry.hasOwnProperty("default")?shortcutRegistry["default"]:shortcutRegistry,Helpers0.__initialized||(Helpers0(Handlebars),Helpers0.__initialized=!0);var Template=Handlebars.template(function(Handlebars,depth0,helpers,partials,data){function program1(depth0,data){var buffer="",stack1,helper;return buffer+="\n        <h4 class=\"strong\">",(helper=helpers.heading)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.heading,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"</h4>\n        ",buffer}function program3(depth0,data){var buffer="",stack1,helper;return buffer+="\n        <div class=\"content\">",(helper=helpers.content)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.content,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),(stack1||0===stack1)&&(buffer+=stack1),buffer+="</div>\n        ",buffer}this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var buffer="",escapeExpression=this.escapeExpression,self=this,stack1,helper;return buffer+="<div class=\"preview-modal-feedback modal ",(helper=helpers["class"])?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0["class"],stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"\">\n    <div class=\"modal-body clearfix\">\n        ",stack1=helpers["if"].call(depth0,depth0&&depth0.heading,{hash:{},inverse:self.noop,fn:self.program(1,program1,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n\n        <p class=\"message\">",(helper=helpers.message)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.message,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),(stack1||0===stack1)&&(buffer+=stack1),buffer+="</p>\n\n        ",stack1=helpers["if"].call(depth0,depth0&&depth0.content,{hash:{},inverse:self.noop,fn:self.program(3,program3,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n\n        <div class=\"buttons rgt\"></div>\n    </div>\n</div>\n",buffer});Helpers0.__initialized||(Helpers0(Handlebars),Helpers0.__initialized=!0);var Template$1=Handlebars.template(function(Handlebars,depth0,helpers,partials,data){function program1(depth0,data){var buffer="",stack1,helper;return buffer+="\n    <button class=\"btn-",(helper=helpers.type)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.type,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+" small ",(helper=helpers.id)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.id,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"\" data-control=\"",(helper=helpers.id)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.id,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"\" type=\"button\">\n        ",stack1=helpers["if"].call(depth0,depth0&&depth0.icon,{hash:{},inverse:self.noop,fn:self.program(2,program2,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n        <span class=\"label\">",(helper=helpers.label)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.label,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"</span>\n    </button>\n",buffer}function program2(depth0,data){var buffer="",stack1,helper;return buffer+="<span class=\"icon-",(helper=helpers.icon)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.icon,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"\"></span> ",buffer}this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var buffer="",escapeExpression=this.escapeExpression,self=this,stack1;return stack1=helpers.each.call(depth0,depth0&&depth0.buttons,{hash:{},inverse:self.noop,fn:self.program(1,program1,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n",buffer}),_scope=".modal",_definedButtons={ok:{id:"ok",type:"info",label:__("Ok"),close:!0},cancel:{id:"cancel",type:"regular",label:__("Cancel"),close:!0},yes:{id:"yes",type:"info",label:__("Yes"),close:!0},no:{id:"no",type:"regular",label:__("No"),close:!0}},_defaults={message:"",content:"",width:500,animate:!1,autoRender:!1,autoDestroy:!1,renderTo:"body",buttons:"cancel,ok"},dialog={init:function(options){var self=this,events={},initOptions=_.omit(options||{},function(value,key){var omit=!1;return 2<key.length&&"on"===key.substr(0,2)&&(events[key.substr(2)]=value,omit=!0),omit});return _.defaults(this,initOptions,_defaults),this.$html=$$1(bodyTpl(this)),this.$buttons=this.$html.find(".buttons"),this.rendered=!1,this.destroyed=!1,this.$buttons.on("click"+_scope,"button",this._onButtonClick.bind(this)),this.setButtons(this.buttons),_.forEach(events,function(callback,eventName){0>eventName.indexOf(".")&&(eventName+=_scope),self.on(eventName.toLowerCase(),callback)}),this.autoRender&&this.render(),this},destroy:function(){return this.destroyed||(this._destroy(),this.rendered=!1,this.destroyed=!0,this.trigger("destroy"+_scope),this.$buttons.off(_scope),this.$html.off(_scope).remove(),this.$html=null,this.$buttons=null),this},setButtons:function(buttons){var self=this;return this.destroyed||(!buttons&&(buttons=_defaults.buttons),!_.isArray(buttons)&&_.isString(buttons)&&(buttons=buttons.split(",")),this.buttons={},_.forEach(buttons,function(btn){_.isString(btn)&&(btn=btn.trim(),btn=_definedButtons[btn]||{id:btn,type:"info",label:btn}),btn.type||(btn.type="regular"),self.buttons[btn.id]=btn}),this.$buttons.html(buttonsTpl(this))),this},render:function(to){return this.destroyed||($$1(to||this.renderTo).append(this.$html),this._install(),this.rendered=!0),this},show:function(){return this.destroyed||(this.rendered?this._open():this.render()),this},hide:function(){return!this.destroyed&&this.rendered&&(this._close(),this.autoDestroy&&this.destroy()),this},on:function(){var dom=this.$html;return dom&&dom.on.apply(dom,arguments),this},off:function(){var dom=this.$html;return dom&&dom.off.apply(dom,arguments),this},trigger:function(eventName,extraParameters){var dom=this.$html;return dom&&(void 0===extraParameters&&(extraParameters=[]),!_.isArray(extraParameters)&&(extraParameters=[extraParameters]),extraParameters=Array.prototype.slice.call(extraParameters),extraParameters.push(this),dom.trigger(eventName,extraParameters)),this},getDom:function(){return this.$html},_onButtonClick:function(event){var $btn=$$1(event.target).closest("button"),id=$btn.data("control"),btn=this.buttons[id];btn&&this._execute(btn)},_execute:function(btn){btn.action&&btn.action.apply(this,[btn,this]),this.trigger(btn.id+"btn"+_scope,[btn]),btn.close&&this.hide()},focus:function(button){var focusPosition=-1;button&&(focusPosition=_.findIndex(this.navigator.getNavigables(),function(navigable){return navigable.getElement().is("[data-control=\""+button+"\"]")})),0<=focusPosition?this.navigator.focusPosition(focusPosition):this.navigator.focus()},_install:function(){var self=this,$buttons,closeButton;this.destroyed||(this.$html.modal({width:this.width,animate:this.animate,disableClosing:this.disableClosing,disableEscape:this.disableEscape}).on("closed"+_scope,function(){self.autoDestroy&&self.destroy()}),$buttons=this.$buttons.find("button"),closeButton=$$1(_scope).find("#modal-close-btn")[0],closeButton&&$buttons.push(closeButton),this.navigator=keyNavigator({elements:navigableDomElement.createFromDoms($buttons)}).on("right down",function(){this.next()}).on("left up",function(){this.previous()}).on("tab",function(){this.getCursor().position===$buttons.length-1?this.first():this.next()}).on("shift+tab",function(){0===this.getCursor().position?this.last():this.previous()}).on("activate",function(cursor){cursor.navigable.getElement().click()}),self.navigator.last(),this.globalShortcut=shortcutRegistry($$1("body")).add("tab shift+tab",function(){self.navigator.isFocused()||self.navigator.focus()}),self.trigger("create.dialog"))},_open:function(){this.$html.modal("open")},_close:function(){this.$html.modal("close")},_destroy:function(){this.$html.modal("destroy"),this.navigator&&this.navigator.destroy(),this.globalShortcut&&this.globalShortcut.clear()}},dialogFactory=function(options){var instance=_.clone(dialog,!0);return instance.init(options),instance};return dialogFactory}),define("ui/dialog/confirm",["lodash","i18n","ui/dialog"],function(_,__,dialog){'use strict';function dialogConfirm(message,accept,refuse,options){var accepted=!1,_options={buttons:{labels:{ok:__("Ok"),cancel:__("Cancel")}}},dialogOptions,dlg;return options=_.defaults(options||{},_options),dialogOptions={message:message,autoRender:!0,autoDestroy:!0,onOkBtn:function(){accepted=!0,_.isFunction(accept)&&accept.call(this)},buttons:{ok:{id:"ok",type:"info",label:options.buttons.labels.ok||__("Ok"),close:!0},cancel:{id:"cancel",type:"regular",label:options.buttons.labels.cancel||__("Cancel"),close:!0}}},dlg=dialog(dialogOptions),_.isFunction(refuse)&&dlg.on("closed.modal",function(){accepted||refuse.call(this)}),dlg}return _=_&&_.hasOwnProperty("default")?_["default"]:_,__=__&&__.hasOwnProperty("default")?__["default"]:__,dialog=dialog&&dialog.hasOwnProperty("default")?dialog["default"]:dialog,dialogConfirm}),define("ui/hider",["jquery","core/eventifier"],function($){'use strict';function jqWrap(element){return element instanceof $?element:$(element)}$=$&&$.hasOwnProperty("default")?$["default"]:$;return{show:function(element){return jqWrap(element).removeClass("hidden")},hide:function(element){return jqWrap(element).addClass("hidden")},toggle:function(element,state){return"undefined"!=typeof state&&(state=!state),jqWrap(element).toggleClass("hidden",state)},isHidden:function(element,real){var $elt=jqWrap(element);return real?$elt.hasClass("hidden")||"none"===$elt.css("display")||"hidden"===$elt.css("visibility"):$elt.hasClass("hidden")}}}),define("css!ui/class/css/selector",[],function(){}),define("ui/class/selector",["jquery","lodash","i18n","ui/component","handlebars","lib/dompurify/purify","css!ui/class/css/selector.css"],function($$1,_,__,component,Handlebars,DOMPurify){'use strict';function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)?function(obj){return _typeof2(obj)}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":_typeof2(obj)},_typeof(obj)}function Helpers0(hb){hb.registerHelper("__",function(key){return __(key)}),hb.registerHelper("dompurify",function(context){return DOMPurify.sanitize(context)}),hb.registerHelper("join",function(arr,keyValueGlue,fragmentGlue,wrapper){var fragments=[];return keyValueGlue="string"==typeof keyValueGlue?keyValueGlue:void 0,fragmentGlue="string"==typeof fragmentGlue?fragmentGlue:" ",wrapper="string"==typeof wrapper?wrapper:"\"",_.forIn(arr,function(value,key){var fragment="";null!==value||void 0!==value?"boolean"==typeof value?value=value?"true":"false":"object"===_typeof(value)&&(value=_.values(value).join(" ")):value="",void 0!==keyValueGlue&&(fragment+=key+keyValueGlue),fragment+=wrapper+value+wrapper,fragments.push(fragment)}),fragments.join(fragmentGlue)}),hb.registerHelper("for",function(startIndex,stopIndex,increment,options){var ret="";startIndex=parseInt(startIndex),stopIndex=parseInt(stopIndex),increment=parseInt(increment);for(var i=startIndex;i<stopIndex;i+=increment)ret+=options.fn(_.extend({},this,{i:i}));return ret}),hb.registerHelper("equal",function(var1,var2,options){return var1==var2?options.fn(this):options.inverse(this)}),hb.registerHelper("property",function(name,context){return context[name]||""}),hb.registerHelper("includes",function(haystack,needle,options){if(_.contains(haystack,needle))return options.fn(this)})}function selectorTpl(data,options,asString){var html=Template(data,options);return asString||!0?html:$(html)}function listItemTpl(data,options,asString){var html=Template$1(data,options);return asString||!0?html:$(html)}function classesSelectorFactory($container,config){var classList={},buildTree=function(classes){var nodeToListItem=function nodeToListItem(acc,node){var item;return node.uri&&node.label&&(item=_.clone(node),classList[item.uri]=item,node.children&&node.children.length&&(item.childList=_.reduce(node.children,nodeToListItem,"")),acc+=listItemTpl(item)),acc};return _.reduce(classes,nodeToListItem,"")},classSelector=component({setValue:function(uri){return this.config.classUri===uri||_.isUndefined(classList[uri])||(this.config.classUri=uri,this.is("rendered")&&$selected.length&&($selected.text(classList[uri].label).attr({title:classList[uri].label,"data-uri":uri}).data("uri",uri).removeClass("empty"),this.trigger("change",uri,classList[uri]))),this},getValue:function(){return this.config.classUri},getClassNode:function(){var node=null;return this.config.classUri&&classList[this.config.classUri]&&(node=classList[this.config.classUri]),node},empty:function(){return this.is("rendered")&&$selected.length&&this.config.classUri&&(this.config=_.omit(this.config,"classUri"),$selected.text(this.config.placeholder).removeAttr("title").data("uri",null).removeAttr("data-uri").addClass("empty"),this.trigger("change")),this},hasNode:function(node){var uri;return!!(node&&classList)&&(uri=_.isString(node)?node:node.uri,_.has(classList,uri))},removeNode:function(node){var uri;return!!this.hasNode(node)&&(uri=_.isString(node)?node:node.uri,uri===this.config.classUri&&this.empty(),classList=_.omit(classList,uri),this.is("rendered")&&$$1("[data-uri=\""+uri+"\"]",this.getElement()).parent("li").remove(),!this.hasNode(node))},addNode:function(node,parentUri){var subTree,$parentNode;return this.is("rendered")&&node&&!this.hasNode(node)&&(subTree=buildTree([node]),parentUri&&($parentNode=$$1("[data-uri=\""+parentUri+"\"]",$options)),(!$parentNode||!$parentNode.length)&&($parentNode=$$1("[data-uri]:first-child",$options)),$parentNode.parent("li").children("ul").length?$parentNode.parent("li").children("ul").append(subTree):$parentNode.parent("li").append("<ul>"+subTree+"</ul>")),this},updateNode:function(node){return node&&node.uri&&this.hasNode(node)&&classList[node.uri].label!==node.label&&(classList[node.uri].label=node.label,this.is("rendered")&&$$1("[data-uri=\""+node.uri+"\"]",this.getElement()).attr("title",node.label).text(node.label)),this},updateNodes:function(nodes){var self=this;return _.forEach(nodes,function(node){node.children&&self.updateNodes(node.children),self.updateNode(node)}),this}},defaultConfig).setTemplate(selectorTpl).on("init",function(){this.config.tree=buildTree(this.config.classes),this.config.classUri&&classList[this.config.classUri]&&(this.config.label=classList[this.config.classUri].label),this.render($container)}).on("render",function(){var self=this,$component=this.getElement();$selected=$$1(".selected",$component),$options=$$1(".options",$component),$selected.on("click",function(e){e.preventDefault(),$options.toggleClass("folded")}),$options.on("click","a",function(e){e.preventDefault(),self.setValue($$1(this).data("uri")),$options.toggleClass("folded")})}).on("destroy",function(){classList={}}),$selected,$options;return _.defer(function(){classSelector.init(config)}),classSelector}$$1=$$1&&$$1.hasOwnProperty("default")?$$1["default"]:$$1,_=_&&_.hasOwnProperty("default")?_["default"]:_,__=__&&__.hasOwnProperty("default")?__["default"]:__,component=component&&component.hasOwnProperty("default")?component["default"]:component,Handlebars=Handlebars&&Handlebars.hasOwnProperty("default")?Handlebars["default"]:Handlebars,DOMPurify=DOMPurify&&DOMPurify.hasOwnProperty("default")?DOMPurify["default"]:DOMPurify,Helpers0.__initialized||(Helpers0(Handlebars),Helpers0.__initialized=!0);var Template=Handlebars.template(function(Handlebars,depth0,helpers,partials,data){function program1(depth0,data){var buffer="",stack1,helper;return buffer+="\n    <a href=\"#\" class=\"selected truncate\" data-uri=\"",(helper=helpers.classUri)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.classUri,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"\" title=\"",(helper=helpers.label)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.label,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"\">",(helper=helpers.label)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.label,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"</a>\n    ",buffer}function program3(depth0,data){var buffer="",stack1,helper;return buffer+="\n    <a href=\"#\" class=\"selected truncate empty\">",(helper=helpers.placeholder)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.placeholder,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"</a>\n    ",buffer}this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var buffer="",escapeExpression=this.escapeExpression,self=this,stack1,helper;return buffer+="<div class=\"class-selector\">\n    ",stack1=helpers["if"].call(depth0,depth0&&depth0.classUri,{hash:{},inverse:self.program(3,program3,data),fn:self.program(1,program1,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n    <div class=\"options folded\">\n        <ul>",(helper=helpers.tree)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.tree,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),(stack1||0===stack1)&&(buffer+=stack1),buffer+="</ul>\n    </div>\n</div>\n",buffer});Helpers0.__initialized||(Helpers0(Handlebars),Helpers0.__initialized=!0);var Template$1=Handlebars.template(function(Handlebars,depth0,helpers,partials,data){function program1(depth0,data){var buffer="",stack1,helper;return buffer+="\n        <ul>\n            ",(helper=helpers.childList)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.childList,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n        </ul>\n    ",buffer}this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var buffer="",escapeExpression=this.escapeExpression,self=this,stack1,helper;return buffer+="<li>\n    <a href=\"#\" data-uri=\"",(helper=helpers.uri)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.uri,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"\" title=\"",(helper=helpers.label)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.label,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"\">",(helper=helpers.label)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.label,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"</a>\n    ",stack1=helpers["if"].call(depth0,depth0&&depth0.childList,{hash:{},inverse:self.noop,fn:self.program(1,program1,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n</li>\n\n",buffer}),defaultConfig={classes:[],placeholder:__("Select a class")};return classesSelectorFactory}),define("ui/resource/selectable",["jquery","lodash"],function($,_){'use strict';function selectableFactory(component,config){var selection={},nodes={},isAComponent=_.all(["on","trigger","init","render","is","getElement"],function(method){return _.isFunction(component[method])}),getConfig=function(){return _.defaults(component.getConfig()||{},config||{})};if(!_.isObject(component)||!isAComponent)throw new TypeError("Selectable expects a component");return _.assign(component,{getNodes:function(){return nodes},getNode:function(uri){return!!(uri&&_.isPlainObject(nodes[uri]))&&nodes[uri]},setNodes:function(newNodes){_.isArray(newNodes)?nodes=_.reduce(newNodes,function(acc,node){return node.uri&&(acc[node.uri]=node),acc},{}):_.isObject(newNodes)&&(nodes=newNodes)},addNode:function(uri,node){return!!_.isPlainObject(node)&&(nodes[uri]=node,this.trigger("add",uri,node),!0)},removeNode:function(uri){return!!this.hasNode(uri)&&(selection[uri]&&this.unselect(uri),nodes=_.omit(nodes,uri),this.trigger("remove",uri),!0)},hasNode:function(uri){return"undefined"!=typeof nodes[uri]},getSelection:function(){return selection},clearSelection:function(){return 0<_.size(selection)&&(selection={}),this.is("rendered")&&($(".selected",this.getElement()).removeClass("selected"),this.trigger("change",selection)),this},select:function(uris,only,onlyVisible,withChildren){var self=this,currentConfig=getConfig(),$component;return this.is("rendered")&&($component=this.getElement(),only&&(selection={},$(".selected",this.getElement()).removeClass("selected")),!_.isArray(uris)&&(uris=[uris]),_(uris).reject(function(uri){return"undefined"!=typeof selection[uri]||!nodes[uri]}).forEach(function(uri){var $node=$("[data-uri=\""+uri+"\"]",$component),selectNode=$node.length;selectNode&&currentConfig&&_.isFunction(currentConfig.preventSelection)&&currentConfig.preventSelection(uri,nodes[uri],$node)&&(selectNode=!1),selectNode&&($node.addClass("selected"),selection[uri]=nodes[uri]),withChildren&&self.is("multiple")&&$node.find("[data-uri]").each(function(i,child){$(child).addClass("selected")}).map(function(){return $(this).data("uri")}).each(function(i,childUri){selection[childUri]=nodes[childUri]})}),this.trigger("change",selection,onlyVisible)),this},selectVisible:function(){var $component=this.getElement(),$elements=$component.find("[data-uri]").filter(function(){return 0===$(this).parents(".closed").length});this.select(_.map($elements,function(element){return $(element).data("uri")}),!1,!0)},unselect:function(uris){var $component;return this.is("rendered")&&($component=this.getElement(),!_.isArray(uris)&&(uris=[uris]),_(uris).filter(function(uri){return"undefined"!=typeof selection[uri]||!nodes[uri]}).forEach(function(uri){var $node=$("[data-uri=\""+uri+"\"]",$component);$node.length&&($node.removeClass("selected"),selection=_.omit(selection,uri)),$node.find("[data-uri]").each(function(i,child){$(child).removeClass("selected")}).map(function(){return $(this).data("uri")}).each(function(i,childUri){selection=_.omit(selection,childUri)})}),this.trigger("change",selection)),this},selectAll:function(){return this.select(_.keys(nodes))}})}$=$&&$.hasOwnProperty("default")?$["default"]:$,_=_&&_.hasOwnProperty("default")?_["default"]:_;return selectableFactory}),define("ui/resource/tree",["jquery","lodash","ui/component","ui/resource/selectable","ui/hider","handlebars","i18n","lib/dompurify/purify"],function($$1,_,component,selectable,hider,Handlebars,__,DOMPurify){'use strict';function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)?function(obj){return _typeof2(obj)}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":_typeof2(obj)},_typeof(obj)}function Helpers0(hb){hb.registerHelper("__",function(key){return __(key)}),hb.registerHelper("dompurify",function(context){return DOMPurify.sanitize(context)}),hb.registerHelper("join",function(arr,keyValueGlue,fragmentGlue,wrapper){var fragments=[];return keyValueGlue="string"==typeof keyValueGlue?keyValueGlue:void 0,fragmentGlue="string"==typeof fragmentGlue?fragmentGlue:" ",wrapper="string"==typeof wrapper?wrapper:"\"",_.forIn(arr,function(value,key){var fragment="";null!==value||void 0!==value?"boolean"==typeof value?value=value?"true":"false":"object"===_typeof(value)&&(value=_.values(value).join(" ")):value="",void 0!==keyValueGlue&&(fragment+=key+keyValueGlue),fragment+=wrapper+value+wrapper,fragments.push(fragment)}),fragments.join(fragmentGlue)}),hb.registerHelper("for",function(startIndex,stopIndex,increment,options){var ret="";startIndex=parseInt(startIndex),stopIndex=parseInt(stopIndex),increment=parseInt(increment);for(var i=startIndex;i<stopIndex;i+=increment)ret+=options.fn(_.extend({},this,{i:i}));return ret}),hb.registerHelper("equal",function(var1,var2,options){return var1==var2?options.fn(this):options.inverse(this)}),hb.registerHelper("property",function(name,context){return context[name]||""}),hb.registerHelper("includes",function(haystack,needle,options){if(_.contains(haystack,needle))return options.fn(this)})}function treeTpl(data,options,asString){var html=Template(data,options);return asString||!0?html:$(html)}function treeNodeTpl(data,options,asString){var html=Template$1(data,options);return asString||!0?html:$(html)}function resourceTreeFactory($container,config){var resourceTree=selectable(component({query:function(params){return this.is("loading")||this.trigger("query",_.defaults(params||{},{classUri:this.classUri})),this},update:function(nodes,params){function reduceNode(acc,node){return(node.selectable=!1,self.hasNode(node.uri)||params&&0<params.offset&&"class"===node.type||"class"===node.type&&!node.state&&!self.config.selectClass)?acc:("class"===node.type&&self.config.selectClass&&(node.classUri=node.uri,node.selectable=!0,!node.state&&(node.state="empty"),self.addNode(node.uri,_.omit(node,["count","children"]))),"instance"===node.type&&(node.selectable=!0,self.addNode(node.uri,_.omit(node,["count","children"])),node.icon=config.icon),node.children&&node.children.length&&(node.childList=reduceNodes(node.children)),acc+=treeNodeTpl(node),acc)}function reduceNodes(nodeList){return _.sortBy(nodeList,function(a,b){return b.label-a.label}).reduce(reduceNode,"")}var self=this,$root,$component;return this.is("rendered")&&($component=this.getElement(),params&&params.classUri&&($root=$$1(".class[data-uri=\""+params.classUri+"\"]",$component)),(!$root||!$root.length)&&($root=$component),nodes[0].uri===$root.data("uri")&&(nodes=nodes[0].children||[]),$root.children("ul").append(reduceNodes(nodes)),params&&_.isNumber(params.updateCount)&&updateCount($root,params.updateCount),needMore($root),indentChildren($component.children("ul"),0),$root.removeClass("closed").toggleClass("empty",!$root.children("ul").children("li").length),this.trigger("update")),this}},defaultConfig));return resourceTree.setTemplate(treeTpl).on("init",function(){this.classUri=this.config.classUri,this.setState("multiple",!!this.config.multiple),this.render($container)}).on("render",function(){var self=this,$component=this.getElement(),openClass=function($class){var node=self.getNode($class.data("uri"));$class.children("ul").children("li").length||self.query({classUri:$class.data("uri")}),node&&(node.state="open"),$class.addClass("open").removeClass("closed")},closeClass=function($class){var node=self.getNode($class.data("uri"));node&&(node.state="closed"),$class.removeClass("open").addClass("closed")},toggleClass=function($class){$class.hasClass("closed")?openClass($class):closeClass($class)};self.config.selectClass?$component.on("click",".class",function(e){var $class=$$1(e.currentTarget);e.preventDefault(),e.stopPropagation(),$$1(e.target).hasClass("class-toggler")?!$class.hasClass("empty")&&toggleClass($class):$class.hasClass("selected")?self.unselect($class.data("uri")):"denied"!==$class.data("access")&&self.select($class.data("uri"),!self.is("multiple"),!1,!0)}):$component.on("click",".class:not(.empty)",function(e){var $class=$$1(e.currentTarget);e.preventDefault(),e.stopPropagation(),toggleClass($class)}),$component.on("click",".instance:not([data-access=denied])",function(e){var $instance=$$1(e.currentTarget);e.preventDefault(),e.stopPropagation(),$instance.hasClass("selected")?self.unselect($instance.data("uri")):self.select($instance.data("uri"),!self.is("multiple"))}),$component.on("click",".more",function(e){var $root=$$1(e.currentTarget).parent(".class");e.preventDefault(),e.stopPropagation(),self.query({classUri:$root.data("uri"),offset:$root.children("ul").children(".instance").length})}),this.config.nodes?this.update(this.config.nodes):this.query()}).on("query",function(){this.setState("loading",!0)}).on("update",function(){this.setState("loading",!1)}).on("remove",function(uri){var $node,$parents,$parent;this.is("rendered")&&uri&&($node=$$1("[data-uri=\""+uri+"\"]",this.getElement()),$parents=$node.parents(".class"),$node.hasClass("instance")&&updateCount($parents,-1),$parent=$parents.first(),1===$parent.children("ul").children("li").length&&$parent.removeClass("closed").addClass("empty"),$node.remove())}),_.defer(function(){resourceTree.init(config)}),resourceTree}$$1=$$1&&$$1.hasOwnProperty("default")?$$1["default"]:$$1,_=_&&_.hasOwnProperty("default")?_["default"]:_,component=component&&component.hasOwnProperty("default")?component["default"]:component,selectable=selectable&&selectable.hasOwnProperty("default")?selectable["default"]:selectable,hider=hider&&hider.hasOwnProperty("default")?hider["default"]:hider,Handlebars=Handlebars&&Handlebars.hasOwnProperty("default")?Handlebars["default"]:Handlebars,__=__&&__.hasOwnProperty("default")?__["default"]:__,DOMPurify=DOMPurify&&DOMPurify.hasOwnProperty("default")?DOMPurify["default"]:DOMPurify,Helpers0.__initialized||(Helpers0(Handlebars),Helpers0.__initialized=!0);var Template=Handlebars.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var buffer="",self=this,stack1;return buffer+="<div class=\"resource-tree ",stack1=helpers["if"].call(depth0,depth0&&depth0.multiple,{hash:{},inverse:self.noop,fn:self.program(1,function(){return"multiple"},data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\">\n    <ul></ul>\n</div>\n\n",buffer});Helpers0.__initialized||(Helpers0(Handlebars),Helpers0.__initialized=!0);var Template$1=Handlebars.template(function(Handlebars,depth0,helpers,partials,data){function program1(depth0,data){var buffer="",stack1,helper,options;return buffer+="\n<li data-uri=\"",(helper=helpers.uri)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.uri,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"\" class=\"class",stack1=helpers["if"].call(depth0,depth0&&depth0.selectable,{hash:{},inverse:self.noop,fn:self.program(2,program2,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+=" ",(helper=helpers.state)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.state,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"\" data-count=\"",(helper=helpers.count)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.count,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"\" ",stack1=helpers["if"].call(depth0,depth0&&depth0.accessMode,{hash:{},inverse:self.noop,fn:self.program(4,program4,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+=">\n    <a href=\"#\" title=\"",(helper=helpers.label)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.label,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"\">\n        <span class=\"class-toggler clickable\" tabindex=\"0\"></span>\n        <span class=\"icon-folder\"></span>\n        ",(helper=helpers.label)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.label,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"\n        <span class=\"selector clickable\" tabindex=\"0\"></span>\n    </a>\n    <ul>\n    ",stack1=helpers["if"].call(depth0,depth0&&depth0.childList,{hash:{},inverse:self.noop,fn:self.program(6,program6,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n    </ul>\n    <div class=\"more hidden\">\n        <a href=\"#\" class=\"btn-info small\"><span class=\"icon-download\"></span> "+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"Load more",options):helperMissing.call(depth0,"__","Load more",options)))+"</a>\n    </div>\n</li>\n",buffer}function program2(){return" selectable"}function program4(depth0,data){var buffer="",stack1,helper;return buffer+="data-access=\"",(helper=helpers.accessMode)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.accessMode,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"\"",buffer}function program6(depth0,data){var buffer="",stack1,helper;return buffer+="\n        ",(helper=helpers.childList)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.childList,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n    ",buffer}function program8(depth0,data){var buffer="",stack1,helper;return buffer+="\n<li data-uri=\"",(helper=helpers.uri)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.uri,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"\" class=\"instance",stack1=helpers["if"].call(depth0,depth0&&depth0.selectable,{hash:{},inverse:self.noop,fn:self.program(2,program2,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+=" ",(helper=helpers.state)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.state,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"\"  ",stack1=helpers["if"].call(depth0,depth0&&depth0.accessMode,{hash:{},inverse:self.noop,fn:self.program(4,program4,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+=">\n    <a href=\"#\" title=\"",(helper=helpers.label)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.label,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"\">\n        <span class=\"icon-",(helper=helpers.icon)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.icon,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"\"></span>\n        ",(helper=helpers.label)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.label,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"\n        <span class=\"selector clickable\" tabindex=\"0\"></span>\n    </a>\n</li>\n",buffer}this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var buffer="",escapeExpression=this.escapeExpression,self=this,helperMissing=helpers.helperMissing,stack1,helper,options;return stack1=(helper=helpers.equal||depth0&&depth0.equal,options={hash:{},inverse:self.noop,fn:self.program(1,program1,data),data:data},helper?helper.call(depth0,depth0&&depth0.type,"class",options):helperMissing.call(depth0,"equal",depth0&&depth0.type,"class",options)),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n\n",stack1=(helper=helpers.equal||depth0&&depth0.equal,options={hash:{},inverse:self.noop,fn:self.program(8,program8,data),data:data},helper?helper.call(depth0,depth0&&depth0.type,"instance",options):helperMissing.call(depth0,"equal",depth0&&depth0.type,"instance",options)),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n\n\n",buffer}),defaultConfig={multiple:!0},indentChildren=function indentChildren($list,level){var indent;$list.length&&(indent=level*15,level++,$list.children("li").each(function(){var $target=$$1(this);$target.children("a").css("padding-left",indent+"px"),indentChildren($target.children("ul"),level)}),$list.siblings(".more").css("padding-left",indent+"px"))},needMore=function needMore($node){var $more=$node.children(".more"),totalCount=$node.data("count"),instancesCount=$node.children("ul").children(".instance").length;0<totalCount&&0<instancesCount&&instancesCount<totalCount?hider.show($more):hider.hide($more),$node.children("ul").find(".class").each(function(){needMore($$1(this))})},updateCount=function($classNode,update){var count=0;$classNode&&$classNode.length&&$classNode.hasClass("class")&&(count=$classNode.data("count"),count+=update,0>count&&(count=0),$classNode.attr("data-count",count).data("count",count))};return resourceTreeFactory}),define("ui/resource/list",["jquery","lodash","ui/component","ui/resource/selectable","ui/hider","handlebars","i18n","lib/dompurify/purify"],function($$1,_,component,selectable,hider,Handlebars,__,DOMPurify){'use strict';function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)?function(obj){return _typeof2(obj)}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":_typeof2(obj)},_typeof(obj)}function Helpers0(hb){hb.registerHelper("__",function(key){return __(key)}),hb.registerHelper("dompurify",function(context){return DOMPurify.sanitize(context)}),hb.registerHelper("join",function(arr,keyValueGlue,fragmentGlue,wrapper){var fragments=[];return keyValueGlue="string"==typeof keyValueGlue?keyValueGlue:void 0,fragmentGlue="string"==typeof fragmentGlue?fragmentGlue:" ",wrapper="string"==typeof wrapper?wrapper:"\"",_.forIn(arr,function(value,key){var fragment="";null!==value||void 0!==value?"boolean"==typeof value?value=value?"true":"false":"object"===_typeof(value)&&(value=_.values(value).join(" ")):value="",void 0!==keyValueGlue&&(fragment+=key+keyValueGlue),fragment+=wrapper+value+wrapper,fragments.push(fragment)}),fragments.join(fragmentGlue)}),hb.registerHelper("for",function(startIndex,stopIndex,increment,options){var ret="";startIndex=parseInt(startIndex),stopIndex=parseInt(stopIndex),increment=parseInt(increment);for(var i=startIndex;i<stopIndex;i+=increment)ret+=options.fn(_.extend({},this,{i:i}));return ret}),hb.registerHelper("equal",function(var1,var2,options){return var1==var2?options.fn(this):options.inverse(this)}),hb.registerHelper("property",function(name,context){return context[name]||""}),hb.registerHelper("includes",function(haystack,needle,options){if(_.contains(haystack,needle))return options.fn(this)})}function listTpl(data,options,asString){var html=Template(data,options);return asString||!0?html:$(html)}function listNodeTpl(data,options,asString){var html=Template$1(data,options);return asString||!0?html:$(html)}function resourceListFactory($container,config){var resourceList=selectable(component({query:function(params){this.is("loading")||this.trigger("query",_.defaults(params||{},{classUri:this.classUri}))},update:function(resources){var self=this;this.is("rendered")&&($list.append(_.reduce(resources.nodes,function(acc,node){return node.icon=self.config.icon,acc+=listNodeTpl(node),acc},"")),_.forEach(resources.nodes,function(node){self.addNode(node.uri,node)}),resources.total>_.size(self.getNodes())?hider.show($loadMore):hider.hide($loadMore),this.trigger("update"))}},defaultConfig)),$list,$loadMore;return resourceList.setTemplate(listTpl).on("init",function(){this.classUri=this.config.classUri,this.setState("multiple",!!this.config.multiple),this.render($container)}).on("render",function(){var self=this,$component=this.getElement();$list=$component.children("ul"),$loadMore=$$1(".more",$component),$component.on("click","li",function(e){var $instance=$$1(e.currentTarget);e.preventDefault(),e.stopPropagation(),$instance.hasClass("selected")?self.unselect($instance.data("uri")):self.select($instance.data("uri"),!self.is("multiple"))}),$loadMore.on("click",function(e){e.preventDefault(),self.query({offset:_.size(self.getNodes())})}),this.config.nodes?this.update(this.config.nodes):this.query()}).on("query",function(){this.setState("loading",!0)}).on("update",function(){this.setState("loading",!1)}).on("remove",function(uri){this.is("rendered")&&$$1("[data-uri=\""+uri+"\"]",this.getElement()).remove()}),_.defer(function(){resourceList.init(config)}),resourceList}$$1=$$1&&$$1.hasOwnProperty("default")?$$1["default"]:$$1,_=_&&_.hasOwnProperty("default")?_["default"]:_,component=component&&component.hasOwnProperty("default")?component["default"]:component,selectable=selectable&&selectable.hasOwnProperty("default")?selectable["default"]:selectable,hider=hider&&hider.hasOwnProperty("default")?hider["default"]:hider,Handlebars=Handlebars&&Handlebars.hasOwnProperty("default")?Handlebars["default"]:Handlebars,__=__&&__.hasOwnProperty("default")?__["default"]:__,DOMPurify=DOMPurify&&DOMPurify.hasOwnProperty("default")?DOMPurify["default"]:DOMPurify,Helpers0.__initialized||(Helpers0(Handlebars),Helpers0.__initialized=!0);var Template=Handlebars.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var buffer="",self=this,helperMissing=helpers.helperMissing,escapeExpression=this.escapeExpression,stack1,helper,options;return buffer+="<div class=\"resource-list ",stack1=helpers["if"].call(depth0,depth0&&depth0.multiple,{hash:{},inverse:self.noop,fn:self.program(1,function(){return"multiple"},data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\">\n    <ul></ul>\n    <div class=\"more hidden\">\n        <a href=\"#\" class=\"btn-info small\"><span class=\"icon-download\"></span> "+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"Load more",options):helperMissing.call(depth0,"__","Load more",options)))+"</a>\n    </div>\n</div>\n\n",buffer});Helpers0.__initialized||(Helpers0(Handlebars),Helpers0.__initialized=!0);var Template$1=Handlebars.template(function(Handlebars,depth0,helpers,partials,data){function program3(depth0,data){var buffer="",stack1,helper;return buffer+="data-access=\"",(helper=helpers.accessMode)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.accessMode,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"\"",buffer}this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var buffer="",escapeExpression=this.escapeExpression,self=this,stack1,helper;return buffer+="<li data-uri=\"",(helper=helpers.uri)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.uri,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"\" ",stack1=helpers["if"].call(depth0,depth0&&depth0.selected,{hash:{},inverse:self.noop,fn:self.program(1,function(){return"class=\"selected\""},data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+=" class=\"",(helper=helpers.state)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.state,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"\" ",stack1=helpers["if"].call(depth0,depth0&&depth0.accessMode,{hash:{},inverse:self.noop,fn:self.program(3,program3,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+=">\n    <a href=\"#\" title=\"",(helper=helpers.label)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.label,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"\"><span class=\"icon-",(helper=helpers.icon)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.icon,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"\"></span>",(helper=helpers.label)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.label,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"</a>\n</li>\n\n",buffer}),defaultConfig={multiple:!0};return resourceListFactory}),define("css!ui/generis/validator/css/validator",[],function(){}),define("ui/generis/validator/validator",["jquery","lodash","ui/component","handlebars","i18n","lib/dompurify/purify","css!ui/generis/validator/css/validator.css"],function($$1,_,componentFactory,Handlebars,__,DOMPurify){'use strict';function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)?function(obj){return _typeof2(obj)}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":_typeof2(obj)},_typeof(obj)}function Helpers0(hb){hb.registerHelper("__",function(key){return __(key)}),hb.registerHelper("dompurify",function(context){return DOMPurify.sanitize(context)}),hb.registerHelper("join",function(arr,keyValueGlue,fragmentGlue,wrapper){var fragments=[];return keyValueGlue="string"==typeof keyValueGlue?keyValueGlue:void 0,fragmentGlue="string"==typeof fragmentGlue?fragmentGlue:" ",wrapper="string"==typeof wrapper?wrapper:"\"",_.forIn(arr,function(value,key){var fragment="";null!==value||void 0!==value?"boolean"==typeof value?value=value?"true":"false":"object"===_typeof(value)&&(value=_.values(value).join(" ")):value="",void 0!==keyValueGlue&&(fragment+=key+keyValueGlue),fragment+=wrapper+value+wrapper,fragments.push(fragment)}),fragments.join(fragmentGlue)}),hb.registerHelper("for",function(startIndex,stopIndex,increment,options){var ret="";startIndex=parseInt(startIndex),stopIndex=parseInt(stopIndex),increment=parseInt(increment);for(var i=startIndex;i<stopIndex;i+=increment)ret+=options.fn(_.extend({},this,{i:i}));return ret}),hb.registerHelper("equal",function(var1,var2,options){return var1==var2?options.fn(this):options.inverse(this)}),hb.registerHelper("property",function(name,context){return context[name]||""}),hb.registerHelper("includes",function(haystack,needle,options){if(_.contains(haystack,needle))return options.fn(this)})}function tpl(data,options,asString){var html=Template(data,options);return asString||!0?html:$(html)}function factory(options){var validator;return options=options||{},validator=componentFactory({run:function(value){return this.errors=_(this.validations).reject(function(validation){return validation.predicate instanceof RegExp?validation.predicate.test(value):"function"==typeof validation.predicate?validation.predicate(value):void 0},this).sortBy("precedence").map(function(validation){return validation.message}).value(),this},clear:function(){return this.errors=[],this.is("rendered")&&this.getElement().empty(),this},display:function(){var $this=this.getElement();return this.is("rendered")&&($this.empty(),_.each(this.errors,function(error){$this.append($$1("<div>",{class:"validation-error"}).text(error))})),this},addValidation:function(validation){return this.validations.push(validation),this},removeValidations:function(){return this.validations=[],this}}).setTemplate(tpl).init(),validator.errors=[],validator.validations=options.validations||[],validator}$$1=$$1&&$$1.hasOwnProperty("default")?$$1["default"]:$$1,_=_&&_.hasOwnProperty("default")?_["default"]:_,componentFactory=componentFactory&&componentFactory.hasOwnProperty("default")?componentFactory["default"]:componentFactory,Handlebars=Handlebars&&Handlebars.hasOwnProperty("default")?Handlebars["default"]:Handlebars,__=__&&__.hasOwnProperty("default")?__["default"]:__,DOMPurify=DOMPurify&&DOMPurify.hasOwnProperty("default")?DOMPurify["default"]:DOMPurify,Helpers0.__initialized||(Helpers0(Handlebars),Helpers0.__initialized=!0);var Template=Handlebars.template(function(Handlebars,depth0,helpers){return this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),"<div class=\"ui-generis-validator\"></div>"});return factory}),define("css!ui/generis/widget/css/widget",[],function(){}),define("ui/generis/widget/widget",["lodash","i18n","ui/component","ui/generis/validator/validator","handlebars","lib/dompurify/purify","css!ui/generis/widget/css/widget.css"],function(_,__,componentFactory,generisValidatorFactory,Handlebars,DOMPurify){'use strict';function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)?function(obj){return _typeof2(obj)}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":_typeof2(obj)},_typeof(obj)}function Helpers0(hb){hb.registerHelper("__",function(key){return __(key)}),hb.registerHelper("dompurify",function(context){return DOMPurify.sanitize(context)}),hb.registerHelper("join",function(arr,keyValueGlue,fragmentGlue,wrapper){var fragments=[];return keyValueGlue="string"==typeof keyValueGlue?keyValueGlue:void 0,fragmentGlue="string"==typeof fragmentGlue?fragmentGlue:" ",wrapper="string"==typeof wrapper?wrapper:"\"",_.forIn(arr,function(value,key){var fragment="";null!==value||void 0!==value?"boolean"==typeof value?value=value?"true":"false":"object"===_typeof(value)&&(value=_.values(value).join(" ")):value="",void 0!==keyValueGlue&&(fragment+=key+keyValueGlue),fragment+=wrapper+value+wrapper,fragments.push(fragment)}),fragments.join(fragmentGlue)}),hb.registerHelper("for",function(startIndex,stopIndex,increment,options){var ret="";startIndex=parseInt(startIndex),stopIndex=parseInt(stopIndex),increment=parseInt(increment);for(var i=startIndex;i<stopIndex;i+=increment)ret+=options.fn(_.extend({},this,{i:i}));return ret}),hb.registerHelper("equal",function(var1,var2,options){return var1==var2?options.fn(this):options.inverse(this)}),hb.registerHelper("property",function(name,context){return context[name]||""}),hb.registerHelper("includes",function(haystack,needle,options){if(_.contains(haystack,needle))return options.fn(this)})}function factory(options,spec){var widget;return options=options||{},widget=componentFactory(_.assign({get:function(){var ret=this.config.value||"";return this.is("rendered")&&(ret=this.getElement().find("[name=\""+this.config.uri+"\"]").val()),ret},set:function(value){return this.config.value=value,this.is("rendered")&&this.getElement().find("[name=\""+this.config.uri+"\"]").val(value),this.config.value},setValidator:function(validator){return validator=validator||[],this.validator="function"==typeof validator.is?validator:generisValidatorFactory({validations:validator}),this.is("rendered")?this.validator.render(this.getElement()):this.on("render.setValidator",function(){this.validator.render(this.getElement()),this.off("render.setValidator")}),this},validate:function(){var input;return this.validator&&(this.validator.run(this.get()),this.validator.display(),this.is("rendered")&&(input=this.getElement().find(".right > :input, .right > .check-box-input"),this.validator.errors.length?input.addClass("error"):input.removeClass("error"))),this},serialize:function(){return{name:this.config.uri,value:this.get()}}},spec),{label:__("Label"),required:!1}).on("render",function(){var $input=this.getElement().find(".right :input"),self=this;$input.on("change blur",function(){self.trigger("change",self.serialize())})}),widget.setValidator(options.validator),widget}_=_&&_.hasOwnProperty("default")?_["default"]:_,__=__&&__.hasOwnProperty("default")?__["default"]:__,componentFactory=componentFactory&&componentFactory.hasOwnProperty("default")?componentFactory["default"]:componentFactory,generisValidatorFactory=generisValidatorFactory&&generisValidatorFactory.hasOwnProperty("default")?generisValidatorFactory["default"]:generisValidatorFactory,Handlebars=Handlebars&&Handlebars.hasOwnProperty("default")?Handlebars["default"]:Handlebars,DOMPurify=DOMPurify&&DOMPurify.hasOwnProperty("default")?DOMPurify["default"]:DOMPurify,Helpers0.__initialized||(Helpers0(Handlebars),Helpers0.__initialized=!0);var Template=Handlebars.template(function(Handlebars,depth0,helpers,partials,data){function program1(depth0,data){var buffer="",helper,options;return buffer+="\n    <abbr title=\""+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"This field is required",options):helperMissing.call(depth0,"__","This field is required",options)))+"\">*</abbr>\n    ",buffer}this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var buffer="",helperMissing=helpers.helperMissing,escapeExpression=this.escapeExpression,self=this,stack1,helper;return buffer+="<label for=\"",(helper=helpers.uri)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.uri,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"\">\n    ",(helper=helpers.label)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.label,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"\n    ",stack1=helpers["if"].call(depth0,depth0&&depth0.required,{hash:{},inverse:self.noop,fn:self.program(1,program1,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n</label>",buffer});return Handlebars.registerPartial("ui-generis-widget-label",function(data,options,asString){var html=Template(data,options);return asString||!0?html:$(html)}),factory}),define("ui/generis/widget/checkBox/checkBox",["jquery","lodash","i18n","ui/generis/widget/widget","handlebars","lib/dompurify/purify"],function($$1,_,__,widgetFactory,Handlebars,DOMPurify){'use strict';function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)?function(obj){return _typeof2(obj)}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":_typeof2(obj)},_typeof(obj)}function Helpers0(hb){hb.registerHelper("__",function(key){return __(key)}),hb.registerHelper("dompurify",function(context){return DOMPurify.sanitize(context)}),hb.registerHelper("join",function(arr,keyValueGlue,fragmentGlue,wrapper){var fragments=[];return keyValueGlue="string"==typeof keyValueGlue?keyValueGlue:void 0,fragmentGlue="string"==typeof fragmentGlue?fragmentGlue:" ",wrapper="string"==typeof wrapper?wrapper:"\"",_.forIn(arr,function(value,key){var fragment="";null!==value||void 0!==value?"boolean"==typeof value?value=value?"true":"false":"object"===_typeof(value)&&(value=_.values(value).join(" ")):value="",void 0!==keyValueGlue&&(fragment+=key+keyValueGlue),fragment+=wrapper+value+wrapper,fragments.push(fragment)}),fragments.join(fragmentGlue)}),hb.registerHelper("for",function(startIndex,stopIndex,increment,options){var ret="";startIndex=parseInt(startIndex),stopIndex=parseInt(stopIndex),increment=parseInt(increment);for(var i=startIndex;i<stopIndex;i+=increment)ret+=options.fn(_.extend({},this,{i:i}));return ret}),hb.registerHelper("equal",function(var1,var2,options){return var1==var2?options.fn(this):options.inverse(this)}),hb.registerHelper("property",function(name,context){return context[name]||""}),hb.registerHelper("includes",function(haystack,needle,options){if(_.contains(haystack,needle))return options.fn(this)})}function tpl(data,options,asString){var html=Template(data,options);return asString||!0?html:$(html)}function factory(options,config){var validator=options.validator||[],widget;return widget=widgetFactory({validator:validator},{get:function(){var ret=this.config.values||[];return this.is("rendered")&&(ret=[],this.getElement().find(".option input:checked").map(function(){ret.push($$1(this).val())})),ret},set:function(values){return Array.isArray(values)?this.config.values=values:this.config.values.push(values),this.is("rendered")&&_.each(this.config.values,function(value){this.getElement().find("input[name="+value+"]").prop("checked",!0)}),this.config.values}}).setTemplate(tpl).init({label:config.label,range:config.range||[],required:config.required||!1,uri:config.uri,values:config.values||[]}),widget.config.required&&widget.validator.addValidation({message:__("This field is required"),predicate:function(value){return 0<value.length},precedence:1}),widget}$$1=$$1&&$$1.hasOwnProperty("default")?$$1["default"]:$$1,_=_&&_.hasOwnProperty("default")?_["default"]:_,__=__&&__.hasOwnProperty("default")?__["default"]:__,widgetFactory=widgetFactory&&widgetFactory.hasOwnProperty("default")?widgetFactory["default"]:widgetFactory,Handlebars=Handlebars&&Handlebars.hasOwnProperty("default")?Handlebars["default"]:Handlebars,DOMPurify=DOMPurify&&DOMPurify.hasOwnProperty("default")?DOMPurify["default"]:DOMPurify,Helpers0.__initialized||(Helpers0(Handlebars),Helpers0.__initialized=!0);var Template=Handlebars.template(function(Handlebars,depth0,helpers,partials,data){function program1(depth0,data,depth1){var buffer="",stack1,helper,options;return buffer+="\n            <div class=\"option\">\n                <label>\n                    <input type=\"checkbox\" name=\""+escapeExpression((stack1=depth0&&depth0.uri,"function"===_typeof2(stack1)?stack1.apply(depth0):stack1))+"\" value=\""+escapeExpression((stack1=depth0&&depth0.uri,"function"===_typeof2(stack1)?stack1.apply(depth0):stack1))+"\" ",stack1=(helper=helpers.includes||depth1&&depth1.includes,options={hash:{},inverse:self.noop,fn:self.program(2,program2,data),data:data},helper?helper.call(depth0,depth1&&depth1.values,depth0&&depth0.uri,options):helperMissing.call(depth0,"includes",depth1&&depth1.values,depth0&&depth0.uri,options)),(stack1||0===stack1)&&(buffer+=stack1),buffer+=">\n                    <span class=\"icon-checkbox\"></span>\n                    "+escapeExpression((stack1=depth0&&depth0.label,"function"===_typeof2(stack1)?stack1.apply(depth0):stack1))+"\n                </label>\n            </div>\n            ",buffer}function program2(){return"\n                        checked=\"true\" "}this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),partials=this.merge(partials,Handlebars.partials),data=data||{};var buffer="",escapeExpression=this.escapeExpression,self=this,helperMissing=helpers.helperMissing,stack1;return buffer+="<div class=\"ui-generis-widget check-box\">\n    <div class=\"left\">\n        ",stack1=self.invokePartial(partials["ui-generis-widget-label"],"ui-generis-widget-label",depth0,helpers,partials,data),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n    </div>\n    <div class=\"right\">\n        <div class=\"check-box-input\">\n            ",stack1=helpers.each.call(depth0,depth0&&depth0.range,{hash:{},inverse:self.noop,fn:self.programWithDepth(1,program1,data,depth0),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n        </div>\n    </div>\n</div>",buffer});return factory}),define("ui/generis/widget/comboBox/comboBox",["lodash","i18n","ui/generis/widget/widget","handlebars","lib/dompurify/purify"],function(_,__,widgetFactory,Handlebars,DOMPurify){'use strict';function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)?function(obj){return _typeof2(obj)}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":_typeof2(obj)},_typeof(obj)}function Helpers0(hb){hb.registerHelper("__",function(key){return __(key)}),hb.registerHelper("dompurify",function(context){return DOMPurify.sanitize(context)}),hb.registerHelper("join",function(arr,keyValueGlue,fragmentGlue,wrapper){var fragments=[];return keyValueGlue="string"==typeof keyValueGlue?keyValueGlue:void 0,fragmentGlue="string"==typeof fragmentGlue?fragmentGlue:" ",wrapper="string"==typeof wrapper?wrapper:"\"",_.forIn(arr,function(value,key){var fragment="";null!==value||void 0!==value?"boolean"==typeof value?value=value?"true":"false":"object"===_typeof(value)&&(value=_.values(value).join(" ")):value="",void 0!==keyValueGlue&&(fragment+=key+keyValueGlue),fragment+=wrapper+value+wrapper,fragments.push(fragment)}),fragments.join(fragmentGlue)}),hb.registerHelper("for",function(startIndex,stopIndex,increment,options){var ret="";startIndex=parseInt(startIndex),stopIndex=parseInt(stopIndex),increment=parseInt(increment);for(var i=startIndex;i<stopIndex;i+=increment)ret+=options.fn(_.extend({},this,{i:i}));return ret}),hb.registerHelper("equal",function(var1,var2,options){return var1==var2?options.fn(this):options.inverse(this)}),hb.registerHelper("property",function(name,context){return context[name]||""}),hb.registerHelper("includes",function(haystack,needle,options){if(_.contains(haystack,needle))return options.fn(this)})}function tpl(data,options,asString){var html=Template(data,options);return asString||!0?html:$(html)}function factory(options,config){var validator=options.validator||[],widget;return widget=widgetFactory({validator:validator},{}).setTemplate(tpl).init({label:config.label,range:config.range||[],required:config.required||!1,uri:config.uri,value:config.value||""}),widget.config.required&&widget.validator.addValidation({message:__("This field is required"),predicate:/\S+/,precedence:1}),widget}_=_&&_.hasOwnProperty("default")?_["default"]:_,__=__&&__.hasOwnProperty("default")?__["default"]:__,widgetFactory=widgetFactory&&widgetFactory.hasOwnProperty("default")?widgetFactory["default"]:widgetFactory,Handlebars=Handlebars&&Handlebars.hasOwnProperty("default")?Handlebars["default"]:Handlebars,DOMPurify=DOMPurify&&DOMPurify.hasOwnProperty("default")?DOMPurify["default"]:DOMPurify,Helpers0.__initialized||(Helpers0(Handlebars),Helpers0.__initialized=!0);var Template=Handlebars.template(function(Handlebars,depth0,helpers,partials,data){function program1(depth0){var buffer="",stack1;return buffer+="\n            <option value=\""+escapeExpression((stack1=depth0&&depth0.uri,"function"===_typeof2(stack1)?stack1.apply(depth0):stack1))+"\">"+escapeExpression((stack1=depth0&&depth0.label,"function"===_typeof2(stack1)?stack1.apply(depth0):stack1))+"</option>\n            ",buffer}this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),partials=this.merge(partials,Handlebars.partials),data=data||{};var buffer="",escapeExpression=this.escapeExpression,self=this,helperMissing=helpers.helperMissing,stack1,helper,options;return buffer+="<div class=\"ui-generis-widget combo-box\">\n    <div class=\"left\">\n        ",stack1=self.invokePartial(partials["ui-generis-widget-label"],"ui-generis-widget-label",depth0,helpers,partials,data),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n    </div>\n    <div class=\"right\">\n        <select name=\"",(helper=helpers.uri)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.uri,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"\">\n            <option value=\"\">"+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"Choose a value...",options):helperMissing.call(depth0,"__","Choose a value...",options)))+"</option>\n            ",stack1=helpers.each.call(depth0,depth0&&depth0.range,{hash:{},inverse:self.noop,fn:self.program(1,program1,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n        </select>\n    </div>\n</div>",buffer});return factory}),define("ui/generis/widget/hiddenBox/hiddenBox",["lodash","i18n","ui/generis/widget/widget","handlebars","lib/dompurify/purify"],function(_,__,widgetFactory,Handlebars,DOMPurify){'use strict';function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)?function(obj){return _typeof2(obj)}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":_typeof2(obj)},_typeof(obj)}function Helpers0(hb){hb.registerHelper("__",function(key){return __(key)}),hb.registerHelper("dompurify",function(context){return DOMPurify.sanitize(context)}),hb.registerHelper("join",function(arr,keyValueGlue,fragmentGlue,wrapper){var fragments=[];return keyValueGlue="string"==typeof keyValueGlue?keyValueGlue:void 0,fragmentGlue="string"==typeof fragmentGlue?fragmentGlue:" ",wrapper="string"==typeof wrapper?wrapper:"\"",_.forIn(arr,function(value,key){var fragment="";null!==value||void 0!==value?"boolean"==typeof value?value=value?"true":"false":"object"===_typeof(value)&&(value=_.values(value).join(" ")):value="",void 0!==keyValueGlue&&(fragment+=key+keyValueGlue),fragment+=wrapper+value+wrapper,fragments.push(fragment)}),fragments.join(fragmentGlue)}),hb.registerHelper("for",function(startIndex,stopIndex,increment,options){var ret="";startIndex=parseInt(startIndex),stopIndex=parseInt(stopIndex),increment=parseInt(increment);for(var i=startIndex;i<stopIndex;i+=increment)ret+=options.fn(_.extend({},this,{i:i}));return ret}),hb.registerHelper("equal",function(var1,var2,options){return var1==var2?options.fn(this):options.inverse(this)}),hb.registerHelper("property",function(name,context){return context[name]||""}),hb.registerHelper("includes",function(haystack,needle,options){if(_.contains(haystack,needle))return options.fn(this)})}function tpl(data,options,asString){var html=Template(data,options);return asString||!0?html:$(html)}function factory(options,config){var validator=options.validator||[],widget;return widget=widgetFactory({validator:validator},{get:function(){var ret={value:this.config.value,confirmation:this.config.confirmation.value},$el;return this.is("rendered")&&($el=this.getElement(),ret.value=$el.find("[name=\""+this.config.uri+"\"]").val(),ret.confirmation=$el.find("[name=\""+this.config.confirmation.uri+"\"]").val()),ret},set:function(value){var $el;return this.config.value=this.config.confirmation.value=value,this.is("rendered")&&($el=this.getElement(),$el.find("[name=\""+this.config.uri+"\"]").val(value),$el.find("[name=\""+this.config.confirmation.uri+"\"]").val(value)),{value:this.config.value,confirmation:this.config.confirmation.value}},serialize:function(){return{name:this.config.uri,value:this.get().value}}}).setTemplate(tpl).init({confirmation:{label:__("%s Confirmation",config.label),uri:config.uri+"_confirmation",value:config.value||""},label:config.label,required:config.required||!1,uri:config.uri,value:config.value||""}),widget.config.required&&widget.validator.addValidation({message:__("This field is required"),predicate:function(value){return /\S+/.test(value.value)},precedence:1}),widget.validator.addValidation({message:__("Fields must match"),predicate:function(value){return value.value===value.confirmation},precedence:2}),widget}_=_&&_.hasOwnProperty("default")?_["default"]:_,__=__&&__.hasOwnProperty("default")?__["default"]:__,widgetFactory=widgetFactory&&widgetFactory.hasOwnProperty("default")?widgetFactory["default"]:widgetFactory,Handlebars=Handlebars&&Handlebars.hasOwnProperty("default")?Handlebars["default"]:Handlebars,DOMPurify=DOMPurify&&DOMPurify.hasOwnProperty("default")?DOMPurify["default"]:DOMPurify,Helpers0.__initialized||(Helpers0(Handlebars),Helpers0.__initialized=!0);var Template=Handlebars.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),partials=this.merge(partials,Handlebars.partials),data=data||{};var buffer="",self=this,escapeExpression=this.escapeExpression,stack1,helper;return buffer+="<div class=\"ui-generis-widget hidden-box\">\n    <div class=\"left\">\n        ",stack1=self.invokePartial(partials["ui-generis-widget-label"],"ui-generis-widget-label",depth0,helpers,partials,data),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n    </div>\n    <div class=\"right\">\n        <input name=\"",(helper=helpers.uri)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.uri,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"\" type=\"password\">\n    </div>\n</div>\n\n<div class=\"ui-generis-widget hidden-box confirmation\">\n    <div class=\"left\">\n        ",stack1=self.invokePartial(partials["ui-generis-widget-label"],"ui-generis-widget-label",depth0&&depth0.confirmation,helpers,partials,data),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n    </div>\n    <div class=\"right\">\n        <input name=\""+escapeExpression((stack1=(stack1=depth0&&depth0.confirmation,null==stack1||!1===stack1?stack1:stack1.uri),"function"===_typeof2(stack1)?stack1.apply(depth0):stack1))+"\" type=\"password\">\n    </div>\n</div>",buffer});return factory}),define("ui/generis/widget/textBox/textBox",["lodash","i18n","ui/generis/widget/widget","handlebars","lib/dompurify/purify"],function(_,__,widgetFactory,Handlebars,DOMPurify){'use strict';function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)?function(obj){return _typeof2(obj)}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":_typeof2(obj)},_typeof(obj)}function Helpers0(hb){hb.registerHelper("__",function(key){return __(key)}),hb.registerHelper("dompurify",function(context){return DOMPurify.sanitize(context)}),hb.registerHelper("join",function(arr,keyValueGlue,fragmentGlue,wrapper){var fragments=[];return keyValueGlue="string"==typeof keyValueGlue?keyValueGlue:void 0,fragmentGlue="string"==typeof fragmentGlue?fragmentGlue:" ",wrapper="string"==typeof wrapper?wrapper:"\"",_.forIn(arr,function(value,key){var fragment="";null!==value||void 0!==value?"boolean"==typeof value?value=value?"true":"false":"object"===_typeof(value)&&(value=_.values(value).join(" ")):value="",void 0!==keyValueGlue&&(fragment+=key+keyValueGlue),fragment+=wrapper+value+wrapper,fragments.push(fragment)}),fragments.join(fragmentGlue)}),hb.registerHelper("for",function(startIndex,stopIndex,increment,options){var ret="";startIndex=parseInt(startIndex),stopIndex=parseInt(stopIndex),increment=parseInt(increment);for(var i=startIndex;i<stopIndex;i+=increment)ret+=options.fn(_.extend({},this,{i:i}));return ret}),hb.registerHelper("equal",function(var1,var2,options){return var1==var2?options.fn(this):options.inverse(this)}),hb.registerHelper("property",function(name,context){return context[name]||""}),hb.registerHelper("includes",function(haystack,needle,options){if(_.contains(haystack,needle))return options.fn(this)})}function tpl(data,options,asString){var html=Template(data,options);return asString||!0?html:$(html)}function factory(options,config){var validator=options.validator||[],widget;return widget=widgetFactory({validator:validator},{}).setTemplate(tpl).init({label:config.label,required:config.required||!1,uri:config.uri,value:config.value||""}),widget.config.required&&widget.validator.addValidation({message:__("This field is required"),predicate:/\S+/,precedence:1}),widget}_=_&&_.hasOwnProperty("default")?_["default"]:_,__=__&&__.hasOwnProperty("default")?__["default"]:__,widgetFactory=widgetFactory&&widgetFactory.hasOwnProperty("default")?widgetFactory["default"]:widgetFactory,Handlebars=Handlebars&&Handlebars.hasOwnProperty("default")?Handlebars["default"]:Handlebars,DOMPurify=DOMPurify&&DOMPurify.hasOwnProperty("default")?DOMPurify["default"]:DOMPurify,Helpers0.__initialized||(Helpers0(Handlebars),Helpers0.__initialized=!0);var Template=Handlebars.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),partials=this.merge(partials,Handlebars.partials),data=data||{};var buffer="",self=this,escapeExpression=this.escapeExpression,stack1,helper;return buffer+="<div class=\"ui-generis-widget text-box\">\n    <div class=\"left\">\n        ",stack1=self.invokePartial(partials["ui-generis-widget-label"],"ui-generis-widget-label",depth0,helpers,partials,data),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n    </div>\n    <div class=\"right\">\n        <input name=\"",(helper=helpers.uri)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.uri,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"\" value=\"",(helper=helpers.value)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.value,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"\">\n    </div>\n</div>",buffer});return factory}),define("ui/generis/widget/loader",["lodash","ui/generis/widget/checkBox/checkBox","ui/generis/widget/comboBox/comboBox","ui/generis/widget/hiddenBox/hiddenBox","ui/generis/widget/textBox/textBox"],function(_,checkBoxFactory,comboBoxFactory,hiddenBoxFactory,textBoxFactory){'use strict';function loader(uri){var factory;return factory=uri&&_.contains(Object.keys(_widgetFactories),uri)?_widgetFactories[uri]:_widgetFactories["http://www.tao.lu/datatypes/WidgetDefinitions.rdf#TextBox"],factory}_=_&&_.hasOwnProperty("default")?_["default"]:_,checkBoxFactory=checkBoxFactory&&checkBoxFactory.hasOwnProperty("default")?checkBoxFactory["default"]:checkBoxFactory,comboBoxFactory=comboBoxFactory&&comboBoxFactory.hasOwnProperty("default")?comboBoxFactory["default"]:comboBoxFactory,hiddenBoxFactory=hiddenBoxFactory&&hiddenBoxFactory.hasOwnProperty("default")?hiddenBoxFactory["default"]:hiddenBoxFactory,textBoxFactory=textBoxFactory&&textBoxFactory.hasOwnProperty("default")?textBoxFactory["default"]:textBoxFactory;var _widgetFactories={"http://www.tao.lu/datatypes/WidgetDefinitions.rdf#CheckBox":checkBoxFactory,"http://www.tao.lu/datatypes/WidgetDefinitions.rdf#ComboBox":comboBoxFactory,"http://www.tao.lu/datatypes/WidgetDefinitions.rdf#StateWidget":comboBoxFactory,"http://www.tao.lu/datatypes/WidgetDefinitions.rdf#HiddenBox":hiddenBoxFactory,"http://www.tao.lu/datatypes/WidgetDefinitions.rdf#TextBox":textBoxFactory};return loader}),define("css!ui/generis/form/css/form",[],function(){}),define("ui/generis/form/form",["lodash","i18n","ui/component","ui/generis/widget/loader","ui/generis/widget/checkBox/checkBox","ui/generis/widget/comboBox/comboBox","ui/generis/widget/hiddenBox/hiddenBox","ui/generis/widget/textBox/textBox","handlebars","lib/dompurify/purify","css!ui/generis/form/css/form.css"],function(_,__,componentFactory,widgetLoader,checkBox,comboBox,hiddenBox,textBox,Handlebars,DOMPurify){'use strict';function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)?function(obj){return _typeof2(obj)}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":_typeof2(obj)},_typeof(obj)}function Helpers0(hb){hb.registerHelper("__",function(key){return __(key)}),hb.registerHelper("dompurify",function(context){return DOMPurify.sanitize(context)}),hb.registerHelper("join",function(arr,keyValueGlue,fragmentGlue,wrapper){var fragments=[];return keyValueGlue="string"==typeof keyValueGlue?keyValueGlue:void 0,fragmentGlue="string"==typeof fragmentGlue?fragmentGlue:" ",wrapper="string"==typeof wrapper?wrapper:"\"",_.forIn(arr,function(value,key){var fragment="";null!==value||void 0!==value?"boolean"==typeof value?value=value?"true":"false":"object"===_typeof(value)&&(value=_.values(value).join(" ")):value="",void 0!==keyValueGlue&&(fragment+=key+keyValueGlue),fragment+=wrapper+value+wrapper,fragments.push(fragment)}),fragments.join(fragmentGlue)}),hb.registerHelper("for",function(startIndex,stopIndex,increment,options){var ret="";startIndex=parseInt(startIndex),stopIndex=parseInt(stopIndex),increment=parseInt(increment);for(var i=startIndex;i<stopIndex;i+=increment)ret+=options.fn(_.extend({},this,{i:i}));return ret}),hb.registerHelper("equal",function(var1,var2,options){return var1==var2?options.fn(this):options.inverse(this)}),hb.registerHelper("property",function(name,context){return context[name]||""}),hb.registerHelper("includes",function(haystack,needle,options){if(_.contains(haystack,needle))return options.fn(this)})}function tpl(data,options,asString){var html=Template(data,options);return asString||!0?html:$(html)}function factory(options,config){var form;return options=options||{},config=config||{},config.form=config.form||{},config.submit=config.submit||{},form=componentFactory({addWidget:function(widgetOptions){var widget=widgetLoader(widgetOptions.widget)({},widgetOptions);return this.widgets.push(widget),this.is("rendered")?widget.render(this.getElement().find("form > fieldset")):this.on("render."+widget.config.uri,function(){widget.render(this.getElement().find("form > fieldset")),this.off("render."+this.config.uri)}),this},getWidget:function(uri){return _.find(this.widgets,function(widget){return widget.config.uri===uri})},removeWidget:function(uri){return _.remove(this.widgets,function(widget){if(widget.config.uri===uri)return widget.destroy(),!0}),this},validate:function(){return this.errors=_(this.widgets).map(function(widget){return widget.validate(),{uri:widget.config.uri,errors:widget.validator.errors}}).reject(function(data){return!data.errors||0===data.errors.length}).value(),this},serializeArray:function(){return _.map(this.widgets,function(widget){return widget.serialize()})},getValues:function(){return _.reduce(this.serializeArray(),function(acc,field){return(_.isString(field.name)&&!_.isEmpty(field.name)&&_.isString(field.value)&&!_.isEmpty(field.value)||_.isArray(field.value)&&0<field.value.length)&&(acc[field.name]=field.value),acc},{})},toggleLoading:function(isLoading){return"undefined"==typeof isLoading&&(isLoading=!this.is("loading")),isLoading?(this.trigger("loading"),this.disable()):(this.trigger("loaded"),this.enable()),this.setState("loading",isLoading),this}},{formAction:"#",formMethod:"get",submitText:__("Save"),title:__("Generis Form"),reset:!0,resetText:__("Reset")}).setTemplate(tpl).init(config).on("render",function(){var $form=this.getElement().find("form"),self=this;$form.on("submit",function(e){return e.preventDefault(),self.trigger("submit",self.serializeArray()),!1}),$form.on("reset",function(){self.trigger("reset",self.serializeArray())})}),form.data=options,form.errors=[],form.widgets=[],_.each(options.properties||[],function(property){property.range&&"string"==typeof property.range&&(property.range=options.values[property.range]),form.addWidget(property)}),form}_=_&&_.hasOwnProperty("default")?_["default"]:_,__=__&&__.hasOwnProperty("default")?__["default"]:__,componentFactory=componentFactory&&componentFactory.hasOwnProperty("default")?componentFactory["default"]:componentFactory,widgetLoader=widgetLoader&&widgetLoader.hasOwnProperty("default")?widgetLoader["default"]:widgetLoader,Handlebars=Handlebars&&Handlebars.hasOwnProperty("default")?Handlebars["default"]:Handlebars,DOMPurify=DOMPurify&&DOMPurify.hasOwnProperty("default")?DOMPurify["default"]:DOMPurify,Helpers0.__initialized||(Helpers0(Handlebars),Helpers0.__initialized=!0);var Template=Handlebars.template(function(Handlebars,depth0,helpers,partials,data){function program1(depth0,data){var buffer="",stack1,helper;return buffer+="\n            <button type=\"reset\" class=\"btn-neutral small\">\n                <span class=\"icon-reset\"/> ",(helper=helpers.resetText)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.resetText,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"\n            </button>\n            ",buffer}this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var buffer="",escapeExpression=this.escapeExpression,self=this,stack1,helper;return buffer+="<div class=\"ui-generis-form\">\n    <h2>",(helper=helpers.title)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.title,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"</h2>\n    <form action=\"",(helper=helpers.formAction)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.formAction,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"\" method=\"",(helper=helpers.formMethod)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.formMethod,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"\">\n        <fieldset></fieldset>\n        <div class=\"toolbar\">\n            ",stack1=helpers["if"].call(depth0,depth0&&depth0.reset,{hash:{},inverse:self.noop,fn:self.program(1,program1,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n            <button type=\"submit\" class=\"btn-info small\">\n                <span class=\"icon-save\"/> ",(helper=helpers.submitText)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.submitText,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"\n            </button>\n        </div>\n    </form>\n</div>\n",buffer});return factory}),define("ui/resource/filters",["lodash","i18n","ui/component","ui/generis/form/form","handlebars","lib/dompurify/purify"],function(_,__,component,generisFormFactory,Handlebars,DOMPurify){'use strict';function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)?function(obj){return _typeof2(obj)}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":_typeof2(obj)},_typeof(obj)}function Helpers0(hb){hb.registerHelper("__",function(key){return __(key)}),hb.registerHelper("dompurify",function(context){return DOMPurify.sanitize(context)}),hb.registerHelper("join",function(arr,keyValueGlue,fragmentGlue,wrapper){var fragments=[];return keyValueGlue="string"==typeof keyValueGlue?keyValueGlue:void 0,fragmentGlue="string"==typeof fragmentGlue?fragmentGlue:" ",wrapper="string"==typeof wrapper?wrapper:"\"",_.forIn(arr,function(value,key){var fragment="";null!==value||void 0!==value?"boolean"==typeof value?value=value?"true":"false":"object"===_typeof(value)&&(value=_.values(value).join(" ")):value="",void 0!==keyValueGlue&&(fragment+=key+keyValueGlue),fragment+=wrapper+value+wrapper,fragments.push(fragment)}),fragments.join(fragmentGlue)}),hb.registerHelper("for",function(startIndex,stopIndex,increment,options){var ret="";startIndex=parseInt(startIndex),stopIndex=parseInt(stopIndex),increment=parseInt(increment);for(var i=startIndex;i<stopIndex;i+=increment)ret+=options.fn(_.extend({},this,{i:i}));return ret}),hb.registerHelper("equal",function(var1,var2,options){return var1==var2?options.fn(this):options.inverse(this)}),hb.registerHelper("property",function(name,context){return context[name]||""}),hb.registerHelper("includes",function(haystack,needle,options){if(_.contains(haystack,needle))return options.fn(this)})}function filtersTpl(data,options,asString){var html=Template(data,options);return asString||!0?html:$(html)}function filtersFactory($container,config){var filters=component({getValues:function(){return this.is("rendered")&&this.form?this.form.getValues():null},setValue:function(uri,value){var widget;return this.is("rendered")&&this.form&&(widget=this.form.getWidget(uri),widget&&widget.set(value)),this},reset:function(){return this.update(this.config.data)},update:function(data){var self=this,properties;return this.is("rendered")&&(this.getElement().empty(),properties=_.filter(data.properties,function(property){return _.contains(supportedWidgets,property.widget)}),this.form=generisFormFactory({properties:properties,values:data.ranges},{submitText:this.config.applyLabel,title:this.config.title}).on("submit reset",function(){self.trigger("change",this.getValues())}).render(this.getElement())),this},getTextualQuery:function(){var self=this,result;return this.is("rendered")&&(result=_.reduce(this.form.getValues(),function(acc,value,uri){var widget=self.form.getWidget(uri),displayValue;return widget&&(!_.isEmpty(acc)&&(acc+=__(" AND ")),acc+=widget.config.label+__(" is "),displayValue=widget.config.range?_.map(_.isArray(value)?value:[value],function(val){var selectedValue=_.find(widget.config.range,{uri:val});return selectedValue&&selectedValue.label}):value,_.isString(displayValue)&&(acc+=displayValue),_.isArray(displayValue)&&(acc+=displayValue.join(", "))),acc},"")),result}},defaultConfig);return filters.setTemplate(filtersTpl).on("init",function(){this.render($container)}).on("render",function(){this.config.data&&this.update(this.config.data)}),_.defer(function(){filters.init(config)}),filters}_=_&&_.hasOwnProperty("default")?_["default"]:_,__=__&&__.hasOwnProperty("default")?__["default"]:__,component=component&&component.hasOwnProperty("default")?component["default"]:component,generisFormFactory=generisFormFactory&&generisFormFactory.hasOwnProperty("default")?generisFormFactory["default"]:generisFormFactory,Handlebars=Handlebars&&Handlebars.hasOwnProperty("default")?Handlebars["default"]:Handlebars,DOMPurify=DOMPurify&&DOMPurify.hasOwnProperty("default")?DOMPurify["default"]:DOMPurify,Helpers0.__initialized||(Helpers0(Handlebars),Helpers0.__initialized=!0);var Template=Handlebars.template(function(Handlebars,depth0,helpers){return this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),"<div class=\"filters\">\n</div>\n"}),supportedWidgets=["http://www.tao.lu/datatypes/WidgetDefinitions.rdf#TextBox","http://www.tao.lu/datatypes/WidgetDefinitions.rdf#CheckBox","http://www.tao.lu/datatypes/WidgetDefinitions.rdf#ComboBox","http://www.tao.lu/datatypes/WidgetDefinitions.rdf#TextArea","http://www.tao.lu/datatypes/WidgetDefinitions.rdf#StateWidget"],defaultConfig={title:__("Search by properties"),applyLabel:__("Apply")};return filtersFactory}),define("css!ui/resource/css/selector",[],function(){}),define("ui/resource/selector",["jquery","lodash","i18n","ui/component","ui/hider","ui/class/selector","ui/resource/tree","ui/resource/list","ui/resource/filters","handlebars","lib/dompurify/purify","css!ui/resource/css/selector.css"],function($$1,_,__,component,hider,classesSelectorFactory,treeFactory,listFactory,filtersFactory,Handlebars,DOMPurify){'use strict';function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)?function(obj){return _typeof2(obj)}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":_typeof2(obj)},_typeof(obj)}function Helpers0(hb){hb.registerHelper("__",function(key){return __(key)}),hb.registerHelper("dompurify",function(context){return DOMPurify.sanitize(context)}),hb.registerHelper("join",function(arr,keyValueGlue,fragmentGlue,wrapper){var fragments=[];return keyValueGlue="string"==typeof keyValueGlue?keyValueGlue:void 0,fragmentGlue="string"==typeof fragmentGlue?fragmentGlue:" ",wrapper="string"==typeof wrapper?wrapper:"\"",_.forIn(arr,function(value,key){var fragment="";null!==value||void 0!==value?"boolean"==typeof value?value=value?"true":"false":"object"===_typeof(value)&&(value=_.values(value).join(" ")):value="",void 0!==keyValueGlue&&(fragment+=key+keyValueGlue),fragment+=wrapper+value+wrapper,fragments.push(fragment)}),fragments.join(fragmentGlue)}),hb.registerHelper("for",function(startIndex,stopIndex,increment,options){var ret="";startIndex=parseInt(startIndex),stopIndex=parseInt(stopIndex),increment=parseInt(increment);for(var i=startIndex;i<stopIndex;i+=increment)ret+=options.fn(_.extend({},this,{i:i}));return ret}),hb.registerHelper("equal",function(var1,var2,options){return var1==var2?options.fn(this):options.inverse(this)}),hb.registerHelper("property",function(name,context){return context[name]||""}),hb.registerHelper("includes",function(haystack,needle,options){if(_.contains(haystack,needle))return options.fn(this)})}function selectorTpl(data,options,asString){var html=Template(data,options);return asString||!0?html:$(html)}$$1=$$1&&$$1.hasOwnProperty("default")?$$1["default"]:$$1,_=_&&_.hasOwnProperty("default")?_["default"]:_,__=__&&__.hasOwnProperty("default")?__["default"]:__,component=component&&component.hasOwnProperty("default")?component["default"]:component,hider=hider&&hider.hasOwnProperty("default")?hider["default"]:hider,classesSelectorFactory=classesSelectorFactory&&classesSelectorFactory.hasOwnProperty("default")?classesSelectorFactory["default"]:classesSelectorFactory,treeFactory=treeFactory&&treeFactory.hasOwnProperty("default")?treeFactory["default"]:treeFactory,listFactory=listFactory&&listFactory.hasOwnProperty("default")?listFactory["default"]:listFactory,filtersFactory=filtersFactory&&filtersFactory.hasOwnProperty("default")?filtersFactory["default"]:filtersFactory,Handlebars=Handlebars&&Handlebars.hasOwnProperty("default")?Handlebars["default"]:Handlebars,DOMPurify=DOMPurify&&DOMPurify.hasOwnProperty("default")?DOMPurify["default"]:DOMPurify,Helpers0.__initialized||(Helpers0(Handlebars),Helpers0.__initialized=!0);var Template=Handlebars.template(function(Handlebars,depth0,helpers,partials,data){function program3(depth0,data){var buffer="",stack1;return buffer+="\n    <nav class=\"context\">\n        <div class=\"class-context\"></div>\n        ",stack1=helpers.each.call(depth0,depth0&&depth0.formats,{hash:{},inverse:self.noop,fn:self.program(4,program4,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n    </nav>\n    ",buffer}function program4(depth0,data){var buffer="",stack1,helper;return buffer+="\n        <a href=\"#\" data-view-format=\""+escapeExpression((stack1=null==data||!1===data?data:data.key,"function"===_typeof2(stack1)?stack1.apply(depth0):stack1))+"\" ",stack1=helpers["if"].call(depth0,depth0&&depth0.active,{hash:{},inverse:self.noop,fn:self.program(5,program5,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+=" ",stack1=helpers["if"].call(depth0,depth0&&depth0.title,{hash:{},inverse:self.noop,fn:self.program(7,program7,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="><span class=\"",(helper=helpers.icon)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.icon,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"\"></span></a>\n        ",buffer}function program5(){return"class=\"active\""}function program7(depth0,data){var buffer="",stack1,helper;return buffer+="title=\"",(helper=helpers.title)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.title,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"\"",buffer}function program9(depth0,data){var buffer="",stack1,helper,options;return buffer+="\n    <nav class=\"selection\">\n        <div class=\"search\">\n            <input type=\"text\" placeholder=\"",(helper=helpers.searchPlaceholder)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.searchPlaceholder,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"\" />\n            ",stack1=helpers["if"].call(depth0,depth0&&depth0.filters,{hash:{},inverse:self.noop,fn:self.program(10,program10,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n        </div>\n        <div class=\"selection-control\">\n            <a href=\"#\" class=\"selection-toggle ",stack1=helpers.unless.call(depth0,depth0&&depth0.switchMode,{hash:{},inverse:self.noop,fn:self.program(12,program12,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\" title=\""+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"Toggle multiple/single selection",options):helperMissing.call(depth0,"__","Toggle multiple/single selection",options)))+"\">\n                <span class=\"icon-multi-select\"></span>\n            </a>\n            <label class=\"selection-indicator ",stack1=helpers.unless.call(depth0,depth0&&depth0.multiple,{hash:{},inverse:self.noop,fn:self.program(12,program12,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\">\n                <input type=\"checkbox\">\n                <span class=\"icon-checkbox\"></span>\n            </label>\n        </div>\n        ",stack1=helpers["if"].call(depth0,depth0&&depth0.filters,{hash:{},inverse:self.noop,fn:self.program(14,program14,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n    </nav>\n    ",buffer}function program10(depth0,data){var buffer="",helper,options;return buffer+="\n            <a href=\"#\" class=\"filters-opener\" title=\""+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"Advanced search, add filters",options):helperMissing.call(depth0,"__","Advanced search, add filters",options)))+"\"><span class=\"icon-add\"></span></a>\n            ",buffer}function program12(){return"hidden"}function program14(){return"\n        <div class=\"filters-container folded\"></div>\n        "}function program16(depth0,data){var buffer="",stack1,helper,options;return buffer+="\n    <footer>\n        <div class=\"get-selection\">\n           <span>"+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"Selected",options):helperMissing.call(depth0,"__","Selected",options)))+" ",(helper=helpers.type)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.type,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+" : </span><span class=\"selected-num\">0</span>\n        </div>\n    </footer>\n    ",buffer}this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var buffer="",escapeExpression=this.escapeExpression,self=this,helperMissing=helpers.helperMissing,stack1,helper;return buffer+="<div class=\"resource-selector ",stack1=helpers["if"].call(depth0,depth0&&depth0.multiple,{hash:{},inverse:self.noop,fn:self.program(1,function(){return"multiple"},data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\">\n\n    ",stack1=helpers["if"].call(depth0,depth0&&depth0.showContext,{hash:{},inverse:self.noop,fn:self.program(3,program3,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n\n    ",stack1=helpers["if"].call(depth0,depth0&&depth0.showSelection,{hash:{},inverse:self.noop,fn:self.program(9,program9,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n\n    <main>\n        <span class=\"hidden no-results\">",(helper=helpers.noResultsText)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.noResultsText,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"</span>\n    </main>\n\n    ",stack1=helpers["if"].call(depth0,depth0&&depth0.multiple,{hash:{},inverse:self.noop,fn:self.program(16,program16,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n</div>\n",buffer}),labelUri="http://www.w3.org/2000/01/rdf-schema#label",nodeTypes={instance:"instance",class:"class"},selectionModes={single:"single",multiple:"multiple",both:"both"},selectAllPolicies={all:"all",loaded:"loaded",visible:"visible"},defaultConfig={type:__("resources"),noResultsText:_("No resources found"),searchPlaceholder:__("Search"),icon:"item",selectionMode:selectionModes.single,selectClass:!1,selectAllPolicy:selectAllPolicies.loaded,filters:!1,showContext:!0,showSelection:!0,formats:{list:{icon:"icon-ul",title:__("View resources as a list"),componentFactory:listFactory},tree:{icon:"icon-tree",title:__("View resources as a tree"),componentFactory:treeFactory,active:!0}},limit:30},filterClasses=function filterClasses(resources){return _(resources).filter({type:nodeTypes.class}).map(function(resource){var classNode=_.pick(resource,["uri","label","state"]);return resource.children&&(classNode.children=filterClasses(resource.children)),classNode}).value()},resourceSelectorFactory=function($container,config){var resourceSelector=component({empty:function(){return this.is("rendered")&&this.selectionComponent&&(this.selectionComponent.destroy(),this.selectionComponent=null),this.trigger("empty")},reset:function(){return this.is("rendered")&&(this.empty(),this.searchQuery={},this.config.filters&&(this.filtersComponent&&this.filtersComponent.reset(),$searchField.val("").attr("title",null).attr("placeholder",this.config.searchPlaceholder))),this.trigger("reset")},getSelection:function(){return this.selectionComponent?this.selectionComponent.getSelection():null},clearSelection:function(){return this.selectionComponent&&this.selectionComponent.clearSelection(),this},setSearchQuery:function(query){return this.searchQuery={},this.searchQuery[labelUri]="",_.isString(query)&&!_.isEmpty(query)&&(this.searchQuery[labelUri]=query),_.isPlainObject(query)&&(this.searchQuery=query),this},getSearchQuery:function(){return 0===_.size(this.searchQuery)&&(this.searchQuery[labelUri]=""),this.searchQuery},query:function(params){var defaultParams,search;return this.is("rendered")&&!this.is("loading")&&(this.setState("loading",!0),params=params||{},search=this.getSearchQuery(),defaultParams={classUri:this.classUri,format:this.format,limit:this.config.limit,search:_.isObject(search)?JSON.stringify(search):""},this.trigger("query",_.defaults(params,defaultParams))),this},changeFormat:function(format){var $viewFormat;return this.is("rendered")&&this.format!==format&&($viewFormat=$viewFormats.filter("[data-view-format=\""+format+"\"]"),1===$viewFormat.length&&!$viewFormat.hasClass("active")&&($viewFormats.removeClass("active"),$viewFormat.addClass("active"),this.empty(),this.format=format,this.trigger("formatchange",format))),this},changeSelectionMode:function(newMode){return this.is("rendered")&&this.config.selectionMode!==newMode&&selectionModes[newMode]&&(this.config.multiple&&this.clearSelection(),this.config.multiple=newMode===selectionModes.multiple,this.selectionComponent.setState("multiple",this.config.multiple),this.setState("multiple",this.config.multiple),this.config.multiple?hider.show($selectCtrlLabel):hider.hide($selectCtrlLabel),this.trigger("selectionmodechange",newMode)),this},update:function(resources,params){var self=this,componentFactory;if(this.is("rendered")&&this.format){if(componentFactory=this.config.formats[this.format]&&this.config.formats[this.format].componentFactory,!_.isFunction(componentFactory))return this.trigger("error",new TypeError("Unable to load the component for the format "+this.format));hider.hide($noResults),params.updateClasses&&this.classSelector&&this.classSelector.updateNodes(filterClasses(resources)),this.selectionComponent?this.selectionComponent.update(resources,params):this.selectionComponent=componentFactory($resultArea,_.defaults({classUri:this.classUri,nodes:resources},this.config)).on("query",function(queryParams){self.query(queryParams)}).on("update",function(){0===_.size(this.getNodes())&&0===$$1("li",$resultArea).length&&hider.show($noResults),self.trigger("update")}).on("change",function(selected,onlyVisible){self.trigger("change",selected,onlyVisible)}).on("error",function(err){self.trigger("error",err)}),this.setState("loading",!1)}return this},updateFilters:function(filterConfig){return this.is("rendered")&&!1!==filterConfig&&this.filtersComponent&&this.filtersComponent.update(filterConfig),this},removeNode:function(node){var uri=_.isString(node)?node:node.uri;return this.hasNode(uri)&&(this.getNodeType(node)===nodeTypes.class&&this.classSelector&&this.classSelector.removeNode(node),this.selectionComponent.removeNode(uri)),this},addNode:function(node,parentUri){return this.is("rendered")&&node&&node.uri&&this.selectionComponent&&!this.selectionComponent.hasNode(node.uri)&&(!node.type&&(node.type=nodeTypes.instance),this.selectionComponent.update([node],{classUri:parentUri||this.classUri,format:this.format,limit:this.config.limit,updateCount:node.type===nodeTypes.instance&&1}),this.getNodeType(node)===nodeTypes.class&&this.classSelector&&this.classSelector.addNode(node,parentUri)),this},hasNode:function(node){var uri;return!!(node&&this.is("rendered")&&this.selectionComponent)&&(uri=_.isString(node)?node:node.uri,this.selectionComponent.hasNode(uri))},getNodeType:function(node){var uri,foundNode;return!!(node&&this.is("rendered")&&this.selectionComponent)&&(uri=_.isString(node)?node:node.uri,foundNode=this.selectionComponent.getNode(uri),foundNode&&foundNode.type)},select:function(node){var uri=_.isString(node)?node:node.uri;return this.hasNode(uri)&&(!this.is("multiple")&&this.selectionComponent.clearSelection(),this.selectionComponent.select(uri),$$1("[data-uri=\""+uri+"\"]",$resultArea)[0].scrollIntoView({behavior:"smooth"})),this},selectDefaultNode:function(node,fallback){var $resource;return this.is("rendered")&&(this.hasNode(node)?this.select(node):!1!==fallback&&($resource=this.getElement().find("."+nodeTypes.instance),!$resource.length&&($resource=this.getElement().find("."+nodeTypes.class)),$resource.length&&this.select($resource.first().data("uri")))),this},refresh:function(node){var queryParams={updateClasses:!0};return this.is("rendered")&&(this.on("update.refresh",function(){this.off("update.refresh"),this.selectDefaultNode(node)}),node&&node.uri&&(queryParams.selectedUri=node.uri),this.reset().query(queryParams)),this}},defaultConfig).setTemplate(selectorTpl).on("init",function(){this.searchQuery={},this.classUri=this.config.classUri,this.format=this.config.format||_.findKey(this.config.formats,{active:!0}),this.config.switchMode=this.config.selectionMode===selectionModes.both,this.config.multiple=this.config.selectionMode===selectionModes.multiple,this.setState("multiple",this.config.multiple),this.render($container)}).on("render",function(){var self=this;return new Promise(function(resolve){var $component=self.getElement();$classContainer=$$1(".class-context",$component),$resultArea=$$1("main",$component),$noResults=$$1(".no-results",$resultArea),$searchField=$$1(".search input",$component),$filterToggle=$$1(".filters-opener",$component),$filterContainer=$$1(".filters-container",$component),$viewFormats=$$1(".context > a",$component),$selectNum=$$1(".selected-num",$component),$selectCtrl=$$1(".selection-control input",$component),$selectCtrlLabel=$$1(".selection-control label",$component),$selectionToggle=$$1(".selection-toggle",$component),$searchField.on("keyup",_.debounce(function(e){var value=$$1(this).val().trim();(2<value.length||0===value.length||13===e.which)&&(self.config.filters&&$$1(this).attr("title",null).attr("placeholder",self.config.searchPlaceholder),self.empty().changeFormat("list").setSearchQuery(value).query())},300)),$viewFormats.on("click",function(e){var $target=$$1(this),format=$target.data("view-format");e.preventDefault(),self.reset().changeFormat(format).query()}),self.config.selectionMode===selectionModes.both&&($selectionToggle.on("click",function(e){e.preventDefault(),self.changeSelectionMode(self.config.multiple?selectionModes.single:selectionModes.multiple)}),$resultArea.on("mousedown",function(e){e.ctrlKey&&!self.config.multiple&&self.changeSelectionMode(selectionModes.multiple)}),$resultArea.on("click",function(){self.changeSelectionMode(selectionModes.single)})),$selectCtrl.on("change",function(){!1===$$1(this).prop("checked")?self.selectionComponent.clearSelection():self.config.selectAllPolicy===selectAllPolicies.visible?self.selectionComponent.selectVisible():self.config.selectAllPolicy===selectAllPolicies.loaded&&self.selectionComponent.selectAll()}),!1!==self.config.filters&&(self.filtersComponent=filtersFactory($filterContainer,{classUri:self.classUri,data:self.config.filters}).on("change",function(values){var textualQuery=this.getTextualQuery();$searchField.val("").attr("title",textualQuery).attr("placeholder",textualQuery),self.empty().changeFormat("list").setSearchQuery(values).query(),$filterContainer.addClass("folded")}),$filterToggle.on("click",function(e){var searchVal;e.preventDefault(),$filterContainer.hasClass("folded")?(searchVal=$searchField.val().trim(),!_.isEmpty(searchVal)&&self.filtersComponent.setValue(labelUri,searchVal),$filterContainer.removeClass("folded")):$filterContainer.addClass("folded")})),self.classSelector=classesSelectorFactory($classContainer,self.config),self.classSelector.on("render",resolve).on("change",function(uri){uri&&uri!==self.classUri&&(self.classUri=uri,$filterContainer.length&&$filterContainer.addClass("folded"),self.trigger("classchange",uri),self.reset().query())}),self.query()})}).on("change",function(selected,onlyVisible){var selectedCount=_.size(selected),nodesCount=onlyVisible?selectedCount:_.size(this.selectionComponent.getNodes());$selectNum.text(selectedCount),0===selectedCount?($selectCtrlLabel.attr("title",__("Select loaded %s",this.config.type)),$selectCtrl.prop("checked",!1).prop("indeterminate",!1)):selectedCount>=nodesCount?($selectCtrlLabel.attr("title",__("Clear selection")),$selectCtrl.prop("checked",!0).prop("indeterminate",!1)):($selectCtrlLabel.attr("title",__("Select loaded %s",this.config.type)),$selectCtrl.prop("checked",!1).prop("indeterminate",!0))}),$classContainer,$resultArea,$noResults,$searchField,$viewFormats,$selectNum,$selectCtrl,$selectCtrlLabel,$filterToggle,$filterContainer,$selectionToggle;return _.defer(function(){resourceSelector.init(config)}),resourceSelector};return resourceSelectorFactory.selectionModes=selectionModes,resourceSelectorFactory.selectAllPolicies=selectAllPolicies,resourceSelectorFactory.nodeTypes=nodeTypes,resourceSelectorFactory}),define("css!ui/loadingButton/css/button",[],function(){}),define("ui/loadingButton/loadingButton",["lodash","ui/component","handlebars","i18n","lib/dompurify/purify","css!ui/loadingButton/css/button.css"],function(_,component,Handlebars,__,DOMPurify){'use strict';function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)?function(obj){return _typeof2(obj)}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":_typeof2(obj)},_typeof(obj)}function Helpers0(hb){hb.registerHelper("__",function(key){return __(key)}),hb.registerHelper("dompurify",function(context){return DOMPurify.sanitize(context)}),hb.registerHelper("join",function(arr,keyValueGlue,fragmentGlue,wrapper){var fragments=[];return keyValueGlue="string"==typeof keyValueGlue?keyValueGlue:void 0,fragmentGlue="string"==typeof fragmentGlue?fragmentGlue:" ",wrapper="string"==typeof wrapper?wrapper:"\"",_.forIn(arr,function(value,key){var fragment="";null!==value||void 0!==value?"boolean"==typeof value?value=value?"true":"false":"object"===_typeof(value)&&(value=_.values(value).join(" ")):value="",void 0!==keyValueGlue&&(fragment+=key+keyValueGlue),fragment+=wrapper+value+wrapper,fragments.push(fragment)}),fragments.join(fragmentGlue)}),hb.registerHelper("for",function(startIndex,stopIndex,increment,options){var ret="";startIndex=parseInt(startIndex),stopIndex=parseInt(stopIndex),increment=parseInt(increment);for(var i=startIndex;i<stopIndex;i+=increment)ret+=options.fn(_.extend({},this,{i:i}));return ret}),hb.registerHelper("equal",function(var1,var2,options){return var1==var2?options.fn(this):options.inverse(this)}),hb.registerHelper("property",function(name,context){return context[name]||""}),hb.registerHelper("includes",function(haystack,needle,options){if(_.contains(haystack,needle))return options.fn(this)})}function buttonTpl(data,options,asString){var html=Template(data,options);return asString||!0?html:$(html)}function loadingButtonFactory(config){var initConfig=_.defaults(config||{},_defaults);return component(buttonApi).setTemplate(buttonTpl).on("enable",function(){this.getElement().removeProp("disabled")}).on("disable",function(){this.getElement().prop("disabled",!0)}).on("render",function(){var self=this;this.getElement().on("click",function(e){e.preventDefault(),self.is("disabled")||self.is("started")||self.is("terminated")||self.start()})}).init(initConfig)}_=_&&_.hasOwnProperty("default")?_["default"]:_,component=component&&component.hasOwnProperty("default")?component["default"]:component,Handlebars=Handlebars&&Handlebars.hasOwnProperty("default")?Handlebars["default"]:Handlebars,__=__&&__.hasOwnProperty("default")?__["default"]:__,DOMPurify=DOMPurify&&DOMPurify.hasOwnProperty("default")?DOMPurify["default"]:DOMPurify,Helpers0.__initialized||(Helpers0(Handlebars),Helpers0.__initialized=!0);var Template=Handlebars.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var buffer="",escapeExpression=this.escapeExpression,stack1,helper;return buffer+="<button class=\"loading-button btn-",(helper=helpers.type)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.type,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+" small\" type=\"button\" title=\"",(helper=helpers.title)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.title,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"\">\n    <span class=\"spinner-icon icon-loop spinning\"></span>\n    <span class=\"start-icon icon-",(helper=helpers.icon)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.icon,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"\"></span>\n    <span class=\"action-label\">",(helper=helpers.label)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.label,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"</span>\n    <span class=\"terminated-label\">",(helper=helpers.terminatedLabel)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.terminatedLabel,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"</span>\n</button>",buffer}),_defaults={type:"info",icon:"property-advanced",title:"",label:"OK",terminatedLabel:"FINISHED"},buttonApi={start:function(){this.setState("started",!0),this.trigger("started")},terminate:function(){return this.is("started")&&(this.setState("started",!1),this.setState("terminated",!0),this.disable(),this.trigger("terminated")),this},reset:function(){return this.is("terminated")&&(this.setState("terminated",!1),this.enable(),this.trigger("reset")),this}};return loadingButtonFactory}),define("ui/report",["jquery","lodash","ui/component","handlebars","i18n","lib/dompurify/purify"],function($$1,_,component,Handlebars,__,DOMPurify){'use strict';function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)?function(obj){return _typeof2(obj)}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":_typeof2(obj)},_typeof(obj)}function Helpers0(hb){hb.registerHelper("__",function(key){return __(key)}),hb.registerHelper("dompurify",function(context){return DOMPurify.sanitize(context)}),hb.registerHelper("join",function(arr,keyValueGlue,fragmentGlue,wrapper){var fragments=[];return keyValueGlue="string"==typeof keyValueGlue?keyValueGlue:void 0,fragmentGlue="string"==typeof fragmentGlue?fragmentGlue:" ",wrapper="string"==typeof wrapper?wrapper:"\"",_.forIn(arr,function(value,key){var fragment="";null!==value||void 0!==value?"boolean"==typeof value?value=value?"true":"false":"object"===_typeof(value)&&(value=_.values(value).join(" ")):value="",void 0!==keyValueGlue&&(fragment+=key+keyValueGlue),fragment+=wrapper+value+wrapper,fragments.push(fragment)}),fragments.join(fragmentGlue)}),hb.registerHelper("for",function(startIndex,stopIndex,increment,options){var ret="";startIndex=parseInt(startIndex),stopIndex=parseInt(stopIndex),increment=parseInt(increment);for(var i=startIndex;i<stopIndex;i+=increment)ret+=options.fn(_.extend({},this,{i:i}));return ret}),hb.registerHelper("equal",function(var1,var2,options){return var1==var2?options.fn(this):options.inverse(this)}),hb.registerHelper("property",function(name,context){return context[name]||""}),hb.registerHelper("includes",function(haystack,needle,options){if(_.contains(haystack,needle))return options.fn(this)})}function layoutTpl(data,options,asString){var html=Template(data,options);return asString||!0?html:$(html)}function feedbackTpl(data,options,asString){var html=Template$1(data,options);return asString||!0?html:$(html)}$$1=$$1&&$$1.hasOwnProperty("default")?$$1["default"]:$$1,_=_&&_.hasOwnProperty("default")?_["default"]:_,component=component&&component.hasOwnProperty("default")?component["default"]:component,Handlebars=Handlebars&&Handlebars.hasOwnProperty("default")?Handlebars["default"]:Handlebars,__=__&&__.hasOwnProperty("default")?__["default"]:__,DOMPurify=DOMPurify&&DOMPurify.hasOwnProperty("default")?DOMPurify["default"]:DOMPurify,Helpers0.__initialized||(Helpers0(Handlebars),Helpers0.__initialized=!0);var Template=Handlebars.template(function(Handlebars,depth0,helpers,partials,data){function program3(depth0,data){var buffer="",helper,options;return buffer+="\n    <label class=\"fold pseudo-label-box\">\n        <span class=\"check-txt hide\">"+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"Hide detailed report",options):helperMissing.call(depth0,"__","Hide detailed report",options)))+"</span>\n        <span class=\"check-txt show\">"+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"Show detailed report",options):helperMissing.call(depth0,"__","Show detailed report",options)))+"</span>\n        <input type=\"checkbox\"/>\n        <span class=\"icon-checkbox\"></span>\n    </label>\n    ",buffer}this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var buffer="",helperMissing=helpers.helperMissing,escapeExpression=this.escapeExpression,self=this,stack1,helper;return buffer+="<div class=\"component-report",stack1=helpers["if"].call(depth0,depth0&&depth0.noBorder,{hash:{},inverse:self.noop,fn:self.program(1,function(){return" no-border"},data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\">\n    ",stack1=helpers["if"].call(depth0,depth0&&depth0.detailsButtonVisible,{hash:{},inverse:self.noop,fn:self.program(3,program3,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n    <div class=\"content\">",(helper=helpers.content)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.content,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"</div>\n</div>",buffer});Helpers0.__initialized||(Helpers0(Handlebars),Helpers0.__initialized=!0);var Template$1=Handlebars.template(function(Handlebars,depth0,helpers,partials,data){function program7(depth0){var buffer="",stack1;return buffer+="\n        ",stack1="function"===_typeof2(depth0)?depth0.apply(depth0):depth0,(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n    ",buffer}function program9(depth0,data){var buffer="",stack1,helper;return buffer+="\n        <button data-trigger=\"",(helper=helpers.id)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.id,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"\" class=\"action btn-info\" title=\"",(helper=helpers.title)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.title,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"\"><span class=\"icon-",(helper=helpers.icon)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.icon,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"\"></span>",(helper=helpers.label)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.label,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"</button>\n        ",buffer}this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var buffer="",escapeExpression=this.escapeExpression,self=this,helperMissing=helpers.helperMissing,stack1,helper,options;return buffer+="<div class=\"feedback-",(helper=helpers.type)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.type,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+" ",stack1=helpers["if"].call(depth0,depth0&&depth0.hasChildren,{hash:{},inverse:self.program(3,function(){return"leaf"},data),fn:self.program(1,function(){return"hierarchical"},data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\">\n    <span class=\"icon-",(helper=helpers.type)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.type,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1),stack1=helpers["if"].call(depth0,depth0&&depth0.hasChildren,{hash:{},inverse:self.noop,fn:self.program(5,function(){return" hierarchical-icon"},data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\"></span>\n    <div class=\"message\">",stack1=(helper=helpers.dompurify||depth0&&depth0.dompurify,options={hash:{},data:data},helper?helper.call(depth0,depth0&&depth0.message,options):helperMissing.call(depth0,"dompurify",depth0&&depth0.message,options)),(stack1||0===stack1)&&(buffer+=stack1),buffer+="</div>\n    ",stack1=helpers.each.call(depth0,depth0&&depth0.children,{hash:{},inverse:self.noop,fn:self.program(7,program7,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n    <div class=\"actions\">\n        ",stack1=helpers.each.call(depth0,depth0&&depth0.actions,{hash:{},inverse:self.noop,fn:self.program(9,program9,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n    </div>\n</div>",buffer}),_defaults={showDetailsButton:!0,actions:[]},authorizedTypes=["success","info","warning","error"],_renderFeebacks=function _renderFeebacks(data,actions){var children=[];if(!data.type||-1===authorizedTypes.indexOf(data.type))throw new TypeError("Unkown report type: "+data.type);return _.isArray(data.children)&&data.children.length&&_.each(data.children,function(child){children.push(_renderFeebacks(child))}),data.hasChildren=0<children.length,data.children=children,data.actions=actions,feedbackTpl(data)},report={isDetailed:function(){return this.is("detailed")},showDetails:function(){return this.is("rendered")&&(this.setState("detailed",!0),this.getElement().find(".fold input").prop("checked",!0),this.trigger("showDetails")),this},hideDetails:function(){return this.is("rendered")&&(this.setState("detailed"),this.getElement().find(".fold input").prop("checked",!1),this.trigger("hideDetails")),this}},reportComponentFactory=function(config,data){var initConfig=_.defaults(config||{},_defaults);return data&&_.isArray(data.children)&&data.children.length&&(initConfig.detailsButtonVisible=initConfig.showDetailsButton),component(report).setTemplate(layoutTpl).on("render",function(){var self=this,$content=this.getElement().find(".content"),$checkbox=this.getElement().find(".fold input");$content.append(_renderFeebacks(_.cloneDeep(data),this.config.actions)),$content.on("click",".action",function(){var actionId=$$1(this).data("trigger");self.trigger("action-"+actionId),self.trigger("action",actionId)}),$checkbox.on("change",_.throttle(function(){self.isDetailed()?self.hideDetails():self.showDetails()},100))}).init(initConfig)};return reportComponentFactory}),define("util/regexEscape",[],function(){'use strict';return function(s){return s.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}}),define("util/wrapLongWords",["util/regexEscape"],function(regexEscape){'use strict';function wrapLongWords(str,threshold){str=str.toString().replace(/([\w])</g,"$1 <");for(var chunkExp=new RegExp(".{1,"+threshold+"}","g"),longWords=str.match(new RegExp("[\\S]{"+threshold+",}","g"))||[],i=longWords.length,cut;i--;)cut=getCutTerm(longWords[i],chunkExp),str=str.replace(new RegExp(regexEscape(longWords[i]),"g"),cut);return str}regexEscape=regexEscape&&regexEscape.hasOwnProperty("default")?regexEscape["default"]:regexEscape;var getCutTerm=function(longWord,chunkExp){for(var cutTerms=longWord.match(chunkExp),i=cutTerms.length,oldFirst="",newFirst="",offenders=[".",":",";"];i--;)newFirst=cutTerms[i].charAt(0),-1<offenders.indexOf(newFirst)&&(cutTerms[i]=cutTerms[i].substr(1)),-1<offenders.indexOf(oldFirst)&&(cutTerms[i]+=oldFirst),oldFirst=newFirst;return cutTerms.join(" ")};return wrapLongWords}),define("util/encode",[],function(){'use strict';var _reQuot=/"/g,_reApos=/'/g,encodeHTML=function(html){return document.createElement("a").appendChild(document.createTextNode(html)).parentNode.innerHTML};return{html:encodeHTML,attribute:function(html){return encodeHTML(html).replace(_reQuot,"&quot;").replace(_reApos,"&apos;")},encodeBase64:function(str){return btoa(encodeURIComponent(str).replace(/%([0-9A-F]{2})/g,function(match,p1){return String.fromCharCode("0x"+p1)}))},decodeBase64:function(str){return decodeURIComponent(Array.prototype.map.call(atob(str),function(c){return"%"+("00"+c.charCodeAt(0).toString(16)).slice(-2)}).join(""))}}}),define("ui/feedback",["jquery","lodash","core/format","ui/component","util/wrapLongWords","util/encode","handlebars","i18n","lib/dompurify/purify"],function($$1,_,format,component,wrapLongWords,encode,Handlebars,__,DOMPurify){'use strict';function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)?function(obj){return _typeof2(obj)}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":_typeof2(obj)},_typeof(obj)}function Helpers0(hb){hb.registerHelper("__",function(key){return __(key)}),hb.registerHelper("dompurify",function(context){return DOMPurify.sanitize(context)}),hb.registerHelper("join",function(arr,keyValueGlue,fragmentGlue,wrapper){var fragments=[];return keyValueGlue="string"==typeof keyValueGlue?keyValueGlue:void 0,fragmentGlue="string"==typeof fragmentGlue?fragmentGlue:" ",wrapper="string"==typeof wrapper?wrapper:"\"",_.forIn(arr,function(value,key){var fragment="";null!==value||void 0!==value?"boolean"==typeof value?value=value?"true":"false":"object"===_typeof(value)&&(value=_.values(value).join(" ")):value="",void 0!==keyValueGlue&&(fragment+=key+keyValueGlue),fragment+=wrapper+value+wrapper,fragments.push(fragment)}),fragments.join(fragmentGlue)}),hb.registerHelper("for",function(startIndex,stopIndex,increment,options){var ret="";startIndex=parseInt(startIndex),stopIndex=parseInt(stopIndex),increment=parseInt(increment);for(var i=startIndex;i<stopIndex;i+=increment)ret+=options.fn(_.extend({},this,{i:i}));return ret}),hb.registerHelper("equal",function(var1,var2,options){return var1==var2?options.fn(this):options.inverse(this)}),hb.registerHelper("property",function(name,context){return context[name]||""}),hb.registerHelper("includes",function(haystack,needle,options){if(_.contains(haystack,needle))return options.fn(this)})}function tpl(data,options,asString){var html=Template(data,options);return asString||!0?html:$(html)}$$1=$$1&&$$1.hasOwnProperty("default")?$$1["default"]:$$1,_=_&&_.hasOwnProperty("default")?_["default"]:_,format=format&&format.hasOwnProperty("default")?format["default"]:format,component=component&&component.hasOwnProperty("default")?component["default"]:component,wrapLongWords=wrapLongWords&&wrapLongWords.hasOwnProperty("default")?wrapLongWords["default"]:wrapLongWords,encode=encode&&encode.hasOwnProperty("default")?encode["default"]:encode,Handlebars=Handlebars&&Handlebars.hasOwnProperty("default")?Handlebars["default"]:Handlebars,__=__&&__.hasOwnProperty("default")?__["default"]:__,DOMPurify=DOMPurify&&DOMPurify.hasOwnProperty("default")?DOMPurify["default"]:DOMPurify,Helpers0.__initialized||(Helpers0(Handlebars),Helpers0.__initialized=!0);var Template=Handlebars.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var buffer="",escapeExpression=this.escapeExpression,self=this,helperMissing=helpers.helperMissing,stack1,helper,options;return buffer+="<div id=\"",(helper=helpers.id)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.id,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"\" class=\"feedback feedback-",(helper=helpers.level)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.level,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+" ",stack1=helpers["if"].call(depth0,depth0&&depth0.popup,{hash:{},inverse:self.noop,fn:self.program(1,function(){return"popup"},data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\">\n    <span class=\"icon-",(helper=helpers.level)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.level,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"\"></span>\n    <div>\n        ",stack1=(helper=helpers.dompurify||depth0&&depth0.dompurify,options={hash:{},data:data},helper?helper.call(depth0,depth0&&depth0.msg,options):helperMissing.call(depth0,"dompurify",depth0&&depth0.msg,options)),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n    </div>\n    <span title=\""+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"Close message",options):helperMissing.call(depth0,"__","Close message",options)))+"\" class=\"icon-close\" data-close=\":parent .feedback\"></span>\n</div>\n",buffer}),currents=[],levels=["info","success","warning","danger","error"],defaultOptions={timeout:{info:2e3,success:2e3,warning:4e3,danger:4e3,error:8e3},wrapLongWordsAfter:40,encodeHtml:!0,popup:!0},feedbackFactory=function($container,config){var feedback;if($container&&$container.length||($container=$$1("#feedback-box")),!$container.length)throw new TypeError("The feedback needs to belong to an existing container");return feedback=component({message:function(level,msg,params,options){var displayedMessage=msg;return level&&_.contains(levels,level)||(level="info"),_.isPlainObject(params)&&(options=params,params=[]),this.config=_.defaults(options||{},this.config),this.config.level=level,this.config.encodeHtml&&(displayedMessage=encode.html(displayedMessage)),this.config.wrapLongWordsAfter&&(displayedMessage=wrapLongWords(displayedMessage,this.config.wrapLongWordsAfter)),_.isArray(params)&&params.length&&(displayedMessage=format.apply(format,[displayedMessage].concat(params))),this.config.msg=displayedMessage,this},info:function(msg,params,options){return this.message("info",msg,params,options).open()},success:function(msg,params,options){return this.message("success",msg,params,options).open()},warning:function(msg,params,options){return this.message("warning",msg,params,options).open()},danger:function(msg,params,options){return this.message("danger",msg,params,options).open()},error:function(msg,params,options){return this.message("error",msg,params,options).open()},open:function(){return _(currents).reject(this).invoke("close"),this.display()},close:function(){this.is("rendered")&&this.destroy()},display:function(){return this.is("rendered")?this.show():this.render($container),this}},defaultOptions),feedback.setTemplate(tpl).on("init",function(){this.config.id="feedback-"+(currents.length+1),currents.push(this),$container.trigger("create.feedback")}).on("render",function(){var self=this,$component=this.getElement(),$closer=$$1(".icon-close",$component),timeout=_.isPlainObject(this.config.timeout)?this.config.timeout[this.config.level]:this.config.timeout;$closer.off("click").on("click",function(e){e.preventDefault(),self.destroy()}),_.isNumber(timeout)&&0<timeout&&_.delay(function(){self.close()},timeout),$container.trigger("display.feedback")}).on("destroy",function(){$container.trigger("close.feedback"),_.remove(currents,this)}).init(config)};return feedbackFactory}),define("css!ui/taskQueueButton/css/taskable",[],function(){}),define("ui/taskQueueButton/taskable",["jquery","lodash","i18n","ui/report","ui/feedback","layout/loading-bar","handlebars","lib/dompurify/purify","css!ui/taskQueueButton/css/taskable.css"],function($$1,_,__,reportFactory,feedback,loadingBar,Handlebars,DOMPurify){'use strict';function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)?function(obj){return _typeof2(obj)}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":_typeof2(obj)},_typeof(obj)}function Helpers0(hb){hb.registerHelper("__",function(key){return __(key)}),hb.registerHelper("dompurify",function(context){return DOMPurify.sanitize(context)}),hb.registerHelper("join",function(arr,keyValueGlue,fragmentGlue,wrapper){var fragments=[];return keyValueGlue="string"==typeof keyValueGlue?keyValueGlue:void 0,fragmentGlue="string"==typeof fragmentGlue?fragmentGlue:" ",wrapper="string"==typeof wrapper?wrapper:"\"",_.forIn(arr,function(value,key){var fragment="";null!==value||void 0!==value?"boolean"==typeof value?value=value?"true":"false":"object"===_typeof(value)&&(value=_.values(value).join(" ")):value="",void 0!==keyValueGlue&&(fragment+=key+keyValueGlue),fragment+=wrapper+value+wrapper,fragments.push(fragment)}),fragments.join(fragmentGlue)}),hb.registerHelper("for",function(startIndex,stopIndex,increment,options){var ret="";startIndex=parseInt(startIndex),stopIndex=parseInt(stopIndex),increment=parseInt(increment);for(var i=startIndex;i<stopIndex;i+=increment)ret+=options.fn(_.extend({},this,{i:i}));return ret}),hb.registerHelper("equal",function(var1,var2,options){return var1==var2?options.fn(this):options.inverse(this)}),hb.registerHelper("property",function(name,context){return context[name]||""}),hb.registerHelper("includes",function(haystack,needle,options){if(_.contains(haystack,needle))return options.fn(this)})}function reportTpl(data,options,asString){var html=Template(data,options);return asString||!0?html:$(html)}function makeTaskable(component,config){return _.assign(component,taskableComponent),component.off(".taskable").on("init.taskable",function(){_.defaults(this.config,config||{},defaultConfig)})}$$1=$$1&&$$1.hasOwnProperty("default")?$$1["default"]:$$1,_=_&&_.hasOwnProperty("default")?_["default"]:_,__=__&&__.hasOwnProperty("default")?__["default"]:__,reportFactory=reportFactory&&reportFactory.hasOwnProperty("default")?reportFactory["default"]:reportFactory,feedback=feedback&&feedback.hasOwnProperty("default")?feedback["default"]:feedback,loadingBar=loadingBar&&loadingBar.hasOwnProperty("default")?loadingBar["default"]:loadingBar,Handlebars=Handlebars&&Handlebars.hasOwnProperty("default")?Handlebars["default"]:Handlebars,DOMPurify=DOMPurify&&DOMPurify.hasOwnProperty("default")?DOMPurify["default"]:DOMPurify,Helpers0.__initialized||(Helpers0(Handlebars),Helpers0.__initialized=!0);var Template=Handlebars.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var buffer="",escapeExpression=this.escapeExpression,stack1,helper;return buffer+="<div class=\"task-report-container\">\n    <div class=\"section-header flex-container-full\">\n        <h2>",(helper=helpers.title)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.title,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"</h2>\n    </div>\n    <div class=\"main-container flex-container-full report\"></div>\n</div>",buffer}),defaultConfig={},taskableComponent={setTaskConfig:function(config){return _.assign(this.config,config),this},createTask:function(){var self=this,requestData={},taskQueue,requestUrl;return(_.isFunction(this.config.taskCreationData)?requestData=this.config.taskCreationData.call(this):_.isPlainObject(this.config.taskCreationData)&&(requestData=this.config.taskCreationData),!this.config.taskCreationUrl)?this.trigger("error","the request url is required to create a task"):(requestUrl=this.config.taskCreationUrl,this.config.taskQueue?void(taskQueue=this.config.taskQueue,loadingBar.start(),taskQueue.pollAllStop(),taskQueue.create(requestUrl,requestData).then(function(result){var task=result.task,infoBox,message;result.finished?task.hasFile?taskQueue.download(task.id).then(function(){return taskQueue.archive(task.id)}).then(function(){self.trigger("finished",result),taskQueue.pollAll()}).catch(function(err){self.trigger("error",err),taskQueue.pollAll()}):taskQueue.archive(task.id).then(function(){self.trigger("finished",result),taskQueue.pollAll()}).catch(function(err){self.trigger("error",err),taskQueue.pollAll()}):(message=__("<strong> %s </strong> has been moved to the background.",task.taskLabel),infoBox=feedback(null,{encodeHtml:!1,timeout:{info:8e3}}).info(message),taskQueue.trigger("taskcreated",{task:task,sourceDom:infoBox.getElement()}),self.trigger("enqueued",result)),loadingBar.stop()}).catch(function(err){taskQueue.pollAll(),loadingBar.stop(),self.trigger("error",err)})):this.trigger("error","the taskQueue model is required to create a task"))},displayReport:function(report,title,result){var self=this,$reportContainer;if(this.config.taskReportContainer instanceof $$1)return $reportContainer=$$1(reportTpl({title:title})),this.config.taskReportContainer.html($reportContainer),reportFactory({actions:[{id:"continue",icon:"right",title:"continue",label:__("Continue")}]},report).on("action-continue",function(){self.trigger("continue",result)}).render($reportContainer.find(".report"))}};return makeTaskable}),define("ui/taskQueueButton/standardButton",["lodash","ui/loadingButton/loadingButton","ui/taskQueueButton/taskable"],function(_,loadingButton,makeTaskable){'use strict';function standardTaskButtonFactory(config){var component;return config=_.defaults(config||{},defaultConfig),component=makeTaskable(loadingButton(config)),component.on("started",function(){this.createTask()}).on("finished",function(){this.terminate().reset()}).on("enqueued",function(){this.terminate().reset()})}_=_&&_.hasOwnProperty("default")?_["default"]:_,loadingButton=loadingButton&&loadingButton.hasOwnProperty("default")?loadingButton["default"]:loadingButton,makeTaskable=makeTaskable&&makeTaskable.hasOwnProperty("default")?makeTaskable["default"]:makeTaskable;var defaultConfig={};return standardTaskButtonFactory}),define("css!ui/destination/css/selector",[],function(){}),define("ui/destination/selector",["jquery","lodash","i18n","ui/component","ui/dialog/confirm","ui/resource/selector","ui/loadingButton/loadingButton","ui/taskQueueButton/standardButton","handlebars","lib/dompurify/purify","css!ui/destination/css/selector.css"],function($$1,_,__,component,confirmDialog,resourceSelectorFactory,loadingButtonFactory,taskCreationButtonFactory,Handlebars,DOMPurify){'use strict';function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)?function(obj){return _typeof2(obj)}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":_typeof2(obj)},_typeof(obj)}function Helpers0(hb){hb.registerHelper("__",function(key){return __(key)}),hb.registerHelper("dompurify",function(context){return DOMPurify.sanitize(context)}),hb.registerHelper("join",function(arr,keyValueGlue,fragmentGlue,wrapper){var fragments=[];return keyValueGlue="string"==typeof keyValueGlue?keyValueGlue:void 0,fragmentGlue="string"==typeof fragmentGlue?fragmentGlue:" ",wrapper="string"==typeof wrapper?wrapper:"\"",_.forIn(arr,function(value,key){var fragment="";null!==value||void 0!==value?"boolean"==typeof value?value=value?"true":"false":"object"===_typeof(value)&&(value=_.values(value).join(" ")):value="",void 0!==keyValueGlue&&(fragment+=key+keyValueGlue),fragment+=wrapper+value+wrapper,fragments.push(fragment)}),fragments.join(fragmentGlue)}),hb.registerHelper("for",function(startIndex,stopIndex,increment,options){var ret="";startIndex=parseInt(startIndex),stopIndex=parseInt(stopIndex),increment=parseInt(increment);for(var i=startIndex;i<stopIndex;i+=increment)ret+=options.fn(_.extend({},this,{i:i}));return ret}),hb.registerHelper("equal",function(var1,var2,options){return var1==var2?options.fn(this):options.inverse(this)}),hb.registerHelper("property",function(name,context){return context[name]||""}),hb.registerHelper("includes",function(haystack,needle,options){if(_.contains(haystack,needle))return options.fn(this)})}function selectorTpl(data,options,asString){var html=Template(data,options);return asString||!0?html:$(html)}function destinationSelectorFactory($container,config){var destinationSelector=component({update:function(results,params){this.resourceSelector&&this.resourceSelector.update(results,params)}},defaultConfig).setTemplate(selectorTpl).on("init",function(){this.render($container)}).on("render",function(){var self=this,$component=this.getElement(),getSelectedUri=function(){var select=self.resourceSelector.getSelection(),uris;if(_.isPlainObject(select)&&(uris=_.pluck(select,"uri"),uris.length))return uris[0]},button;button=this.config.taskQueue?taskCreationButtonFactory({type:"info",icon:this.config.icon,label:this.config.actionName,terminatedLabel:"Interrupted",taskQueue:this.config.taskQueue,taskCreationData:this.config.taskCreationData||{},taskCreationUrl:this.config.taskCreationUrl,taskReportContainer:$container}).on("finished",function(result){self.trigger("finished",result,button),this.reset()}).on("continue",function(){self.trigger("continue")}):loadingButtonFactory({type:"info",icon:this.config.icon,label:this.config.actionName,terminatedLabel:"Interrupted"}),button.on("started",function(){function triggerAction(){self.trigger("select",getSelectedUri())}self.config.confirm?confirmDialog(self.config.confirm,triggerAction,function(){button.terminate().reset()}):triggerAction()}).on("error",function(err){self.trigger("error",err)}).render($component.find(".actions")).disable(),this.resourceSelector=resourceSelectorFactory($$1(".selector-container",$component),{selectionMode:"single",selectClass:!0,classUri:this.config.classUri,showContext:!1,showSelection:!1,preventSelection:this.config.preventSelection}),this.resourceSelector.spread(this,["query","error","update"]),this.resourceSelector.on("change",function(selected){selected&&0<_.size(selected)?(button.enable(),_.isPlainObject(button.config.taskCreationData)&&(button.config.taskCreationData.classUri=getSelectedUri())):button.disable()})});return _.defer(function(){destinationSelector.init(config)}),destinationSelector}$$1=$$1&&$$1.hasOwnProperty("default")?$$1["default"]:$$1,_=_&&_.hasOwnProperty("default")?_["default"]:_,__=__&&__.hasOwnProperty("default")?__["default"]:__,component=component&&component.hasOwnProperty("default")?component["default"]:component,confirmDialog=confirmDialog&&confirmDialog.hasOwnProperty("default")?confirmDialog["default"]:confirmDialog,resourceSelectorFactory=resourceSelectorFactory&&resourceSelectorFactory.hasOwnProperty("default")?resourceSelectorFactory["default"]:resourceSelectorFactory,loadingButtonFactory=loadingButtonFactory&&loadingButtonFactory.hasOwnProperty("default")?loadingButtonFactory["default"]:loadingButtonFactory,taskCreationButtonFactory=taskCreationButtonFactory&&taskCreationButtonFactory.hasOwnProperty("default")?taskCreationButtonFactory["default"]:taskCreationButtonFactory,Handlebars=Handlebars&&Handlebars.hasOwnProperty("default")?Handlebars["default"]:Handlebars,DOMPurify=DOMPurify&&DOMPurify.hasOwnProperty("default")?DOMPurify["default"]:DOMPurify,Helpers0.__initialized||(Helpers0(Handlebars),Helpers0.__initialized=!0);var Template=Handlebars.template(function(Handlebars,depth0,helpers,partials,data){function program1(depth0,data){var buffer="",stack1,helper;return buffer+="\n    <h2>",(helper=helpers.title)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.title,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"</h2>\n    ",buffer}function program3(depth0,data){var buffer="",stack1,helper;return buffer+="\n        <p>",(helper=helpers.description)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.description,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"</p>\n        ",buffer}this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var buffer="",escapeExpression=this.escapeExpression,self=this,stack1;return buffer+="<div class=\"destination-selector\">\n    ",stack1=helpers["if"].call(depth0,depth0&&depth0.title,{hash:{},inverse:self.noop,fn:self.program(1,program1,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n    <div>\n        ",stack1=helpers["if"].call(depth0,depth0&&depth0.description,{hash:{},inverse:self.noop,fn:self.program(3,program3,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n        <div class=\"selector-container\"></div>\n        <div class=\"actions\">\n        </div>\n    </div>\n</div>\n",buffer}),defaultConfig={title:__("Copy to"),description:__("Select a destination"),actionName:__("Copy"),icon:"copy"};return destinationSelectorFactory}),define("ui/lock",["jquery","lodash","i18n","handlebars","lib/dompurify/purify","helpers","ui/feedback"],function($$1,_,__,Handlebars,DOMPurify,helpers,feedback){'use strict';function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)?function(obj){return _typeof2(obj)}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":_typeof2(obj)},_typeof(obj)}function Helpers0(hb){hb.registerHelper("__",function(key){return __(key)}),hb.registerHelper("dompurify",function(context){return DOMPurify.sanitize(context)}),hb.registerHelper("join",function(arr,keyValueGlue,fragmentGlue,wrapper){var fragments=[];return keyValueGlue="string"==typeof keyValueGlue?keyValueGlue:void 0,fragmentGlue="string"==typeof fragmentGlue?fragmentGlue:" ",wrapper="string"==typeof wrapper?wrapper:"\"",_.forIn(arr,function(value,key){var fragment="";null!==value||void 0!==value?"boolean"==typeof value?value=value?"true":"false":"object"===_typeof(value)&&(value=_.values(value).join(" ")):value="",void 0!==keyValueGlue&&(fragment+=key+keyValueGlue),fragment+=wrapper+value+wrapper,fragments.push(fragment)}),fragments.join(fragmentGlue)}),hb.registerHelper("for",function(startIndex,stopIndex,increment,options){var ret="";startIndex=parseInt(startIndex),stopIndex=parseInt(stopIndex),increment=parseInt(increment);for(var i=startIndex;i<stopIndex;i+=increment)ret+=options.fn(_.extend({},this,{i:i}));return ret}),hb.registerHelper("equal",function(var1,var2,options){return var1==var2?options.fn(this):options.inverse(this)}),hb.registerHelper("property",function(name,context){return context[name]||""}),hb.registerHelper("includes",function(haystack,needle,options){if(_.contains(haystack,needle))return options.fn(this)})}function tpl(data,options,asString){var html=Template(data,options);return asString||!0?html:$(html)}function delegate(receiver,provider){return _(provider).functions().forEach(function(methodName){receiver[methodName]=function(){return provider[methodName].apply(receiver,arguments)}}),receiver}$$1=$$1&&$$1.hasOwnProperty("default")?$$1["default"]:$$1,_=_&&_.hasOwnProperty("default")?_["default"]:_,__=__&&__.hasOwnProperty("default")?__["default"]:__,Handlebars=Handlebars&&Handlebars.hasOwnProperty("default")?Handlebars["default"]:Handlebars,DOMPurify=DOMPurify&&DOMPurify.hasOwnProperty("default")?DOMPurify["default"]:DOMPurify,helpers=helpers&&helpers.hasOwnProperty("default")?helpers["default"]:helpers,feedback=feedback&&feedback.hasOwnProperty("default")?feedback["default"]:feedback,Helpers0.__initialized||(Helpers0(Handlebars),Helpers0.__initialized=!0);var Template=Handlebars.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var buffer="",escapeExpression=this.escapeExpression,helperMissing=helpers.helperMissing,stack1,helper,options;return buffer+="<div class=\"feedback-",(helper=helpers.level)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.level,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"\">\n<span class=\"icon-lock ",(helper=helpers.level)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.level,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"-color ",(helper=helpers.level)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.level,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"\"></span>\n    ",(helper=helpers.msg)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.msg,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"\n    <div class=\"txt-rgt button-container\">\n        <button class=\"btn btn-info small check-in\"><span class=\"icon-unlock info\"></span>"+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"Check-in",options):helperMissing.call(depth0,"__","Check-in",options)))+"</button>\n        <button class=\"btn btn-info small release\"><span class=\"icon-result-nok info\"></span>"+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"Release",options):helperMissing.call(depth0,"__","Release",options)))+"</button>\n    </div>\n\n    <div class=\"message-container button-container\" style=\"display: none;\">\n            <label>\n                "+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"Message",options):helperMissing.call(depth0,"__","Message",options)))+"\n            </label>\n            <input type=\"text\" name=\"message\" class=\"message\">\n            <button class=\"btn-info small commit\">"+escapeExpression((helper=helpers.__||depth0&&depth0.__,options={hash:{},data:data},helper?helper.call(depth0,"Commit",options):helperMissing.call(depth0,"__","Commit",options)))+"</button>\n    </div>\n</div>\n",buffer}),currents=[],categories={hasLock:"info",locked:"error"},states={created:"created",displayed:"displayed",closed:"closed"},defaultOptions={msg:__("This resource is locked"),releaseUrl:helpers._url("release","Lock","tao"),commitUrl:helpers._url("commitResource","History","taoRevision")},lockApi={level:null,category:null,message:function(category,msg,options){return category&&_.contains(_.keys(categories),category)||(category="hasLock"),this.setState(states.created),this.category=category,this.level=_.result(categories,this.category),this.options=_.defaults(options||{},defaultOptions),this.content=tpl({level:this.level,msg:msg}),this._trigger("create"),this},hasLock:function(msg,options){return this.message("hasLock",msg,options).open()},locked:function(msg,options){return this.message("locked",msg,options).open()},open:function(){return this._trigger("open"),this.display(),this},close:function(){this.isInState(states.displayed)&&(this.setState(states.closed),$$1("#"+this.id).remove(),this._trigger("close"),_.remove(currents,{_state:states.closed}))},display:function(){var self=this;return self.content&&(self.setState(states.displayed),$$1(self.content).attr("id",self.id).appendTo(self._container),self._trigger("display"),"undefined"==typeof this.options.uri?($$1(".release",self._container).hide(),$$1(".check-in",self._container).hide()):($$1(".release",self._container).on("click",function(){self.release()}),$$1(".check-in",self._container).on("click",function(){self.commit()}))),self},release:function(){var self=this;return""===self.options.releaseUrl?self._trigger("failed"):$$1.ajax({url:self.options.releaseUrl,type:"POST",data:{uri:self.options.uri},dataType:"json",success:function(response){response.success?self._trigger("released",response):self._trigger("failed",response)},error:function(){self._trigger("failed")}}),this},commit:function(){var self=this;return""===self.options.commitUrl?self._trigger("failed"):($$1(".message-container",self._container).slideToggle(),$$1(".commit",self._container).off("click").on("click",function(){var message=$$1(".message",self._container).val();""===message?self._trigger("failed",{message:__("Please give a message to your commit")}):$$1.ajax({url:self.options.commitUrl,type:"POST",data:{id:self.options.uri,message:message},dataType:"json",success:function(response){response.success?self._trigger("committed",response):self._trigger("failed",response)},error:function(){self._trigger("failed")}})})),this},register:function(){var msg=this._container.data("msg")||defaultOptions.msg,id=this._container.data("id");return this.message("hasLock",msg,{uri:id,released:function(response){feedback().success(response.message),this.close()},committed:function(response){feedback().success(response.commitMessage),this.close()},failed:function(response){"undefined"!=typeof response&&"undefined"!=typeof response.message?feedback().error(response.message):feedback().error("Unknown Error")}}).open()},_trigger:function(eventName,data){this._container.trigger(eventName+".lock",[this]),_.isFunction(this.options[eventName])&&this.options[eventName].call(this,data)}},lockState={_state:null,isInState:function(verify){return _.isString(verify)&&(verify=[verify]),_.contains(verify,this._state)},setState:function(state){if(!_.contains(states,state))throw new Error("Unkown state "+state);this._state=state}},lockFactory=function($container){var _container;if($container||($lockBox=$$1("#lock-box")),_container=$container||$lockBox,!_container||!_container.length)throw new Error("The lock needs to belong to an existing container");_.forEach(currents,function(lockRef){null!==lockRef&&lockRef._container.get(0)===_container.get(0)&&lockRef.close()});var lk=_.extend({id:"lock-"+(currents.length+1),_container:_container},lockState);return currents.push(lk),delegate(lk,lockApi)},$lockBox;return lockFactory}),define("taoItems/controller/items/edit",["jquery","i18n","module","layout/actions","ui/lock","layout/section"],function($,__,module,actions,lock,section){'use strict';return{start:function start(){var config=module.config(),previewAction=actions.getBy("item-preview"),authoringAction=actions.getBy("item-authoring");previewAction&&(previewAction.state.disabled=!config.isPreviewEnabled),authoringAction&&(authoringAction.state.disabled=!config.isAuthoringEnabled),actions.updateState(),$("#lock-box").each(function(){lock($(this)).register()}),section.off("show").on("show",function(sectionContext){"manage_items"===sectionContext.id&&actions.exec("item-properties")})}}}),define("tpl!taoItems/component/category/switch",["handlebars"],function(hb){return hb.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var buffer="",escapeExpression=this.escapeExpression,stack1,helper;return buffer+="<a href=\"#\" data-id=\"",(helper=helpers.id)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.id,stack1="function"===_typeof2(helper)?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"\" class=\"category-auto-adder\"><span class=\"icon-tag\"></span></a>",buffer})}),define("taoItems/component/category/switch",["lodash","i18n","ui/component","tpl!taoItems/component/category/switch"],function(_,__,component,switchTpl){'use strict';var titles={expose:__("Expose the property value to create automated categories."),unexpose:__("The property is exposed to category addition.&#13Remove exposition ?")};return function($container,propertyId,exposed){var categorySwitchComponent;if(!propertyId)throw new TypeError("We need the property id");return categorySwitchComponent=component({setExposed:function(value){return this.is("disabled")||(this.setState("exposed",!!value),this.is("rendered")&&(value?this.getElement().removeClass("placeholder").addClass("txt-success").attr("title",titles.unexpose):this.getElement().removeClass("txt-success").addClass("placeholder").attr("title",titles.expose))),this},isExposed:function(){return this.is("exposed")}},{}).on("init",function(){this.setState("exposed",exposed),this.render($container)}).on("render",function(){var self=this,$component=this.getElement();this.setExposed(exposed),$component.off("click").on("click",function(e){e.preventDefault(),self.is("disabled")||self.trigger("requestChange",self.config.id,!self.is("exposed"))})}),_.defer(function(){categorySwitchComponent.setTemplate(switchTpl).init({id:propertyId})}),categorySwitchComponent}}),define("taoItems/provider/category",["lodash","i18n","util/url","core/dataProvider/request","core/promise"],function(_,__,url,request,Promise){'use strict';var defaultConfig={getExposedsByClass:{url:url.route("getExposedsByClass","Category","taoItems")},setExposed:{url:url.route("setExposed","Category","taoItems")}};return function(config){return config=_.defaults(config||{},defaultConfig),{getExposedsByClass:function(id){return new Promise(function(resolve,reject){return _.isEmpty(id)?reject(new TypeError("The class URI must be provided in the id parameter")):resolve(request(config.getExposedsByClass.url,{id:id}))})},setExposed:function(id,exposed){return new Promise(function(resolve,reject){return _.isEmpty(id)?reject(new TypeError("The property URI must be provided in the id parameter")):_.isBoolean(exposed)?resolve(request(config.setExposed.url,{id:id,exposed:exposed})):reject(new TypeError("The exposed value is required."))})}}}}),define("taoItems/controller/items/editItemClass",["jquery","lodash","uri","taoItems/component/category/switch","taoItems/provider/category","ui/feedback"],function($,_,uriUtil,categorySwitch,categoryProvider,feedback){'use strict';var provider=categoryProvider(),injectButtonPlaceholder=function(uri){var $propContainer=$("#property_"+uriUtil.encode(uri)),$placeholder,$propertyToolbar,$editButton;return $propContainer.length&&$propContainer.hasClass("regular-property")&&($placeholder=$("<span>"),$propertyToolbar=$(".property-heading-toolbar",$propContainer),$editButton=$(".icon-edit",$propertyToolbar),$editButton.length?$placeholder.insertAfter($editButton):$propertyToolbar.append($placeholder)),$placeholder},handleError=function(err){feedback().error(err.message)},addCategorySwitch=function($container,propertyUri,exposed){return categorySwitch($container,propertyUri,exposed).on("requestChange",function(propUri,value){var self=this;this.setState("disabled",!0),provider.setExposed(propUri,value).then(function(success){self.setState("disabled",!1),success&&self.setExposed(value)}).catch(handleError)})};return{start:function(){var classUri=$("#id").val();provider.getExposedsByClass(classUri).then(function(results){_.forEach(results,function(exposed,uri){var $container=injectButtonPlaceholder(uri);$container&&$container.length&&addCategorySwitch($container,uri,exposed)})}).catch(handleError)}}}),define("taoItems/runtime/ItemServiceImpl",["jquery"],function($){function ItemServiceImpl(data){this.itemId=data.itemId,this.serviceApi=data.serviceApi,this.resultApi=data.resultApi||null,this.params=data.params||{},this.responses={},this.scores={},this.events={},this.connected=!1;var rawstate=this.serviceApi.getState(),state="undefined"==typeof rawstate||null===rawstate?{}:$.parseJSON(rawstate);this.stateVariables="object"===_typeof2(state)?state:{},this.beforeFinishCallbacks=[]}return ItemServiceImpl.prototype.connect=function(frame){!1===this.connected&&frame.contentWindow&&(frame.contentWindow.itemApi=this,"function"==typeof frame.contentWindow.onItemApiReady&&(frame.contentWindow.onItemApiReady(this),this.connected=!0))},ItemServiceImpl.prototype.saveResponses=function(valueArray){for(var attrname in valueArray)this.responses[attrname]=valueArray[attrname]},ItemServiceImpl.prototype.traceEvents=function(eventArray){for(var attrname in eventArray)this.events[attrname]=eventArray[attrname]},ItemServiceImpl.prototype.saveScores=function(valueArray){for(var attrname in valueArray)this.scores[attrname]=valueArray[attrname]},ItemServiceImpl.prototype.getUserPropertyValues=function(property,callback){this.serviceApi.getUserPropertyValues(property,callback)},ItemServiceImpl.prototype.beforeFinish=function(callback){this.beforeFinishCallbacks.push(callback)},ItemServiceImpl.prototype.finish=function(){for(var self=this,i=0;i<this.beforeFinishCallbacks.length;i++)this.beforeFinishCallbacks[i]();this.submit(function(){self.serviceApi.finish()})},ItemServiceImpl.prototype.submit=function(after){var self=this;this.serviceApi.setState(JSON.stringify(self.stateVariables),function(){self.resultApi?self.resultApi.submitItemVariables(self.itemId,self.serviceApi.getServiceCallId(),self.responses,self.scores,self.events,self.params,after):after()})},ItemServiceImpl.prototype.onKill=function(callback){this.serviceApi.onKill(callback)},ItemServiceImpl.prototype.getVariable=function(identifier,callback){"function"==typeof callback&&callback(this.stateVariables[identifier]||null)},ItemServiceImpl.prototype.setVariable=function(identifier,value){this.stateVariables[identifier]=value,this.serviceApi.setState(JSON.stringify(this.stateVariables))},ItemServiceImpl.prototype.setVariables=function(values){for(var v in values)this.stateVariables[v]=values[v];this.serviceApi.setState(JSON.stringify(this.stateVariables))},ItemServiceImpl}),define("core/errorHandler",["lodash"],function(_){'use strict';_=_&&_.hasOwnProperty("default")?_["default"]:_;return{_contexts:{},getContext:function(name){if(_.isString(name)&&name.length)return this._contexts[name]=this._contexts[name]||{typedHandlers:{},globalHandler:null},this._contexts[name]},listen:function(name,type,handler){var context=this.getContext(name);context&&(_.isFunction(type)&&!handler&&(handler=type),_.isFunction(handler)&&(_.isString(type)&&!_.isEmpty(type)?context.typedHandlers[type]=handler:context.globalHandler=handler))},throw:function(name,err){var context=this.getContext(name);if(context)return _.isString(err)&&(err=new Error(err)),_.isFunction(context.typedHandlers[err.name])&&context.typedHandlers[err.name](err),_.isFunction(context.globalHandler)&&context.globalHandler(err),!1},reset:function(name){this._contexts[name]&&(this._contexts=_.omit(this._contexts,name))}}}),define("taoItems/preview/actionBarHook",["jquery","lodash","core/errorHandler","core/promise"],function($,_,errorHandler,Promise){'use strict';function isValidConfig(toolconfig){return!!(_.isObject(toolconfig)&&toolconfig.hook)}function triggerItemLoaded(tool){tool&&tool.itemLoaded&&tool.itemLoaded()}function initExtraButtons($toolContainer,id,toolconfig){return _.isString(toolconfig)&&(toolconfig={hook:toolconfig}),tools[id]=null,$toolContainers=$toolContainers.add($toolContainer),new Promise(function(resolve){isValidConfig(toolconfig)?require([toolconfig.hook],function(hook){var $button,$existingBtn;isValidHook(hook)?(hook.init(id,toolconfig),$existingBtn=$toolContainer.children("[data-control=\""+id+"\"]"),$existingBtn.length&&(hook.clear($existingBtn),$existingBtn.remove()),tools[id]=hook,$button=hook.render(),_appendInOrder($toolContainer,$button),$button.trigger("ready.previewActionBarHook",[hook]),triggerItemLoaded(hook),resolve(hook)):(errorHandler.throw(".previewActionBarHook","invalid hook format"),resolve(null))},function(){errorHandler.throw(".previewActionBarHook","the hook amd module cannot be found"),resolve(null)}):(errorHandler.throw(".previewActionBarHook","invalid tool config format"),resolve(null))})}function _appendInOrder($container,$button){var order=$button.data("order"),$after,$before;"last"===order?$container.append($button):"first"===order?$container.prepend($button):(order=_.parseInt(order),_.isNaN(order)?$container.append($button):($container.children(".action").each(function(){var $btn=$(this),_order=$btn.data("order");if("last"===_order)$before=$btn,$after=null;else if("first"===_order)$before=null,$after=$btn;else{if(_order=_.parseInt(_order),_.isNaN(_order)||_order>order)return $before=$btn,$after=null,!1;_order===order?$after=$btn:_order<order&&($after=$btn,$before=null)}}),$after?$after.after($button):$before?$before.before($button):$container.append($button)))}function isValidHook(hook){return _.isObject(hook)&&_(["init","render","clear","isVisible"]).reduce(function(result,method){return result&&_.isFunction(hook[method])},!0)}var tools={},$toolContainers=$();return $(document).off(".preview").on("itemunload.preview",function(){$toolContainers.each(function(){var $toolContainer=$(this);_.forEach(tools,function(tool,id){var $btn=$toolContainer.children("[data-control=\""+id+"\"]");$btn.length&&(tool.clear($btn),$btn.remove())})})}),{isValid:isValidConfig,initExtraButtons:initExtraButtons}}),define("taoItems/controller/preview/itemRunner",["module","jquery","lodash","util/encode","serviceApi/ServiceApi","serviceApi/PseudoStorage","serviceApi/UserInfoService","taoItems/runtime/ItemServiceImpl","taoItems/preview/actionBarHook","util/urlParser"],function(module,$,_,encoder,ServiceApi,PseudoStorage,UserInfoService,ItemServiceImpl,actionBarHook,UrlParser){'use strict';var _initCustomButtons=function(){var config=module.config(),buttons=config.extraButtons||{},$container=$(".extra-button-action-bar");_.forIn(buttons,function(config,id){actionBarHook.initExtraButtons($container,id,config)})};return{start:function start(options){var conf=_.merge(module.config(),options||{});if(conf.previewUrl){var resultServer=_.defaults(conf.resultServer,{module:"taoResultServer/ResultServerApi",endpoint:"",params:{}});require([resultServer.module],function(ResultServerApi){var resultServerApi=new ResultServerApi(resultServer.endpoint,resultServer.params),serviceApi=new ServiceApi(conf.previewUrl,{},"preview",new PseudoStorage(),new UserInfoService(conf.userInfoServiceRequestUrl,{})),itemApi=new ItemServiceImpl({serviceApi:serviceApi,resultApi:resultServerApi}),callUrl=new UrlParser(serviceApi.getCallUrl()),isCORSAllowed=callUrl.checkCORS();callUrl.addParam("clientConfigUrl",conf.clientConfigUrl);var $frame=$("<iframe id=\"preview-container\" name=\"preview-container\" src=\""+callUrl.getUrl()+"\"></iframe>"),state;try{state=JSON.parse(encoder.decodeBase64(conf.state))}catch(e){state=null}state&&itemApi.setVariables(state),$frame.on("load",function(){var frame=this;itemApi.connect(frame),!0===isCORSAllowed&&(frame.contentWindow.__knownParent__=!0),$(document).off("itemready").on("itemready",function(){itemApi.connect(frame),frame.contentWindow.__knownParent__&&(frame.contentWindow.document.body.className+=" tao-preview-scope",_initCustomButtons())})}),$(".preview-item-container").append($frame),$("#finishButton").click(function(){itemApi.finish()})})}}}}),define("taoItems/controller/routes",[],function(){'use strict';return{Items:{deps:"controller/items/action",actions:{editItem:"controller/items/edit",editItemClass:"controller/items/editItemClass"}},ItemPreview:{actions:{index:"controller/preview/itemRunner"}}}}),define("taoItems/controller/runtime/itemRunner",["jquery","lodash","iframeNotifier","util/urlParser"],function($,_,iframeNotifier,UrlParser){'use strict';return{start:function start(options){var $frame=$("<iframe id=\"item-container\" class=\"toolframe\" frameborder=\"0\" style=\"width:100%;\" scrolling=\"no\"></iframe>");$frame.appendTo("body");var itemId=options.itemId,itemPath=options.itemPath,resultServer=_.defaults(options.resultServer,{module:"taoResultServer/ResultServerApi",params:{}}),itemService=_.defaults(options.itemService,{module:"taoItems/runtime/ItemServiceImpl",params:{}}),clientConfigUrl=options.clientConfigUrl,timeout=options.timeout||30;require([itemService.module,resultServer.module],function(ItemService,ResultServerApi){var resultServerApi=new ResultServerApi(resultServer.endpoint,resultServer.params),setIframeHeight=function(newHeight){var neverResized=150===$frame.height(),resize=function(newHeight,notifyParent){$frame.css({height:newHeight}),notifyParent&&iframeNotifier.parent("heightchange",newHeight)};resize(newHeight||$frame.contents().outerHeight(!0),!newHeight),neverResized&&_.delay(function(){resize($frame.contents().outerHeight(!0),!0)},200)};window.onServiceApiReady=function(serviceApi){var itemApi=new ItemService(_.merge({serviceApi:serviceApi,itemId:itemId,resultApi:resultServerApi},{params:itemService.params})),itemUrl=new UrlParser(itemPath),isCORSAllowed=itemUrl.checkCORS();itemUrl.addParam("clientConfigUrl",clientConfigUrl),itemUrl.addParam("timeout",timeout),$(document).on("itemloaded",function(){setIframeHeight(),iframeNotifier.parent("serviceloaded"),_.delay(setIframeHeight,1600),$frame.contents().find("img").on("load",_.throttle(function(){setIframeHeight()},50))}).on("responsechange",function(e,responseId,response){iframeNotifier.parent("responsechange",[responseId,response])}).on("stateready",function(e,elmentId,state){iframeNotifier.parent("stateready",[elmentId,state])}).on("itemready",function(){itemApi.connect($frame[0])}).on("itemcontentchange imageloaded",function(){setIframeHeight()}),$frame.on("load",function(){itemApi.connect($frame[0]),!0===isCORSAllowed&&(this.contentWindow.__knownParent__=!0),$("body").on("setheight",function(event,height){setIframeHeight(height)})}),$frame.attr("src",itemUrl.getUrl())},_.defer(function(){iframeNotifier.parent("serviceready")})})}}}),define("taoItems/assets/manager",["lodash","util/url"],function(_,urlUtil){'use strict';var checkStrategy=function(strategy){if(!_.isPlainObject(strategy)||!_.isFunction(strategy.handle)||!_.isString(strategy.name))throw new TypeError("An asset resolution strategy is an object with a handle method and a name")};return function(strategies,data,options){var cache={};strategies=_.isArray(strategies)?strategies:[strategies],data=data||{},options=_.defaults(options||{},{parseUrl:!0});var assetManager={_strategies:[],addStrategy:function(strategy){checkStrategy(strategy),this._strategies.push(strategy)},prependStrategy:function(strategy){checkStrategy(strategy),this._strategies.unshift(strategy)},setStrategies:function(newStrategies){var self=this;this._strategies=[],_.forEach(newStrategies,function(strategy){_.isPlainObject(strategy)?assetManager.addStrategy(strategy):_.isFunction(strategy)&&self.addStrategy({name:"strategy_"+(self._strategies.length+1),handle:strategy})})},setData:function(key,value){_.isString(key)&&"undefined"!=typeof value?data[key]=value:_.isPlainObject(key)&&(data=key)},getData:function(key){return _.isString(key)?data[key]:data},resolve:function(url){var resolved,inputUrl;return options.cache&&cache.hasOwnProperty(url)?cache[url]:(inputUrl=options.parseUrl?urlUtil.parse(url):url,_.forEach(this._strategies,function(strategy){var result=strategy.handle(inputUrl,data);if(result)return resolved=result,!1}),resolved=resolved||"",options.cache&&(cache[url]=resolved),resolved)},resolveBy:function(name,url){var resolved="",strategy=_.find(this._strategies,{name:name}),inputUrl;return strategy&&(inputUrl=options.parseUrl?urlUtil.parse(url):url,resolved=strategy.handle(inputUrl,data)),resolved},clearCache:function(){options.cache&&(cache={})}};return assetManager.setStrategies(strategies),assetManager}}),define("taoItems/assets/strategies",["util/url","lodash"],function(urlUtil,_){'use strict';var prependToUrl=function(url,base,slashcat){return!0===slashcat?base.replace(/\/$/,"")+"/"+url.directory.replace(/^\.\//,"").replace(/^\//,"")+encodeURIComponent(url.file.replace(/^\.\//,"").replace(/^\//,"")):base+url.directory.replace(/^\.?\//,"")+encodeURIComponent(url.file.replace(/^\.?\//,""))};return{packedUrl:{name:"packedUrl",handle:function(url,data){var type;if(!_.isUndefined(url.source)&&!_.isUndefined(data.assets)&&(type=_.findKey(data.assets,url.source),type&&urlUtil.isAbsolute(data.assets[type][url.source])))return data.assets[type][url.source]}},baseUrl:{name:"baseUrl",handle:function(url,data){if("string"==typeof data.baseUrl&&urlUtil.isRelative(url))return prependToUrl(url,data.baseUrl,data.slashcat)}},itemCssNoCache:{name:"itemCssNoCache",handle:function(url,data){if("string"==typeof data.baseUrl&&urlUtil.isRelative(url)&&/\.css$/.test(url.file))return urlUtil.build(prependToUrl(url,data.baseUrl,data.slashcat),{bust:Date.now()})}},external:{name:"external",handle:function(url){if(urlUtil.isAbsolute(url))return url.toString()}},base64:{name:"base64",handle:function(url){if(urlUtil.isBase64(url))return url.toString()}},taomedia:{name:"taomedia",handle:function(url,data){var baseUrl=data.baseUrl||"./";if("object"===_typeof2(url)&&"taomedia"===url.protocol||/^taomedia:\/\//.test(url.toString()))return baseUrl+url.toString()}}}}),define("taoItems/previewer/adapter/legacy",["util/url","taoItems/preview/preview"],function(urlHelper,preview){'use strict';return{name:"legacy",init:function(uri,state){return"object"===_typeof2(uri)&&uri.uri&&(uri=uri.uri),window.scrollTo(0,0),preview.init(urlHelper.route("forwardMe","ItemPreview","taoItems",{uri:uri}),state),preview.show(),preview}}}),define("core/moduleLoader",["lodash","core/promise"],function(_,Promise){'use strict';function moduleLoaderFactory(requiredModules,validate,specs){var loaded={},modules={},excludes=[],bundles=[],loader={addList:function(moduleList){return _.forEach(moduleList,this.add,this),this},add:function(def){if(!_.isPlainObject(def))throw new TypeError("The module definition module must be an object");if(_.isEmpty(def.module)||!_.isString(def.module))throw new TypeError("An AMD module must be defined");if(_.isEmpty(def.category)||!_.isString(def.category)){var identifyProvider=def.id||def.name||def.module;throw new TypeError("The provider '".concat(identifyProvider,"' must belong to a category"))}return modules[def.category]=modules[def.category]||[],_.isNumber(def.position)?modules[def.category][def.position]=def.module:"prepend"===def.position||"before"===def.position?modules[def.category].unshift(def.module):modules[def.category].push(def.module),def.bundle&&!_.contains(bundles,def.bundle)&&bundles.push(def.bundle),this},append:function(def){return this.add(_.merge({position:"append"},def))},prepend:function(def){return this.add(_.merge({position:"prepend"},def))},remove:function(module){return excludes.push(module),this},load:function(loadBundles){var self=this,dependencies=_(modules).values().flatten().uniq().difference(excludes).value(),loadModules=function(){var amdModules=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];return _.isArray(amdModules)&&amdModules.length?new Promise(function(resolve,reject){require(amdModules,function(){for(var _len=arguments.length,loadedModules=Array(_len),_key=0;_key<_len;_key++)loadedModules[_key]=arguments[_key];return resolve(loadedModules)},function(err){reject(err)})}):Promise.resolve()};return loadModules(loadBundles?bundles:[]).then(function(){return loadModules(dependencies)}).then(function(loadedModules){return _.forEach(dependencies,function(dependency,index){var module=loadedModules[index],category=_.findKey(modules,function(val){return _.contains(val,dependency)});if("function"==typeof validate&&!validate(module))throw new TypeError("The module '".concat(dependency,"' is not valid"));_.isString(category)&&(loaded[category]=loaded[category]||[],loaded[category].push(module))}),self.getModules()})},getModules:function(category){return _.isString(category)?loaded[category]||[]:_(loaded).values().flatten().uniq().value()},getCategories:function(){return _.keys(loaded)}};return validate=_.isFunction(validate)?validate:_.isPlainObject,_.forEach(requiredModules,function(moduleList,category){if(_.isEmpty(category)||!_.isString(category))throw new TypeError("Modules must belong to a category");if(!_.isArray(moduleList))throw new TypeError("A list of modules must be an array");if(!_.all(moduleList,validate))throw new TypeError("The list does not contain valid modules");loaded[category]=loaded[category]?loaded[category].concat(moduleList):moduleList}),specs&&_(specs).functions().forEach(function(method){loader[method]=function(){return specs[method].apply(loader,[].slice.call(arguments))}}),loader}return _=_&&_.hasOwnProperty("default")?_["default"]:_,Promise=Promise&&Promise.hasOwnProperty("default")?Promise["default"]:Promise,moduleLoaderFactory}),define("core/providerLoader",["lodash","core/moduleLoader"],function(_,moduleLoaderFactory){'use strict';function validateProvider(provider){return _.isPlainObject(provider)&&_.isFunction(provider.init)&&_.isString(provider.name)&&!_.isEmpty(provider.name)}function providerLoader(requiredProviders){return moduleLoaderFactory(requiredProviders,validateProvider,{getProviders:function(category){return this.getModules(category)}})}return _=_&&_.hasOwnProperty("default")?_["default"]:_,moduleLoaderFactory=moduleLoaderFactory&&moduleLoaderFactory.hasOwnProperty("default")?moduleLoaderFactory["default"]:moduleLoaderFactory,providerLoader}),define("core/providerRegistry",["lodash"],function(_){'use strict';return _=_&&_.hasOwnProperty("default")?_["default"]:_,function(target,validator){function registerProvider(name,provider){var valid=!0;if(!_.isString(name)||0>=name.length)throw new TypeError("It is required to give a name to your provider.");if(!_.isPlainObject(provider)||!_.isFunction(provider.init))throw new TypeError("A provider is an object that contains at least an init function.");return valid=validator&&_.isFunction(validator)?validator(provider):valid,valid&&(_providers[name]=provider),this}function getProvider(providerName){var provider;if(!_providers||0===_.size(_providers))throw new Error("No provider registered");if(_.isString(providerName)&&0<providerName.length?provider=_providers[providerName]:1===_.size(_providers)&&(providerName=_.keys(_providers)[0],provider=_providers[providerName]),!provider)throw new Error("No candidate found for the provider");return provider}function getAvailableProviders(){return _.keys(_providers)}var _providers={};return target=target||{},target.registerProvider=registerProvider,target.getProvider=getProvider,target.getAvailableProviders=getAvailableProviders,target.clearProviders=function(){return _providers={},this},target}}),define("taoItems/previewer/factory",["lodash","context","module","core/providerLoader","core/providerRegistry","util/url","taoItems/previewer/adapter/legacy"],function(_,context,module,providerLoaderFactory,providerRegistry,urlHelper,legacyPreviewer){'use strict';function previewerFactory(type,uri,state,config){return config=_.defaults(config||{},module.config()),providerLoaderFactory().addList(config.previewers).load(context.bundle).then(function(providers){previewerFactory.registerProvider(legacyPreviewer.name,legacyPreviewer),_.forEach(providers,function(provider){previewerFactory.registerProvider(provider.name,provider)})}).then(function(){return previewerFactory.getProvider(type||legacyPreviewer.name)}).then(function(provider){return provider.init(uri,state,config)})}return providerRegistry(previewerFactory,function(provider){if(!_.isFunction(provider.init))throw new TypeError("The previewer provider MUST have a init() method");return!0})}),define("taoItems/runner/api/itemRunner",["jquery","lodash","core/eventifier","taoItems/assets/manager"],function($,_,eventifier,assetManagerFactory){'use strict';var itemRunnerFactory=function itemRunnerFactory(providerName,data,options){var flow={init:{done:!1,pending:[]},render:{done:!1,pending:[]}},provider,providers,assetManager;if(_.isPlainObject(providerName)&&(data=providerName,providerName=void 0),data=data||{},options=options||{},providers=itemRunnerFactory.providers,!providers||0===_.size(providers))throw new Error("No provider regitered");if(_.isString(providerName)&&0<providerName.length?provider=providers[providerName]:1===_.size(providers)&&(providerName=_.keys(providers)[0],provider=providers[providerName]),!provider)throw new Error("No candidate found for the provider");return assetManager=options.assetManager||assetManagerFactory(function(url){return url.toString()}),eventifier({container:null,assetManager:assetManager,options:options,init:function init(newData){var self=this,initDone=function(){!1===flow.init.done&&(flow.init.done=!0,_.forEach(flow.init.pending,function(pendingTask){_.isFunction(pendingTask)&&pendingTask.call(self)}),flow.init.pending=[]),self.trigger("init")};return newData&&(data=_.merge(data,newData)),_.isFunction(provider.init)?provider.init.call(this,data,initDone):initDone(),this},assets:function(strategies,data,options){try{this.assetManager=assetManagerFactory(strategies,data,options)}catch(err){this.trigger("error","Something was wrong while configuring the asset manager : "+err)}return this},render:function render(elt,options){var self=this,renderDone=function(){!1===flow.render.done&&(flow.render.done=!0,_.forEach(flow.render.pending,function(pendingTask){_.isFunction(pendingTask)&&pendingTask.call(self)}),flow.render.pending=[]),self.trigger("render"),self.trigger("ready")};return(options=_.defaults(options||{},{state:{}}),!(elt instanceof HTMLElement)&&!(elt instanceof $))?self.trigger("error","A valid HTMLElement (or a jquery element) at least is required to render the item"):(options.state&&this.setState(options.state),!1===flow.init.done?flow.init.pending.push(function(){this.render(elt,options)}):(this.container=elt instanceof $?elt.get(0):elt,_.isFunction(provider.render)?provider.render.call(this,this.container,renderDone,options):renderDone()),this)},clear:function clear(){var self=this,clearDone=function(){self.trigger("clear")};return _.isFunction(provider.clear)?provider.clear.call(this,this.container,clearDone):clearDone(),this},getState:function getState(){var state=null;return _.isFunction(provider.getState)&&(state=provider.getState.call(this)),state},setState:function setState(state){return _.isPlainObject(state)?(!1===flow.render.done?flow.render.pending.push(function(){this.setState(state)}):_.isFunction(provider.setState)&&provider.setState.call(this,state),this):this.trigger("error","The item's state must be a JavaScript Plain Object: "+_typeof2(state)+" given")},getResponses:function getResponses(){var responses={};return _.isFunction(provider.getResponses)&&(responses=provider.getResponses.call(this)),responses},renderFeedbacks:function(feedbacks,itemSession,done){_.isFunction(provider.renderFeedbacks)&&provider.renderFeedbacks.call(this,feedbacks,itemSession,done)}})};return itemRunnerFactory.register=function(name,provider){if(!_.isString(name)||0>=name.length)throw new TypeError("It is required to give a name to your provider.");if(!_.isPlainObject(provider)||!_.isFunction(provider.init)&&!_.isFunction(provider.render))throw new TypeError("A provider is an object that contains at least an init function or a render function.");this.providers=this.providers||{},this.providers[name]=provider},itemRunnerFactory}),define("taoItems/runtime/ConsoleResultServer",["jquery"],function($){function ConsoleResultServer(){}return ConsoleResultServer.prototype.submitItemVariables=function(itemId,serviceCallId,responses,scores,events,callback){var previewConsole=$("#preview-console");if(0<previewConsole.length){var niceResponses="";for(var key in responses)niceResponses=niceResponses+key+" = "+responses[key]+"<br />";previewConsole.trigger("updateConsole",["RESPONSES",niceResponses.substring(0,niceResponses.length-2)]);var niceScore="";for(var key in scores)niceScore=niceScore+key+" = "+scores[key]+", ";previewConsole.trigger("updateConsole",["SCORE",niceScore.substring(0,niceScore.length-2)])}"function"==typeof callback&&callback()},ConsoleResultServer}),function(c){var d=document,s=d.createElement("style");s.type="text/css",d.getElementsByTagName("head")[0].appendChild(s),s.styleSheet?s.styleSheet.cssText=c:s.appendChild(d.createTextNode(c))}("body.preview-mode{height:100vh !important;max-height:100vh;overflow:hidden}body.no-preview-feedback .preview-overlay .preview-container{background:white;overflow:auto}body.no-preview-feedback .preview-overlay .preview-container .preview-item-container,body.no-preview-feedback .preview-overlay .preview-container #preview-container{min-height:calc(100vh - 82px) !important}.preview-overlay{display:none;width:100%;height:100%;z-index:19995;position:absolute;left:0;background:rgba(0,0,0,0.7)}.preview-overlay.preview-desktop{overflow:visible}.preview-overlay.preview-desktop .mobile-only,.preview-overlay.preview-desktop .standard-only{display:none !important}.preview-overlay.preview-mobile{overflow:visible}.preview-overlay.preview-mobile .desktop-only,.preview-overlay.preview-mobile .standard-only{display:none !important}.preview-overlay.preview-standard{overflow:visible}.preview-overlay.preview-standard .desktop-only,.preview-overlay.preview-standard .mobile-only{display:none !important}.preview-overlay .preview-scale-container{position:relative;float:left}.preview-overlay .preview-container{background:white;overflow:auto}.preview-overlay .preview-container .preview-item-container,.preview-overlay .preview-container #preview-container{min-height:calc(100vh - 130px) !important}.preview-overlay .preview-container-outer{display:table;padding:0;width:100%;height:100%}.preview-overlay .preview-utility-bar{background:#f3f1ef;border-bottom:1px solid #8d949e;margin-bottom:20px;z-index:9996;overflow:hidden;padding:10px;position:fixed;top:0;left:0;width:100%}.preview-overlay .preview-utility-bar .preview-heading{min-width:140px}.preview-overlay .preview-utility-bar .device-type-and-orientation{min-width:340px}.preview-overlay .preview-utility-bar-inner{max-width:1024px;width:100%;margin:auto}.preview-overlay .preview-utility-bar-inner h1{font-size:18px;font-size:1.8rem;text-shadow:1px 1px 0px #eee}.preview-overlay .preview-utility-bar-inner .icon-info{top:7px;font-size:15px;font-size:1.5rem}.preview-overlay .preview-utility-bar-inner li{margin-left:10px}.preview-overlay .preview-utility-bar-inner .btn-info{margin-top:1px}.preview-overlay .preview-utility-bar-inner .mobile-device-selector{width:200px}.preview-overlay .preview-utility-bar-inner .preview-type-selector{width:140px}.preview-overlay .preview-utility-bar-inner .preview-theme-selector{width:140px}.preview-overlay .preview-utility-bar-inner .orientation-selector,.preview-overlay .preview-utility-bar-inner .desktop-device-selector{width:130px}.preview-overlay .preview-utility-bar-inner [class*=\" col-\"],.preview-overlay .preview-utility-bar-inner [class^=\"col-\"]{margin-bottom:0 !important}.preview-overlay #preview-console{margin:0;padding:0;border:none;z-index:auto;background:#266d9c;position:fixed;bottom:0;left:0;width:100%}.preview-overlay #preview-console .preview-console-closer{position:absolute;right:10px;top:10px;cursor:pointer;color:rgba(255,255,255,0.9);display:none;text-shadow:none}.preview-overlay #preview-console .preview-console-closer:hover{color:white}.preview-overlay #preview-console .preview-console-header{max-width:1024px;width:100%;margin:auto;padding:0}.preview-overlay #preview-console .preview-console-header [class*=\" col-\"],.preview-overlay #preview-console .preview-console-header [class^=\"col-\"]{margin-bottom:0 !important}.preview-overlay #preview-console .extra-button-action-bar{overflow:visible}.preview-overlay #preview-console .extra-button-action-bar li{margin:0 5px}.preview-overlay #preview-console .extra-button-action-bar li.btn-info{border-color:rgba(255,255,255,0.3)}.preview-overlay #preview-console .extra-button-action-bar li.btn-info.btn-group{border:none !important;overflow:visible;padding:0}.preview-overlay #preview-console .extra-button-action-bar li.btn-info.btn-group a{float:left;margin:0 2px;padding:0 15px;border:1px solid rgba(255,255,255,0.3);border-radius:0px;display:inline-block;height:inherit}.preview-overlay #preview-console .extra-button-action-bar li.btn-info.btn-group a:first-of-type{border-top-left-radius:3px;border-bottom-left-radius:3px;margin-left:0}.preview-overlay #preview-console .extra-button-action-bar li.btn-info.btn-group a:last-of-type{border-top-right-radius:3px;border-bottom-right-radius:3px;margin-right:0}.preview-overlay #preview-console .extra-button-action-bar li.btn-info.btn-group a:hover,.preview-overlay #preview-console .extra-button-action-bar li.btn-info.btn-group a.active{border-color:rgba(255,255,255,0.8)}.preview-overlay #preview-console .extra-button-action-bar li.btn-info.btn-group a .no-label{padding-right:0}.preview-overlay #preview-console .extra-button-action-bar li.btn-info:hover,.preview-overlay #preview-console .extra-button-action-bar li.btn-info.active{border-color:rgba(255,255,255,0.8)}.preview-overlay #preview-console .extra-button-action-bar.horizontal-action-bar.bottom-action-bar{overflow:visible}.preview-overlay #preview-console .extra-button-action-bar.horizontal-action-bar.bottom-action-bar .action{line-height:1.6}.preview-overlay #preview-console .preview-console-body{display:none}.preview-overlay #preview-console .preview-console-body ul{padding:5px;margin:0;height:300px;overflow:auto;background:#2b2b2b;font-family:Consolas,\"Andale Mono WT\",\"Andale Mono\",\"Lucida Console\",\"Lucida Sans Typewriter\",\"DejaVu Sans Mono\",\"Bitstream Vera Sans Mono\",\"Liberation Mono\",\"Nimbus Mono L\",Monaco,\"Courier New\",Courier,monospace;color:#fff}.preview-overlay #preview-console .preview-console-body ul .log-time{color:#999}.preview-overlay #preview-console .preview-console-body ul .log-type{color:#eee}.preview-overlay #preview-console .preview-console-body ul .log-message{color:#69f}.preview-overlay #preview-console .preview-console-body ul pre{margin:0}.preview-overlay .preview-message-box .feedback-info{margin:10px auto 0px;width:800px}.preview-overlay .preview-message-box a{float:right;padding-right:10px}.preview-overlay .desktop-preview-container{width:1024px;background:white url(data:image/gif;base64,R0lGODlhHwAfAPUAAP///wAAAOjo6NLS0ry8vK6urqKiotzc3Li4uJqamuTk5NjY2KqqqqCgoLCwsMzMzPb29qioqNTU1Obm5jY2NiYmJlBQUMTExHBwcJKSklZWVvr6+mhoaEZGRsbGxvj4+EhISDIyMgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH+GkNyZWF0ZWQgd2l0aCBhamF4bG9hZC5pbmZvACH5BAAKAAAAIf8LTkVUU0NBUEUyLjADAQAAACwAAAAAHwAfAAAG/0CAcEgUDAgFA4BiwSQexKh0eEAkrldAZbvlOD5TqYKALWu5XIwnPFwwymY0GsRgAxrwuJwbCi8aAHlYZ3sVdwtRCm8JgVgODwoQAAIXGRpojQwKRGSDCRESYRsGHYZlBFR5AJt2a3kHQlZlERN2QxMRcAiTeaG2QxJ5RnAOv1EOcEdwUMZDD3BIcKzNq3BJcJLUABBwStrNBtjf3GUGBdLfCtadWMzUz6cDxN/IZQMCvdTBcAIAsli0jOHSJeSAqmlhNr0awo7RJ19TJORqdAXVEEVZyjyKtE3Bg3oZE2iK8oeiKkFZGiCaggelSTiA2LhxiZLBSjZjBL2siNBOFQ84LxHA+mYEiRJzBO7ZCQIAIfkEAAoAAQAsAAAAAB8AHwAABv9AgHBIFAwIBQPAUCAMBMSodHhAJK5XAPaKOEynCsIWqx0nCIrvcMEwZ90JxkINaMATZXfju9jf82YAIQxRCm14Ww4PChAAEAoPDlsAFRUgHkRiZAkREmoSEXiVlRgfQgeBaXRpo6MOQlZbERN0Qx4drRUcAAJmnrVDBrkVDwNjr8BDGxq5Z2MPyUQZuRgFY6rRABe5FgZjjdm8uRTh2d5b4NkQY0zX5QpjTc/lD2NOx+WSW0++2RJmUGJhmZVsQqgtCE6lqpXGjBchmt50+hQKEAEiht5gUcTIESR9GhlgE9IH0BiTkxrMmWIHDkose9SwcQlHDsOIk9ygiVbl5JgMLuV4HUmypMkTOkEAACH5BAAKAAIALAAAAAAfAB8AAAb/QIBwSBQMCAUDwFAgDATEqHR4QCSuVwD2ijhMpwrCFqsdJwiK73DBMGfdCcZCDWjAE2V347vY3/NmdXNECm14Ww4PChAAEAoPDltlDGlDYmQJERJqEhGHWARUgZVqaWZeAFZbERN0QxOeWwgAAmabrkMSZkZjDrhRkVtHYw+/RA9jSGOkxgpjSWOMxkIQY0rT0wbR2LQV3t4UBcvcF9/eFpdYxdgZ5hUYA73YGxruCbVjt78G7hXFqlhY/fLQwR0HIQdGuUrTz5eQdIc0cfIEwByGD0MKvcGSaFGjR8GyeAPhIUofQGNQSgrB4IsdOCqx7FHDBiYcOQshYjKDxliVDpRjunCjdSTJkiZP6AQBACH5BAAKAAMALAAAAAAfAB8AAAb/QIBwSBQMCAUDwFAgDATEqHR4QCSuVwD2ijhMpwrCFqsdJwiK73DBMGfdCcZCDWjAE2V347vY3/NmdXNECm14Ww4PChAAEAoPDltlDGlDYmQJERJqEhGHWARUgZVqaWZeAFZbERN0QxOeWwgAAmabrkMSZkZjDrhRkVtHYw+/RA9jSGOkxgpjSWOMxkIQY0rT0wbR2I3WBcvczltNxNzIW0693MFYT7bTumNQqlisv7BjswAHo64egFdQAbj0RtOXDQY6VAAUakihN1gSLaJ1IYOGChgXXqEUpQ9ASRlDYhT0xQ4cACJDhqDD5mRKjCAYuArjBmVKDP9+VRljMyMHDwcfuBlBooSCBQwJiqkJAgAh+QQACgAEACwAAAAAHwAfAAAG/0CAcEgUDAgFA8BQIAwExKh0eEAkrlcA9oo4TKcKwharHScIiu9wwTBn3QnGQg1owBNld+O72N/zZnVzRApteFsODwoQABAKDw5bZQxpQ2JkCRESahIRh1gEVIGVamlmXgBWWxETdEMTnlsIAAJmm65DEmZGYw64UZFbR2MPv0QPY0hjpMYKY0ljjMZCEGNK09MG0diN1gXL3M5bTcTcyFtOvdzBWE+207pjUKpYrL+wY7MAB4EerqZjUAG4lKVCBwMbvnT6dCXUkEIFK0jUkOECFEeQJF2hFKUPAIkgQwIaI+hLiJAoR27Zo4YBCJQgVW4cpMYDBpgVZKL59cEBhw+U+QROQ4bBAoUlTZ7QCQIAIfkEAAoABQAsAAAAAB8AHwAABv9AgHBIFAwIBQPAUCAMBMSodHhAJK5XAPaKOEynCsIWqx0nCIrvcMEwZ90JxkINaMATZXfju9jf82Z1c0QKbXhbDg8KEAAQCg8OW2UMaUNiZAkREmoSEYdYBFSBlWppZl4AVlsRE3RDE55bCAACZpuuQxJmRmMOuFGRW0djD79ED2NIY6TGCmNJY4zGQhBjStPTFBXb21DY1VsGFtzbF9gAzlsFGOQVGefIW2LtGhvYwVgDD+0V17+6Y6BwaNfBwy9YY2YBcMAPnStTY1B9YMdNiyZOngCFGuIBxDZAiRY1eoTvE6UoDEIAGrNSUoNBUuzAaYlljxo2M+HIeXiJpRsRNMaq+JSFCpsRJEqYOPH2JQgAIfkEAAoABgAsAAAAAB8AHwAABv9AgHBIFAwIBQPAUCAMBMSodHhAJK5XAPaKOEynCsIWqx0nCIrvcMEwZ90JxkINaMATZXfjywjlzX9jdXNEHiAVFX8ODwoQABAKDw5bZQxpQh8YiIhaERJqEhF4WwRDDpubAJdqaWZeAByoFR0edEMTolsIAA+yFUq2QxJmAgmyGhvBRJNbA5qoGcpED2MEFrIX0kMKYwUUslDaj2PA4soGY47iEOQFY6vS3FtNYw/m1KQDYw7mzFhPZj5JGzYGipUtESYowzVmF4ADgOCBCZTgFQAxZBJ4AiXqT6ltbUZhWdToUSR/Ii1FWbDnDkUyDQhJsQPn5ZU9atjUhCPHVhgTNy/RSKsiqKFFbUaQKGHiJNyXIAAh+QQACgAHACwAAAAAHwAfAAAG/0CAcEh8JDAWCsBQIAwExKhU+HFwKlgsIMHlIg7TqQeTLW+7XYIiPGSAymY0mrFgA0LwuLzbCC/6eVlnewkADXVECgxcAGUaGRdQEAoPDmhnDGtDBJcVHQYbYRIRhWgEQwd7AB52AGt7YAAIchETrUITpGgIAAJ7ErdDEnsCA3IOwUSWaAOcaA/JQ0amBXKa0QpyBQZyENFCEHIG39HcaN7f4WhM1uTZaE1y0N/TacZoyN/LXU+/0cNyoMxCUytYLjm8AKSS46rVKzmxADhjlCACMFGkBiU4NUQRxS4OHijwNqnSJS6ZovzRyJAQo0NhGrgs5bIPmwWLCLHsQsfhxBWTe9QkOzCwC8sv5Ho127akyRM7QQAAOwAAAAAAAAAAAA==) no-repeat center 150px}.preview-overlay .desktop-preview-frame{position:relative;border:3px #aaa solid;border-radius:5px;background:#5a5a5a;background:linear-gradient(135deg, #5a5a5a 0%, #565656 7%, #444 15%, #141414 30%);box-shadow:5px 5px 10px 0 rgba(0,0,0,0.7)}.preview-overlay .desktop-preview-frame.desktop-preview-landscape{padding:30px 30px}.preview-overlay .desktop-preview-frame.desktop-preview-landscape .desktop-device-toolbar{padding-right:30px}.preview-overlay .desktop-preview-frame.desktop-preview-portrait{padding:30px 30px}.preview-overlay .desktop-preview-frame.desktop-preview-portrait .desktop-device-toolbar{padding-right:30px}.preview-overlay .desktop-preview-item-container{min-height:500px;-webkit-box-shadow:0px 0px 8px #b7b1ac;-moz-box-shadow:0px 0px 8px #b7b1ac;box-shadow:0px 0px 8px #b7b1ac}.preview-overlay .preview-canvas{display:table-cell;text-align:center}.preview-overlay .preview-canvas *{text-align:left}.preview-overlay .preview-outer-frame{position:relative;display:inline-block}.preview-overlay .mobile-preview-container{-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box;position:relative}.preview-overlay .mobile-preview-item-container{height:100%}.preview-overlay .mobile-preview-frame{position:relative;border:3px #aaa ridge;border-radius:25px;background:#5a5a5a;background:linear-gradient(135deg, #5a5a5a 0%, #565656 7%, #444 15%, #141414 30%);box-shadow:5px 5px 10px 0 rgba(0,0,0,0.7)}.preview-overlay .mobile-preview-frame.mobile-preview-landscape{padding:40px 40px}.preview-overlay .mobile-preview-frame.mobile-preview-landscape .mobile-device-toolbar{padding-right:40px}.preview-overlay .mobile-preview-frame.mobile-preview-portrait{padding:40px 40px}.preview-overlay .mobile-preview-frame.mobile-preview-portrait .mobile-device-toolbar{padding-right:40px}.preview-overlay .mobile-preview-container{background:white;border-radius:3px;border:2px solid;border-color:#444 #999 #999 #444}.preview-overlay .standard-preview-frame{box-shadow:0px 0px 8px rgba(0,0,0,0.7)}\n\n/*# sourceMappingURL=preview.css.map *//*\nUsage:\n- linear-gradient((color1, color2, color3)) - returns linear-gradient with evenly distributed colors,\n   if 3 colors used then the position of each will be 33,33%\n- linear-gradient((color1 0%, color2 30%, color3 80%)) - returns linear-gradient with manually distributed colors,\n   first param - color, second - position. Also you can use px or other valid units for set position.\n*/\n/* Do not edit */\n/* Style of advanced components */\n/* toggler */\n.toggler:after {\n    margin-left: 3px;\n    position: relative;\n    top: 2px;\n    /* use !important to prevent issues with browser extensions that change fonts */\n    font-family: 'tao' !important;\n    speak: none;\n    font-style: normal;\n    font-weight: normal;\n    font-variant: normal;\n    text-transform: none;\n    line-height: 1;\n    /* Better Font Rendering =========== */\n    -webkit-font-smoothing: antialiased;\n    -moz-osx-font-smoothing: grayscale;\n    content: \"\\e611\";\n}\n\n.toggler.opened:after {\n    /* use !important to prevent issues with browser extensions that change fonts */\n    font-family: 'tao' !important;\n    speak: none;\n    font-style: normal;\n    font-weight: normal;\n    font-variant: normal;\n    text-transform: none;\n    line-height: 1;\n    /* Better Font Rendering =========== */\n    -webkit-font-smoothing: antialiased;\n    -moz-osx-font-smoothing: grayscale;\n    content: \"\\e610\";\n}\n\n.toggled {\n    display: none;\n}\n\n/* Adder */\n.adder:before {\n    margin-right: 5px;\n    font-size: 10.5px;\n    font-size: 1.05rem;\n    /* use !important to prevent issues with browser extensions that change fonts */\n    font-family: 'tao' !important;\n    speak: none;\n    font-style: normal;\n    font-weight: normal;\n    font-variant: normal;\n    text-transform: none;\n    line-height: 1;\n    /* Better Font Rendering =========== */\n    -webkit-font-smoothing: antialiased;\n    -moz-osx-font-smoothing: grayscale;\n    content: \"\\e636\";\n}\n\n/* Closer / Deleter */\n.closer:before, .deleter:before {\n    margin-right: 5px;\n    font-size: 10.5px;\n    font-size: 1.05rem;\n    /* use !important to prevent issues with browser extensions that change fonts */\n    font-family: 'tao' !important;\n    speak: none;\n    font-style: normal;\n    font-weight: normal;\n    font-variant: normal;\n    text-transform: none;\n    line-height: 1;\n    /* Better Font Rendering =========== */\n    -webkit-font-smoothing: antialiased;\n    -moz-osx-font-smoothing: grayscale;\n    content: \"\\e637\";\n}\n\n.undobox {\n    display: block;\n    position: fixed;\n    top: 50px;\n    left: 50%;\n    margin-left: -200px;\n    width: 400px;\n    z-index: 100005;\n}\n\n/* Incrementer and duration */\ninput[data-increment], input.duration-ctrl {\n    width: 40px !important;\n    min-width: 40px !important;\n    text-align: right;\n}\n\n.duration-ctrl-wrapper, .incrementer-ctrl-wrapper {\n    position: relative;\n    display: inline-block;\n    border: 1px solid #ddd;\n    border-radius: 2px;\n    border-radius: 2px;\n}\n\n.duration-ctrl-wrapper .incrementer, .incrementer-ctrl-wrapper .incrementer {\n    text-align: right;\n    border: none;\n    padding-right: 18px;\n}\n\n.duration-ctrl-wrapper .incrementer ~ .incrementer-ctrl, .incrementer-ctrl-wrapper .incrementer ~ .incrementer-ctrl {\n    border-left: 1px #ddd solid;\n    display: inline-block;\n    height: 100%;\n    position: absolute;\n    right: 0;\n    top: 0;\n}\n\n.duration-ctrl-wrapper .incrementer ~ .incrementer-ctrl > a, .incrementer-ctrl-wrapper .incrementer ~ .incrementer-ctrl > a {\n    outline: 0 !important;\n    cursor: pointer;\n    display: inline-block;\n    line-height: 13px;\n    color: #222;\n    background: #f3f1ef;\n    padding: 0 4px 0 4px;\n    font-size: 10.5px;\n    font-size: 1.05rem;\n    position: absolute;\n    right: 0;\n    height: 50%;\n    text-align: center;\n}\n\n.duration-ctrl-wrapper .incrementer ~ .incrementer-ctrl > a.inc, .incrementer-ctrl-wrapper .incrementer ~ .incrementer-ctrl > a.inc {\n    top: 0;\n    border-top-right-radius: 2px;\n}\n\n.duration-ctrl-wrapper .incrementer ~ .incrementer-ctrl > a.dec, .incrementer-ctrl-wrapper .incrementer ~ .incrementer-ctrl > a.dec {\n    top: 50%;\n    border-bottom-right-radius: 2px;\n}\n\n.duration-ctrl-wrapper .incrementer ~ .incrementer-ctrl > a.inc:before, .incrementer-ctrl-wrapper .incrementer ~ .incrementer-ctrl > a.inc:before {\n    position: relative;\n    bottom: 0px;\n    /* use !important to prevent issues with browser extensions that change fonts */\n    font-family: 'tao' !important;\n    speak: none;\n    font-style: normal;\n    font-weight: normal;\n    font-variant: normal;\n    text-transform: none;\n    line-height: 1;\n    /* Better Font Rendering =========== */\n    -webkit-font-smoothing: antialiased;\n    -moz-osx-font-smoothing: grayscale;\n    content: \"\\e610\";\n}\n\n.duration-ctrl-wrapper .incrementer ~ .incrementer-ctrl > a.dec:before, .incrementer-ctrl-wrapper .incrementer ~ .incrementer-ctrl > a.dec:before {\n    position: relative;\n    top: 0px;\n    /* use !important to prevent issues with browser extensions that change fonts */\n    font-family: 'tao' !important;\n    speak: none;\n    font-style: normal;\n    font-weight: normal;\n    font-variant: normal;\n    text-transform: none;\n    line-height: 1;\n    /* Better Font Rendering =========== */\n    -webkit-font-smoothing: antialiased;\n    -moz-osx-font-smoothing: grayscale;\n    content: \"\\e611\";\n}\n\n.duration-ctrl-wrapper .incrementer ~ .incrementer-ctrl > a:hover, .incrementer-ctrl-wrapper .incrementer ~ .incrementer-ctrl > a:hover {\n    background-color: #3e7da7;\n    color: white;\n}\n\n.duration-ctrl-wrapper ~ .separator {\n    padding: 0 3px;\n    text-align: center;\n    opacity: .7;\n}\n\n/* InPlacer */\n[data-in-place], .inplace {\n    cursor: pointer;\n    min-height: 1em;\n}\n\n[data-in-place] input, .inplace input {\n    cursor: auto;\n}\n\n[data-in-place]:hover, .inplace:hover {\n    border: dotted 1px #3e7da7;\n}\n\n/* ListBox  */\nul.listbox {\n    margin: .1em 0;\n    padding: 0;\n    list-style-type: none;\n    display: block;\n}\n\nul.listbox > li {\n    white-space: no-wrap;\n    position: relative;\n    min-width: 75%;\n    border: solid 1px #ddd;\n    border-bottom-width: 0;\n    vertical-align: top;\n    margin: 0;\n    padding: .3em 2em .3em .2em;\n    background-color: #f3f1ef;\n    min-height: 1.5em;\n}\n\nul.listbox > li > .closer, ul.listbox > li > .deleter {\n    position: absolute;\n    right: 5px;\n    top: 0;\n}\n\nul.listbox > li:first-child {\n    border-radius: 2px 2px 0 0;\n}\n\nul.listbox > li:last-child {\n    border-radius: 0 0 2px 2px;\n    border-bottom-width: 1px;\n}\n\nul.listbox > li.placeholder {\n    background: none;\n    margin: .5em;\n    opacity: 0.6;\n}\n\n/* Modal styles */\n.modal {\n    background-color: white;\n    border: 1px solid #ddd;\n    box-shadow: 3px 3px 5px #666666;\n    height: auto;\n    opacity: 0;\n    top: -1000px;\n    padding: 40px;\n    position: fixed;\n    z-index: 105002;\n    margin: auto;\n    left: 0;\n    right: 0;\n    overflow: hidden;\n}\n\n.modal .modal-close {\n    position: absolute;\n    right: 12px;\n    top: 10px;\n    cursor: pointer;\n    font-weight: bold;\n    color: #222;\n}\n\n.modal .modal-close:hover {\n    opacity: 0.6;\n}\n\n.modal .modal-close .icon-close {\n    font-size: 20px;\n    font-size: 2rem;\n}\n\n.modal button.modal-close {\n    color: #222 !important;\n    background-color: transparent;\n    padding: 0;\n    height: 20px;\n}\n\n.modal button.modal-close .icon-close {\n    padding: 0;\n}\n\n.modal .modal-body h4 {\n    font-size: 16px;\n    font-size: 1.6rem;\n    margin-top: 0;\n    margin-bottom: 8px;\n}\n\n.modal .modal-body .content, .modal .modal-body .message {\n    margin-bottom: 8px;\n}\n\n.modal .modal-body .buttons {\n    top: 16px;\n    position: relative;\n}\n\n.modal .modal-body .buttons button {\n    border-radius: 2px;\n    margin-left: 8px;\n    height: 36px;\n    text-shadow: none;\n    text-transform: uppercase;\n    color: #0e5d91 !important;\n    background: none;\n}\n\n.modal .modal-body .buttons button:focus, .modal .modal-body .buttons button:hover {\n    background: #dbe7ef;\n}\n\n.modal[class^=\"icon-\"]:before, .modal[class*=\" icon-\"]:before {\n    font-size: 44px;\n    font-size: 4.4rem;\n    color: #0e5d91;\n    position: absolute;\n}\n\n.modal[class^=\"icon-\"].icon-result-nok:before, .modal[class*=\" icon-\"].icon-result-nok:before {\n    color: #ba122b;\n}\n\n.modal[class^=\"icon-\"].icon-warning:before, .modal[class*=\" icon-\"].icon-warning:before {\n    color: #c96043;\n}\n\n.modal[class^=\"icon-\"].icon-result-ok:before, .modal[class*=\" icon-\"].icon-result-ok:before {\n    color: #0e914b;\n}\n\n.modal[class^=\"icon-\"].error:before, .modal[class*=\" icon-\"].error:before {\n    color: #ba122b;\n}\n\n.modal[class^=\"icon-\"].danger:before, .modal[class*=\" icon-\"].danger:before {\n    color: #c96043;\n}\n\n.modal[class^=\"icon-\"].warning:before, .modal[class*=\" icon-\"].warning:before {\n    color: #d8ae5b;\n}\n\n.modal[class^=\"icon-\"].info:before, .modal[class*=\" icon-\"].info:before {\n    color: #0e5d91;\n}\n\n.modal[class^=\"icon-\"].success:before, .modal[class*=\" icon-\"].success:before {\n    color: #0e914b;\n}\n\n.modal[class^=\"icon-\"] .modal-body, .modal[class*=\" icon-\"] .modal-body {\n    font-family: \"Source Sans Pro\", sans-serif !important;\n    line-height: 1.4;\n    margin-left: 8.5rem;\n}\n\n.modal-bg {\n    background: none repeat scroll 0 0 black;\n    opacity: 0.45;\n    -ms-filter: \"progid:DXImageTransform.Microsoft.Alpha(Opacity=45)\";\n    filter: alpha(opacity=45);\n    display: none;\n    position: fixed;\n    height: 100%;\n    width: 100%;\n    left: 0;\n    top: 0;\n    z-index: 100001;\n    overflow: hidden;\n}\n\n/* Button groups */\nul[data-button-group], ul.button-group {\n    list-style-type: none;\n    padding: 0;\n    background-color: white;\n    border: 1px solid #ddd;\n    border-radius: 1px;\n    margin: 0 2px 2px 0;\n    display: inline-block;\n    border-radius: 2px;\n    font-size: 12px;\n    font-size: 1.2rem;\n}\n\nul[data-button-group] > li, ul.button-group > li {\n    border: 0 none;\n    color: #222;\n    cursor: pointer;\n    display: inline-block;\n    float: left;\n    min-width: 26px;\n    padding: 4px 6px;\n    text-align: center;\n    text-decoration: none !important;\n}\n\nul[data-button-group] > li.active, ul.button-group > li.active {\n    color: white;\n    background-color: #0e5d91;\n    transition: all 0.4s ease;\n}\n\nul[data-button-group] > li:hover, ul.button-group > li:hover {\n    color: white;\n    background-color: #3e7da7;\n    transition: all 0.4s ease;\n}\n\nul[data-button-group] > li.separator, ul.button-group > li.separator {\n    background-color: #ddd;\n    float: left;\n    height: 18px;\n    margin: 5px 2px 0 2px;\n    width: 1px;\n    min-width: 1px;\n    padding: 0;\n}\n\nul[data-button-group] > li[class^=\"icon-\"], ul[data-button-group] > li[class*=\" icon-\"], ul.button-group > li[class^=\"icon-\"], ul.button-group > li[class*=\" icon-\"] {\n    height: 16px;\n    margin-top: 1px;\n    width: 16px;\n    padding-top: 2px;\n}\n\n/* Media Preview */\n.previewer {\n    background-color: white;\n    margin: 5px;\n    min-width: 280px;\n    min-height: 200px;\n    text-align: center;\n}\n\n.previewer .nopreview {\n    color: #ddd;\n    text-align: center;\n    font-size: 20px;\n    font-size: 2rem;\n}\n\n.previewer .nopreview:before {\n    font-size: 60px;\n    font-size: 6rem;\n    /* use !important to prevent issues with browser extensions that change fonts */\n    font-family: 'tao' !important;\n    speak: none;\n    font-style: normal;\n    font-weight: normal;\n    font-variant: normal;\n    text-transform: none;\n    line-height: 1;\n    /* Better Font Rendering =========== */\n    -webkit-font-smoothing: antialiased;\n    -moz-osx-font-smoothing: grayscale;\n    content: \"\\e670\";\n    display: block !important;\n}\n\n/* Progress bar */\n.progressbar {\n    height: 2em;\n    text-align: left;\n    border: none;\n    height: 0.8em;\n    background-color: white;\n    border: 1px solid #ddd;\n}\n\n.progressbar > span {\n    height: 100%;\n    border: none;\n    background-color: #3e7da7;\n    display: block;\n    color: white;\n    transition: width 0.4s ease 0s;\n}\n\n.progressbar.info > span {\n    background-color: #0e5d91;\n}\n\n.progressbar.success > span {\n    background-color: #0e914b;\n}\n\n.progressbar.warning > span {\n    background-color: #d8ae5b;\n}\n\n.progressbar.error > span {\n    background-color: #ba122b;\n}\n\n/*# sourceMappingURL=components.css.map *//*\nUsage:\n- linear-gradient((color1, color2, color3)) - returns linear-gradient with evenly distributed colors,\n   if 3 colors used then the position of each will be 33,33%\n- linear-gradient((color1 0%, color2 30%, color3 80%)) - returns linear-gradient with manually distributed colors,\n   first param - color, second - position. Also you can use px or other valid units for set position.\n*/\n/* Do not edit */\n.class-selector {\n    padding: 5px;\n    position: relative;\n    opacity: 0;\n}\n\n.class-selector.rendered {\n    opacity: 1;\n    transition: opacity, 300ms, linear, 0s;\n}\n\n.class-selector a.selected {\n    display: inline-block;\n    position: relative;\n    border: 1px solid #ddd;\n    border-radius: 2px;\n    border-radius: 3px;\n    padding: 3px 20px 3px 10px;\n    text-decoration: none;\n    width: 100%;\n    background-color: white;\n}\n\n.class-selector a.selected.empty {\n    color: #a4a9b1;\n}\n\n.class-selector a.selected:after {\n    /* use !important to prevent issues with browser extensions that change fonts */\n    font-family: 'tao' !important;\n    speak: none;\n    font-style: normal;\n    font-weight: normal;\n    font-variant: normal;\n    text-transform: none;\n    line-height: 1;\n    /* Better Font Rendering =========== */\n    -webkit-font-smoothing: antialiased;\n    -moz-osx-font-smoothing: grayscale;\n    content: \"\\e611\";\n    position: absolute;\n    right: 10px;\n    top: 7px;\n}\n\n.class-selector .options {\n    position: absolute;\n    width: 100%;\n    background-color: #f3f1ef;\n    border: solid 1px #ddd;\n    -webkit-border-bottom-right-radius: 3px;\n    -webkit-border-bottom-left-radius: 3px;\n    -moz-border-radius-bottomright: 3px;\n    -moz-border-radius-bottomleft: 3px;\n    border-bottom-right-radius: 3px;\n    border-bottom-left-radius: 3px;\n    -ms-box-shadow: 1px 1px 2px 0 rgba(0, 0, 0, 0.2);\n    -o-box-shadow: 1px 1px 2px 0 rgba(0, 0, 0, 0.2);\n    box-shadow: 1px 1px 2px 0 rgba(0, 0, 0, 0.2);\n    left: 0;\n    margin-top: 7px;\n    overflow-y: auto;\n    z-index: 100;\n    min-height: 100px;\n    max-height: 450px;\n    transition: max-height, 300ms, ease, 0s;\n}\n\n.class-selector .options.folded {\n    overflow: hidden;\n    min-height: 0;\n    max-height: 0;\n    border-width: 0;\n    transition: max-height, 300ms, ease, 0s;\n}\n\n.class-selector .options ul {\n    list-style-type: none;\n    padding: 0;\n    margin: 0 0 0 15px;\n}\n\n.class-selector .options ul li {\n    padding-top: 3px;\n}\n\n.class-selector .options ul li a {\n    text-decoration: none;\n    color: #222;\n}\n\n.class-selector .options ul li a:hover {\n    color: #0e5d91;\n    transition: color, 200ms, linear, 0s;\n}\n\n.class-selector .options ul li:before {\n    /* use !important to prevent issues with browser extensions that change fonts */\n    font-family: 'tao' !important;\n    speak: none;\n    font-style: normal;\n    font-weight: normal;\n    font-variant: normal;\n    text-transform: none;\n    line-height: 1;\n    /* Better Font Rendering =========== */\n    -webkit-font-smoothing: antialiased;\n    -moz-osx-font-smoothing: grayscale;\n    content: \"\\e60c\";\n    color: #d8ae5b;\n    top: 2px;\n    -webkit-text-shadow: 1px 1px 0 #ad8b49;\n    -moz-text-shadow: 1px 1px 0 #ad8b49;\n    text-shadow: 1px 1px 0 #ad8b49;\n    margin-right: 4px;\n}\n\n.class-selector .options > ul {\n    margin: 5px 0 0 7px;\n}\n\n/*# sourceMappingURL=selector.css.map *//*\nUsage:\n- linear-gradient((color1, color2, color3)) - returns linear-gradient with evenly distributed colors,\n   if 3 colors used then the position of each will be 33,33%\n- linear-gradient((color1 0%, color2 30%, color3 80%)) - returns linear-gradient with manually distributed colors,\n   first param - color, second - position. Also you can use px or other valid units for set position.\n*/\n/* Do not edit */\n.ui-generis-validator {\n    color: #ba122b;\n    text-align: right;\n    width: 99%;\n}\n\n.ui-generis-validator input.error,\n.ui-generis-validator select.error,\n.ui-generis-validator textarea.error {\n    border-color: #ba122b;\n    color: #ba122b;\n}\n\n/*# sourceMappingURL=validator.css.map *//*\nUsage:\n- linear-gradient((color1, color2, color3)) - returns linear-gradient with evenly distributed colors,\n   if 3 colors used then the position of each will be 33,33%\n- linear-gradient((color1 0%, color2 30%, color3 80%)) - returns linear-gradient with manually distributed colors,\n   first param - color, second - position. Also you can use px or other valid units for set position.\n*/\n/* Do not edit */\n.ui-generis-widget {\n    margin: 10px 0px;\n}\n\n.ui-generis-widget > .left {\n    display: inline-block;\n    margin-top: 8px;\n    width: 34%;\n    vertical-align: top;\n}\n\n.ui-generis-widget > .right {\n    display: inline-block;\n    min-width: 150px;\n    width: 65%;\n}\n\n.ui-generis-widget > .right > input,\n.ui-generis-widget > .right > select,\n.ui-generis-widget > .right > textarea {\n    background-color: white;\n    border: 1px solid #ddd;\n    border-radius: 2px;\n    -webkit-border-radius: 2px;\n    color: #222;\n    font-family: \"Source Sans Pro\", sans-serif;\n    padding: 8px;\n    width: 100%;\n}\n\n.ui-generis-widget > .right > input,\n.ui-generis-widget > .right > select {\n    font: inherit;\n    height: 36px;\n}\n\n.ui-generis-widget > .right > .check-box-input {\n    color: #222;\n    display: inline-block;\n    font-family: \"Source Sans Pro\", sans-serif;\n    padding: 4px;\n    width: 100%;\n}\n\n.ui-generis-widget > .right > .check-box-input > .option {\n    padding-top: 4px;\n}\n\n.ui-generis-widget > .right input.error,\n.ui-generis-widget > .right select.error,\n.ui-generis-widget > .right textarea.error,\n.ui-generis-widget > .right .check-box-input.error {\n    border-color: #ba122b;\n    color: #ba122b;\n}\n\n.ui-generis-widget .validation-container {\n    color: #ba122b;\n    text-align: right;\n    width: 99%;\n}\n\n/*# sourceMappingURL=widget.css.map *//*\nUsage:\n- linear-gradient((color1, color2, color3)) - returns linear-gradient with evenly distributed colors,\n   if 3 colors used then the position of each will be 33,33%\n- linear-gradient((color1 0%, color2 30%, color3 80%)) - returns linear-gradient with manually distributed colors,\n   first param - color, second - position. Also you can use px or other valid units for set position.\n*/\n/* Do not edit */\n.ui-generis-form {\n    border: 1px solid #ddd;\n    border-radius: 2px;\n    -webkit-border-radius: 2px;\n    background-color: #f3f1ef;\n    padding: 20px;\n    position: relative;\n    margin: 20px;\n    width: 500px;\n}\n\n.ui-generis-form h2 {\n    margin-top: 0;\n}\n\n.ui-generis-form .toolbar {\n    margin-top: 30px;\n    text-align: right;\n}\n\n@keyframes spinner {\n    to {\n        transform: rotate(360deg);\n    }\n}\n\n/*# sourceMappingURL=form.css.map *//*\nUsage:\n- linear-gradient((color1, color2, color3)) - returns linear-gradient with evenly distributed colors,\n   if 3 colors used then the position of each will be 33,33%\n- linear-gradient((color1 0%, color2 30%, color3 80%)) - returns linear-gradient with manually distributed colors,\n   first param - color, second - position. Also you can use px or other valid units for set position.\n*/\n/* Do not edit */\n.resource-selector {\n    position: relative;\n    height: 100%;\n    display: box;\n    display: -webkit-flexbox;\n    display: flexbox;\n    display: -ms-flex;\n    display: flex;\n    flex-direction: column;\n    flex-wrap: nowrap;\n    flex-pack: start;\n    justify-content: flex-start;\n    flex-line-pack: start;\n    align-content: flex-start;\n    flex-align: stretch;\n    align-items: stretch;\n    opacity: 0;\n    background-color: #f3f1ef;\n    border: 1px solid #ddd;\n    border-radius: 2px;\n    -webkit-border-radius: 2px;\n}\n\n.resource-selector.rendered {\n    opacity: 1;\n    transition: opacity, 300ms, linear, 0s;\n}\n\n.resource-selector .resource-list {\n    position: relative;\n    height: 100%;\n    opacity: 0;\n}\n\n.resource-selector .resource-list.rendered {\n    opacity: 1;\n    transition: opacity, 300ms, linear, 0s;\n}\n\n.resource-selector .resource-list.multiple ul li a:after {\n    display: block;\n    transition: all, 200ms, linear, 0s;\n}\n\n.resource-selector .resource-list ul {\n    list-style-type: none;\n    padding: 0;\n    margin: 0;\n}\n\n.resource-selector .resource-list ul li {\n    position: relative;\n    height: 40px;\n    padding: 10px;\n    border-bottom: solid 1px #ddd;\n    transition: background-color, 200ms, linear, 0s;\n}\n\n.resource-selector .resource-list ul li a {\n    transition: color, 200ms, linear, 0s;\n    color: #222;\n    display: inline-block;\n    width: 100%;\n    padding-right: 25px;\n    overflow: hidden;\n    white-space: nowrap;\n    text-overflow: ellipsis;\n}\n\n.resource-selector .resource-list ul li a:after {\n    /* use !important to prevent issues with browser extensions that change fonts */\n    font-family: 'tao' !important;\n    speak: none;\n    font-style: normal;\n    font-weight: normal;\n    font-variant: normal;\n    text-transform: none;\n    line-height: 1;\n    /* Better Font Rendering =========== */\n    -webkit-font-smoothing: antialiased;\n    -moz-osx-font-smoothing: grayscale;\n    content: \"\\e69b\";\n    color: #0e5d91;\n    position: absolute;\n    right: 17px;\n    top: 12px;\n    display: none;\n}\n\n.resource-selector .resource-list ul li a:hover {\n    text-decoration: none;\n}\n\n.resource-selector .resource-list ul li a > span {\n    color: #0e5d91;\n    margin-right: 4px;\n    font-size: 16px;\n    font-size: 1.6rem;\n    vertical-align: top;\n}\n\n.resource-selector .resource-list ul li.selected, .resource-selector .resource-list ul li:hover {\n    background-color: #3e7da7;\n    cursor: pointer;\n    transition: background-color, 200ms, linear, 0s;\n}\n\n.resource-selector .resource-list ul li.selected a, .resource-selector .resource-list ul li:hover a {\n    color: white;\n    transition: color, 200ms, linear, 0s;\n}\n\n.resource-selector .resource-list ul li.selected a:after, .resource-selector .resource-list ul li:hover a:after {\n    color: white;\n}\n\n.resource-selector .resource-list ul li.selected a > span, .resource-selector .resource-list ul li:hover a > span {\n    color: white;\n}\n\n.resource-selector .resource-list ul li.selected a:after {\n    content: \"\\e69d\";\n}\n\n.resource-selector .resource-list ul li[data-access=denied] > a [class^=\"icon-\"], .resource-selector .resource-list ul li[data-access=denied] > a [class*=\" icon-\"], .resource-selector .resource-list ul li[data-access=partial] > a [class^=\"icon-\"], .resource-selector .resource-list ul li[data-access=partial] > a [class*=\" icon-\"] {\n    position: relative;\n}\n\n.resource-selector .resource-list ul li[data-access=denied] > a [class^=\"icon-\"]:after, .resource-selector .resource-list ul li[data-access=denied] > a [class*=\" icon-\"]:after, .resource-selector .resource-list ul li[data-access=partial] > a [class^=\"icon-\"]:after, .resource-selector .resource-list ul li[data-access=partial] > a [class*=\" icon-\"]:after {\n    content: \"\\e629\";\n    color: #555;\n    position: absolute;\n    left: 7px;\n    top: 6px;\n}\n\n.resource-selector .resource-list ul li[data-access=denied] {\n    color: #a4a9b1;\n    background-color: white;\n}\n\n.resource-selector .resource-list ul li[data-access=denied]:hover, .resource-selector .resource-list ul li[data-access=denied]:hover > a, .resource-selector .resource-list ul li[data-access=denied] > a, .resource-selector .resource-list ul li[data-access=denied] [class^=\"icon-\"]:before, .resource-selector .resource-list ul li[data-access=denied] [class*=\" icon-\"]:before {\n    cursor: auto;\n    background-color: white;\n    color: #a4a9b1 !important;\n}\n\n.resource-selector .resource-tree {\n    position: relative;\n    height: 100%;\n    opacity: 0;\n}\n\n.resource-selector .resource-tree.rendered {\n    opacity: 1;\n    transition: opacity, 300ms, linear, 0s;\n}\n\n.resource-selector .resource-tree.multiple ul li.selectable > a > .selector {\n    display: inline-block;\n}\n\n.resource-selector .resource-tree .clickable:hover:before {\n    content: \" \";\n    display: inline-block;\n    position: absolute;\n    width: 25px;\n    height: 25px;\n    top: 7.5px;\n    left: 0;\n    border-radius: 50%;\n    background-color: #b9bfc3;\n    opacity: .5;\n}\n\n.resource-selector .resource-tree .clickable:focus {\n    outline: 0 none;\n}\n\n.resource-selector .resource-tree ul {\n    list-style-type: none;\n    padding: 0;\n    margin: 0;\n}\n\n.resource-selector .resource-tree ul li {\n    position: relative;\n    cursor: pointer;\n}\n\n.resource-selector .resource-tree ul li > a {\n    height: 40px;\n    line-height: 40px;\n    display: block;\n    width: 100%;\n    padding-right: 30px;\n    overflow: hidden;\n    white-space: nowrap;\n    text-overflow: ellipsis;\n    border-bottom: solid 1px #ddd;\n    color: #222;\n}\n\n.resource-selector .resource-tree ul li.class .class-toggler {\n    display: inline-block;\n    position: relative;\n    width: 25px;\n    height: 40px;\n    text-align: center;\n}\n\n.resource-selector .resource-tree ul li.class .class-toggler:after {\n    /* use !important to prevent issues with browser extensions that change fonts */\n    font-family: 'tao' !important;\n    speak: none;\n    font-style: normal;\n    font-weight: normal;\n    font-variant: normal;\n    text-transform: none;\n    line-height: 1;\n    /* Better Font Rendering =========== */\n    -webkit-font-smoothing: antialiased;\n    -moz-osx-font-smoothing: grayscale;\n    content: \"\\e611\";\n    font-size: 15px;\n    font-size: 1.5rem;\n    position: relative;\n}\n\n.resource-selector .resource-tree ul li.class.empty .class-toggler {\n    visibility: hidden;\n}\n\n.resource-selector .resource-tree ul li.class > a > .icon-folder:before {\n    content: \"\\e60d\";\n    color: #d8ae5b;\n    margin-right: 4px;\n}\n\n.resource-selector .resource-tree ul li.class > a:hover {\n    background-color: #e7eff4;\n    color: #222;\n    transition: all, 200ms, linear, 0s;\n}\n\n.resource-selector .resource-tree ul li.class.selected > a {\n    background-color: #3e7da7;\n    color: white;\n    transition: all, 200ms, linear, 0s;\n}\n\n.resource-selector .resource-tree ul li.class.selected > a:before, .resource-selector .resource-tree ul li.class.selected > a:after {\n    color: white;\n}\n\n.resource-selector .resource-tree ul li.class.selected > a:hover {\n    background-color: #266d9c;\n    transition: all, 200ms, linear, 0s;\n}\n\n.resource-selector .resource-tree ul li.class.selected > a .clickable:hover:before {\n    background-color: #518ab0;\n}\n\n.resource-selector .resource-tree ul li.class.closed > a > .class-toggler:after {\n    content: \"\\e60f\";\n}\n\n.resource-selector .resource-tree ul li.class.closed > a > .icon-folder:before {\n    content: \"\\e60c\";\n}\n\n.resource-selector .resource-tree ul li.class.closed > ul {\n    display: none;\n}\n\n.resource-selector .resource-tree ul li.instance > a > [class^=\"icon-\"], .resource-selector .resource-tree ul li.instance > a > [class*=\" icon-\"] {\n    color: #0e5d91;\n    margin-right: 4px;\n    padding-left: 25px;\n    font-size: 16px;\n    font-size: 1.6rem;\n}\n\n.resource-selector .resource-tree ul li.instance:hover {\n    background-color: #e7eff4;\n    color: #222;\n    transition: all, 200ms, linear, 0s;\n}\n\n.resource-selector .resource-tree ul li.instance.selected {\n    background-color: #3e7da7;\n    transition: all, 200ms, linear, 0s;\n}\n\n.resource-selector .resource-tree ul li.instance.selected > a, .resource-selector .resource-tree ul li.instance.selected > a > [class^=\"icon-\"], .resource-selector .resource-tree ul li.instance.selected > a > [class*=\" icon-\"] {\n    color: white;\n}\n\n.resource-selector .resource-tree ul li.instance.selected:hover {\n    background-color: #266d9c;\n    transition: all, 200ms, linear, 0s;\n}\n\n.resource-selector .resource-tree ul li.instance.selected .clickable:hover:before {\n    background-color: #518ab0;\n}\n\n.resource-selector .resource-tree ul li > a > .selector {\n    display: none;\n    position: absolute;\n    top: 0;\n    right: 8px;\n    line-height: 40px;\n    height: 40px;\n    width: 25px;\n    text-align: center;\n}\n\n.resource-selector .resource-tree ul li > a > .selector:after {\n    transition: all, 200ms, linear, 0s;\n    /* use !important to prevent issues with browser extensions that change fonts */\n    font-family: 'tao' !important;\n    speak: none;\n    font-style: normal;\n    font-weight: normal;\n    font-variant: normal;\n    text-transform: none;\n    line-height: 1;\n    /* Better Font Rendering =========== */\n    -webkit-font-smoothing: antialiased;\n    -moz-osx-font-smoothing: grayscale;\n    content: \"\\e69b\";\n    font-size: 15px;\n    font-size: 1.5rem;\n    color: #0e5d91;\n    line-height: 40px;\n    position: relative;\n}\n\n.resource-selector .resource-tree ul li.selected > a > .selector:after {\n    content: \"\\e69d\";\n}\n\n.resource-selector .resource-tree ul li.selected > a > .selector:after, .resource-selector .resource-tree ul li.selected > a:hover > .selector:after {\n    color: white;\n}\n\n.resource-selector .resource-tree ul li[data-access=denied] > a [class^=\"icon-\"], .resource-selector .resource-tree ul li[data-access=denied] > a [class*=\" icon-\"], .resource-selector .resource-tree ul li[data-access=partial] > a [class^=\"icon-\"], .resource-selector .resource-tree ul li[data-access=partial] > a [class*=\" icon-\"] {\n    position: relative;\n}\n\n.resource-selector .resource-tree ul li[data-access=denied] > a [class^=\"icon-\"]:after, .resource-selector .resource-tree ul li[data-access=denied] > a [class*=\" icon-\"]:after, .resource-selector .resource-tree ul li[data-access=partial] > a [class^=\"icon-\"]:after, .resource-selector .resource-tree ul li[data-access=partial] > a [class*=\" icon-\"]:after {\n    content: \"\\e629\";\n    color: #555;\n    position: absolute;\n    left: 7px;\n    top: 6px;\n}\n\n.resource-selector .resource-tree ul li[data-access=denied] {\n    color: #a4a9b1;\n    background-color: white;\n}\n\n.resource-selector .resource-tree ul li[data-access=denied]:hover, .resource-selector .resource-tree ul li[data-access=denied]:hover > a, .resource-selector .resource-tree ul li[data-access=denied] > a, .resource-selector .resource-tree ul li[data-access=denied] [class^=\"icon-\"]:before, .resource-selector .resource-tree ul li[data-access=denied] [class*=\" icon-\"]:before {\n    cursor: auto;\n    background-color: white;\n    color: #a4a9b1 !important;\n}\n\n.resource-selector .resource-tree ul li a:hover {\n    text-decoration: none;\n}\n\n.resource-selector .filters {\n    position: relative;\n    height: 100%;\n    opacity: 0;\n}\n\n.resource-selector .filters.rendered {\n    opacity: 1;\n    transition: opacity, 300ms, linear, 0s;\n}\n\n.resource-selector .filters .ui-generis-form {\n    margin: 0;\n    padding: 10px;\n    width: 100%;\n    background-color: #f3f1ef;\n    border: none;\n}\n\n.resource-selector .filters .ui-generis-form h2 {\n    margin: 0;\n}\n\n.resource-selector .filters .ui-generis-form .left {\n    width: 100%;\n}\n\n.resource-selector .filters .ui-generis-form .toolbar {\n    margin: 0;\n}\n\n.resource-selector nav {\n    height: 40px;\n    flex: 0 1 40px;\n    border-top: solid 1px #ddd;\n}\n\n.resource-selector .context {\n    display: box;\n    display: -webkit-flexbox;\n    display: flexbox;\n    display: -ms-flex;\n    display: flex;\n    flex-direction: row;\n    flex-wrap: nowrap;\n    flex-pack: start;\n    justify-content: flex-start;\n    flex-line-pack: start;\n    align-content: flex-start;\n    flex-align: stretch;\n    align-items: stretch;\n    padding-right: 16px;\n}\n\n.resource-selector .context .class-context {\n    -ms-order: 0;\n    order: 0;\n    flex-item-align: stretch;\n    align-self: stretch;\n    flex: 1 1 auto;\n    flex: 1 1;\n    overflow: hidden;\n}\n\n.resource-selector .context .class-context .class-selector {\n    position: static;\n}\n\n.resource-selector .context .class-context .class-selector .options {\n    max-height: calc(100% - 120px);\n}\n\n.resource-selector .context .class-context .class-selector .options.folded {\n    max-height: 0;\n}\n\n.resource-selector .context > a {\n    display: inline-block;\n    width: 40px;\n    height: 40px;\n    padding: 10px 0 0 12px;\n    color: #222;\n    border-left: solid 1px white;\n    text-shadow: 0 0 0 transparent;\n    text-decoration: none;\n}\n\n.resource-selector .context > a:hover, .resource-selector .context > a.active {\n    color: #3e7da7;\n    transition: color, 200ms, linear, 0s;\n}\n\n.resource-selector .selection {\n    display: box;\n    display: -webkit-flexbox;\n    display: flexbox;\n    display: -ms-flex;\n    display: flex;\n    flex-direction: row;\n    flex-wrap: nowrap;\n    flex-pack: start;\n    justify-content: flex-start;\n    flex-line-pack: start;\n    align-content: flex-start;\n    flex-align: stretch;\n    align-items: stretch;\n    padding-right: 16px;\n}\n\n.resource-selector .selection .selection-control {\n    flex: 0 0 80px;\n}\n\n.resource-selector .selection .selection-control > label {\n    display: inline-block;\n    width: 40px;\n    height: 40px;\n    padding: 10px 0 0 12px;\n    color: #222;\n    border-left: solid 1px white;\n    text-shadow: 0 0 0 transparent;\n    text-decoration: none;\n    width: 36px;\n    padding: 10px 0 0 8px;\n    margin: 0;\n}\n\n.resource-selector .selection .selection-control > label:hover, .resource-selector .selection .selection-control > label.active {\n    color: #3e7da7;\n    transition: color, 200ms, linear, 0s;\n}\n\n.resource-selector .selection .selection-control > a {\n    display: inline-block;\n    width: 40px;\n    height: 40px;\n    padding: 10px 0 0 12px;\n    color: #222;\n    border-left: solid 1px white;\n    text-shadow: 0 0 0 transparent;\n    text-decoration: none;\n    width: 38px;\n}\n\n.resource-selector .selection .selection-control > a:hover, .resource-selector .selection .selection-control > a.active {\n    color: #3e7da7;\n    transition: color, 200ms, linear, 0s;\n}\n\n.resource-selector .selection .selection-control .selection-toggle .icon-multi-select:before {\n    font-size: 16px;\n    font-size: 1.6rem;\n}\n\n.resource-selector .selection .selection-control .selection-toggle.hidden {\n    display: inline-block !important;\n    visibility: hidden;\n}\n\n.resource-selector .selection .search {\n    -ms-order: 0;\n    order: 0;\n    flex-item-align: stretch;\n    align-self: stretch;\n    flex: 1 1 auto;\n    flex: 1 1;\n    position: relative;\n    padding: 6px 6px 6px 5px;\n}\n\n.resource-selector .selection .search:before {\n    /* use !important to prevent issues with browser extensions that change fonts */\n    font-family: 'tao' !important;\n    speak: none;\n    font-style: normal;\n    font-weight: normal;\n    font-variant: normal;\n    text-transform: none;\n    line-height: 1;\n    /* Better Font Rendering =========== */\n    -webkit-font-smoothing: antialiased;\n    -moz-osx-font-smoothing: grayscale;\n    content: \"\\e61f\";\n    position: absolute;\n    left: 12px;\n    top: 12px;\n    opacity: .4;\n}\n\n.resource-selector .selection .search input {\n    border-radius: 2px;\n    max-width: inherit;\n    width: 100%;\n    padding: 4px 25px;\n}\n\n.resource-selector .selection .search > a.filters-opener {\n    position: absolute;\n    right: 12px;\n    top: 10px;\n    font-size: 16px;\n    font-size: 1.6rem;\n    text-decoration: none;\n}\n\n.resource-selector .selection .filters-container {\n    position: absolute;\n    width: 100%;\n    background-color: #f3f1ef;\n    border: solid 1px #ddd;\n    -webkit-border-bottom-right-radius: 3px;\n    -webkit-border-bottom-left-radius: 3px;\n    -moz-border-radius-bottomright: 3px;\n    -moz-border-radius-bottomleft: 3px;\n    border-bottom-right-radius: 3px;\n    border-bottom-left-radius: 3px;\n    -ms-box-shadow: 1px 1px 2px 0 rgba(0, 0, 0, 0.2);\n    -o-box-shadow: 1px 1px 2px 0 rgba(0, 0, 0, 0.2);\n    box-shadow: 1px 1px 2px 0 rgba(0, 0, 0, 0.2);\n    left: 0;\n    top: 80px;\n    overflow-y: auto;\n    z-index: 100;\n    max-height: calc(100% - 110px);\n    transition: max-height, 300ms, ease, 0s;\n}\n\n.resource-selector .selection .filters-container.folded {\n    overflow: hidden;\n    max-height: 0;\n    border-width: 0;\n    transition: max-height, 300ms, ease, 0s;\n}\n\n.resource-selector main {\n    -ms-order: 0;\n    order: 0;\n    flex-item-align: stretch;\n    align-self: stretch;\n    flex: 1 1 auto;\n    flex: 1 1;\n    min-height: 150px;\n    border-top: solid 1px #ddd;\n    background-color: white;\n    height: 100%;\n    overflow-y: scroll;\n}\n\n.resource-selector main .no-results {\n    display: inline-block;\n    width: 100%;\n    text-align: center;\n    margin: 10px auto;\n    opacity: .75;\n}\n\n.resource-selector main .more {\n    height: 45px;\n    padding: 10px;\n}\n\n.resource-selector main.loading .more {\n    opacity: 0.65;\n    cursor: inherit;\n}\n\n.resource-selector footer {\n    height: 30px;\n    flex: 0 1 30px;\n    border-top: solid 1px #ddd;\n    background-color: #f3f1ef;\n    text-align: center;\n    padding: 5px;\n}\n\n/*# sourceMappingURL=selector.css.map *//*\nUsage:\n- linear-gradient((color1, color2, color3)) - returns linear-gradient with evenly distributed colors,\n   if 3 colors used then the position of each will be 33,33%\n- linear-gradient((color1 0%, color2 30%, color3 80%)) - returns linear-gradient with manually distributed colors,\n   first param - color, second - position. Also you can use px or other valid units for set position.\n*/\n/* Do not edit */\n.loading-button [class^=\"icon-\"], .loading-button [class*=\" icon-\"] {\n    padding: 0;\n}\n\n.loading-button .action-label, .loading-button .terminated-label {\n    margin-left: 9px;\n}\n\n.loading-button .spinner-icon, .loading-button .terminated-label {\n    display: none;\n}\n\n.loading-button.started {\n    cursor: default;\n    opacity: 0.5;\n}\n\n.loading-button.started .spinner-icon {\n    display: inline-block;\n    transform: translateZ(0);\n    transform-origin: 50% 50%;\n    animation: loading-button-rotate 1.4s infinite linear;\n}\n\n@keyframes loading-button-rotate {\n    0% {\n        transform: rotate(0deg);\n    }\n    100% {\n        transform: rotate(360deg);\n    }\n}\n\n.loading-button.started .start-icon {\n    display: none;\n}\n\n.loading-button.terminated .action-label {\n    display: none;\n}\n\n.loading-button.terminated .terminated-label {\n    display: inline-block;\n}\n\n/*# sourceMappingURL=button.css.map *//*\nUsage:\n- linear-gradient((color1, color2, color3)) - returns linear-gradient with evenly distributed colors,\n   if 3 colors used then the position of each will be 33,33%\n- linear-gradient((color1 0%, color2 30%, color3 80%)) - returns linear-gradient with manually distributed colors,\n   first param - color, second - position. Also you can use px or other valid units for set position.\n*/\n/* Do not edit */\ndiv.task-report-container {\n    width: 100%;\n}\n\n/*# sourceMappingURL=taskable.css.map *//*\nUsage:\n- linear-gradient((color1, color2, color3)) - returns linear-gradient with evenly distributed colors,\n   if 3 colors used then the position of each will be 33,33%\n- linear-gradient((color1 0%, color2 30%, color3 80%)) - returns linear-gradient with manually distributed colors,\n   first param - color, second - position. Also you can use px or other valid units for set position.\n*/\n/* Do not edit */\n.destination-selector {\n    position: relative;\n    width: 400px;\n    opacity: 0;\n}\n\n.destination-selector.rendered {\n    opacity: 1;\n    transition: opacity, 300ms, linear, 0s;\n}\n\n.destination-selector > div {\n    border: 1px solid #ddd;\n    border-radius: 2px;\n    -webkit-border-radius: 2px;\n    background-color: #f3f1ef;\n    padding: 20px;\n    height: 500px;\n    position: relative;\n}\n\n.destination-selector > div > p {\n    font-weight: bold;\n}\n\n.destination-selector .selector-container {\n    position: relative;\n    height: calc(100% - 90px);\n}\n\n.destination-selector .actions {\n    margin-top: 30px;\n    text-align: right;\n}\n\n/*# sourceMappingURL=selector.css.map */"),define("taoItems/loader/taoItems.bundle",function(){});
//# sourceMappingURL=taoItems.min.js.map